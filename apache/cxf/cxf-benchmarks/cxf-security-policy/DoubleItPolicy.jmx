<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2" properties="5.0" jmeter="5.0 r1840935">
  <hashTree>
    <TestPlan guiclass="TestPlanGui" testclass="TestPlan" testname="Test Plan" enabled="true">
      <stringProp name="TestPlan.comments"></stringProp>
      <boolProp name="TestPlan.functional_mode">false</boolProp>
      <boolProp name="TestPlan.serialize_threadgroups">true</boolProp>
      <elementProp name="TestPlan.user_defined_variables" elementType="Arguments" guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="true">
        <collectionProp name="Arguments.arguments"/>
      </elementProp>
      <stringProp name="TestPlan.user_define_classpath"></stringProp>
      <boolProp name="TestPlan.tearDown_on_shutdown">true</boolProp>
    </TestPlan>
    <hashTree>
      <Arguments guiclass="ArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="true">
        <collectionProp name="Arguments.arguments">
          <elementProp name="host" elementType="Argument">
            <stringProp name="Argument.name">host</stringProp>
            <stringProp name="Argument.value">localhost</stringProp>
            <stringProp name="Argument.metadata">=</stringProp>
            <stringProp name="Argument.desc">Host of Webservice</stringProp>
          </elementProp>
        </collectionProp>
      </Arguments>
      <hashTree/>
      <ConfigTestElement guiclass="HttpDefaultsGui" testclass="ConfigTestElement" testname="HTTP Request Defaults" enabled="true">
        <elementProp name="HTTPsampler.Arguments" elementType="Arguments" guiclass="HTTPArgumentsPanel" testclass="Arguments" testname="User Defined Variables" enabled="true">
          <collectionProp name="Arguments.arguments"/>
        </elementProp>
        <stringProp name="HTTPSampler.domain">${host}</stringProp>
        <stringProp name="HTTPSampler.port"></stringProp>
        <stringProp name="HTTPSampler.protocol"></stringProp>
        <stringProp name="HTTPSampler.contentEncoding"></stringProp>
        <stringProp name="HTTPSampler.path"></stringProp>
        <stringProp name="HTTPSampler.concurrentPool">4</stringProp>
        <stringProp name="HTTPSampler.connect_timeout"></stringProp>
        <stringProp name="HTTPSampler.response_timeout"></stringProp>
      </ConfigTestElement>
      <hashTree/>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="NoSecurity" enabled="true">
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller" enabled="true">
          <boolProp name="LoopController.continue_forever">false</boolProp>
          <stringProp name="LoopController.loops">10000</stringProp>
        </elementProp>
        <stringProp name="ThreadGroup.num_threads">30</stringProp>
        <stringProp name="ThreadGroup.ramp_time">0</stringProp>
        <longProp name="ThreadGroup.start_time">1375525852000</longProp>
        <longProp name="ThreadGroup.end_time">1375525852000</longProp>
        <boolProp name="ThreadGroup.scheduler">false</boolProp>
        <stringProp name="ThreadGroup.duration"></stringProp>
        <stringProp name="ThreadGroup.delay"></stringProp>
      </ThreadGroup>
      <hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Soap Request No Security" enabled="true">
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;soap:Body&gt;&lt;ns2:DoubleIt xmlns:ns2=&quot;http://www.example.org/schema/DoubleIt&quot;&gt;&lt;numberToDouble&gt;25&lt;/numberToDouble&gt;&lt;description&gt;%0A%0AWeb%20Services%20Security%3A%20SOAP%20Message%20Security%20Version%201.1.1%0A%0AOASIS%20Standard%0A%0A18%20May%202012%0A%0ASpecification%20URIs%0A%0AThis%20version%3A%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-SOAPMessageSecurity-v1.1.1-os.doc%20(Authoritative)%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-SOAPMessageSecurity-v1.1.1-os.html%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-SOAPMessageSecurity-v1.1.1-os.pdf%0A%0APrevious%20version%3A%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fcsd01%2Fwss-SOAPMessageSecurity-v1.1.1-csd01.doc%20(Authoritative)%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fcsd01%2Fwss-SOAPMessageSecurity-v1.1.1-csd01.html%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fcsd01%2Fwss-SOAPMessageSecurity-v1.1.1-csd01.pdf%0A%0ALatest%20version%3A%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fwss-SOAPMessageSecurity-v1.1.1.doc%20(Authoritative)%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fwss-SOAPMessageSecurity-v1.1.1.html%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fwss-SOAPMessageSecurity-v1.1.1.pdf%0A%0ATechnical%20Committee%3A%0A%0AOASIS%20Web%20Services%20Security%20Maintenance%20(WSS-M)%20TC%0A%0AChair%3A%0A%0ADavid%20Turner%20(david.turner%40microsoft.com)%2C%20Microsoft%0A%0AEditors%3A%0A%0AAnthony%20Nadalin%20(droldsecure%40us.ibm.com)%2C%20IBM%0A%0AChris%20Kaler%20(ckaler%40microsoft.com)%2C%20Microsoft%0A%0ARonald%20Monzillo%20(ronald.monzillo%40sun.com)%2C%20Sun%20Microsystems%0A%0APhillip%20Hallam-Baker%20(pbaker%40verisign.com)%2C%20Verisign%0A%0ACarlo%20Milono%20(cmilono%40tibco.com)%2C%20Tibco%0A%0AAdditional%20artifacts%3A%0A%0AThis%20prose%20specification%20is%20one%20component%20of%20a%20multi-part%20Work%20Product%20which%20includes%3A%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%20Kerberos%20Token%20Profile%20Version%201.1.1.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-KerberosTokenProfile-v1.1.1-os.html.%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%20Rights%20Expression%20Language%20(REL)%20Token%20Profile%20Version%201.1.1.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-rel-token-profile-v1.1.1-os.html.%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%20SAML%20Token%20Profile%20Version%201.1.1.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-SAMLTokenProfile-v1.1.1-os.html.%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%3A%20SOAP%20Message%20Security%20Version%201.1.1.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-SOAPMessageSecurity-v1.1.1-os.html.%20(this%20document)%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%20SOAP%20Message%20with%20Attachments%20(SwA)%20Profile%20Version%201.1.1.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-SwAProfile-v1.1.1-os.html.%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%20Username%20Token%20Profile%20Version%201.1.1.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-UsernameTokenProfile-v1.1.1-os.html.%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%20X.509%20Certificate%20Token%20Profile%20Version%201.1.1.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-x509TokenProfile-v1.1.1-os.html.%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20XML%20schemas%3A%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fxsd%2F%0A%0ARelated%20work%3A%0A%0AThis%20specification%20supersedes%3A%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%3A%20SOAP%20Message%20Security%201.1%20(WS-Security%202004).%2001%20November%202006.%20OASIS%20Standard%20incorporating%20Approved%20Errata.%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Fv1.1%2Fwss-v1.1-spec-errata-os-SOAPMessageSecurity.htm%0A%0A%C2%B7%20%20%20%20%20%20%20%20%20Web%20Services%20Security%3A%20SOAP%20Message%20Security%201.1%20(WS-Security%202004).%2001%20November%202006.%20OASIS%20Approved%20Errata.%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Fv1.1%2Fwss-v1.1-errata-os-SOAPMessageSecurity.htm%0A%0AAbstract%3A%0A%0AThis%20specification%20describes%20enhancements%20to%20SOAP%20messaging%20to%20provide%20message%20integrity%20and%20confidentiality.%20%20The%20specified%20mechanisms%20can%20be%20used%20to%20accommodate%20a%20wide%20variety%20of%20security%20models%20and%20encryption%20technologies.%0A%0AThis%20specification%20also%20provides%20a%20general-purpose%20mechanism%20for%20associating%20security%20tokens%20with%20message%20content.%20%20No%20specific%20type%20of%20security%20token%20is%20required%2C%20the%20specification%20is%20designed%20to%20be%20extensible%20(i.e..%20support%20multiple%20security%20token%20formats).%20%20For%20example%2C%20a%20client%20might%20provide%20one%20format%20for%20proof%20of%20identity%20and%20provide%20another%20format%20for%20proof%20that%20they%20have%20a%20particular%20business%20certification.%0A%0AAdditionally%2C%20this%20specification%20describes%20how%20to%20encode%20binary%20security%20tokens%2C%20a%20framework%20for%20XML-based%20tokens%2C%20and%20how%20to%20include%20opaque%20encrypted%20keys.%20%20It%20also%20includes%20extensibility%20mechanisms%20that%20can%20be%20used%20to%20further%20describe%20the%20characteristics%20of%20the%20tokens%20that%20are%20included%20with%20a%20message.%0A%0AThis%20document%20integrates%20specific%20error%20corrections%20or%20editorial%20changes%20to%20the%20preceding%20specification%2C%20within%20the%20scope%20of%20the%20Web%20Services%20Security%20and%20this%20TC.%0A%0AThis%20document%20introduces%20a%20third%20digit%20in%20the%20numbering%20convention%20where%20the%20third%20digit%20represents%20a%20consolidation%20of%20error%20corrections%2C%20bug%20fixes%20or%20editorial%20formatting%20changes%20(e.g.%2C%201.1.1)%3B%20it%20does%20not%20add%20any%20new%20features%20beyond%20those%20of%20the%20base%20specifications%20(e.g.%2C%201.1).%0A%0AStatus%3A%0A%0AThis%20document%20was%20last%20revised%20or%20approved%20by%20the%20membership%20of%20OASIS%20on%20the%20above%20date.%20The%20level%20of%20approval%20is%20also%20listed%20above.%20Check%20the%20%E2%80%9CLatest%20version%E2%80%9D%20location%20noted%20above%20for%20possible%20later%20revisions%20of%20this%20document.%0A%0ATechnical%20Committee%20members%20should%20send%20comments%20on%20this%20specification%20to%20the%20Technical%20Committee%E2%80%99s%20email%20list.%20Others%20should%20send%20comments%20to%20the%20Technical%20Committee%20by%20using%20the%20%E2%80%9CSend%20A%20Comment%E2%80%9D%20button%20on%20the%20Technical%20Committee%E2%80%99s%20web%20page%20at%20http%3A%2F%2Fwww.oasis-open.org%2Fcommittees%2Fwss-m%2F.%0A%0AFor%20information%20on%20whether%20any%20patents%20have%20been%20disclosed%20that%20may%20be%20essential%20to%20implementing%20this%20specification%2C%20and%20any%20offers%20of%20patent%20licensing%20terms%2C%20please%20refer%20to%20the%20Intellectual%20Property%20Rights%20section%20of%20the%20Technical%20Committee%20web%20page%20(http%3A%2F%2Fwww.oasis-open.org%2Fcommittees%2Fwss-m%2Fipr.php).%0A%0ACitation%20format%3A%0A%0AWhen%20referencing%20this%20specification%20the%20following%20citation%20format%20should%20be%20used%3A%0A%0A%5BWSS-SOAP-Message-Security-V1.1.1%5D%0A%0AWeb%20Services%20Security%3A%20SOAP%20Message%20Security%20Version%201.1.1.%2018%20May%202012.%20OASIS%20Standard.%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss-m%2Fwss%2Fv1.1.1%2Fos%2Fwss-SOAPMessageSecurity-v1.1.1-os.html.%0A%0ANotices%0A%0ACopyright%20%C2%A9%20OASIS%20Open%202012.%20All%20Rights%20Reserved.%0A%0AAll%20capitalized%20terms%20in%20the%20following%20text%20have%20the%20meanings%20assigned%20to%20them%20in%20the%20OASIS%20Intellectual%20Property%20Rights%20Policy%20(the%20%22OASIS%20IPR%20Policy%22).%20The%20full%20Policy%20may%20be%20found%20at%20the%20OASIS%20website.%0A%0AThis%20document%20and%20translations%20of%20it%20may%20be%20copied%20and%20furnished%20to%20others%2C%20and%20derivative%20works%20that%20comment%20on%20or%20otherwise%20explain%20it%20or%20assist%20in%20its%20implementation%20may%20be%20prepared%2C%20copied%2C%20published%2C%20and%20distributed%2C%20in%20whole%20or%20in%20part%2C%20without%20restriction%20of%20any%20kind%2C%20provided%20that%20the%20above%20copyright%20notice%20and%20this%20section%20are%20included%20on%20all%20such%20copies%20and%20derivative%20works.%20However%2C%20this%20document%20itself%20may%20not%20be%20modified%20in%20any%20way%2C%20including%20by%20removing%20the%20copyright%20notice%20or%20references%20to%20OASIS%2C%20except%20as%20needed%20for%20the%20purpose%20of%20developing%20any%20document%20or%20deliverable%20produced%20by%20an%20OASIS%20Technical%20Committee%20(in%20which%20case%20the%20rules%20applicable%20to%20copyrights%2C%20as%20set%20forth%20in%20the%20OASIS%20IPR%20Policy%2C%20must%20be%20followed)%20or%20as%20required%20to%20translate%20it%20into%20languages%20other%20than%20English.%0A%0AThe%20limited%20permissions%20granted%20above%20are%20perpetual%20and%20will%20not%20be%20revoked%20by%20OASIS%20or%20its%20successors%20or%20assigns.%0A%0AThis%20document%20and%20the%20information%20contained%20herein%20is%20provided%20on%20an%20%22AS%20IS%22%20basis%20and%20OASIS%20DISCLAIMS%20ALL%20WARRANTIES%2C%20EXPRESS%20OR%20IMPLIED%2C%20INCLUDING%20BUT%20NOT%20LIMITED%20TO%20ANY%20WARRANTY%20THAT%20THE%20USE%20OF%20THE%20INFORMATION%20HEREIN%20WILL%20NOT%20INFRINGE%20ANY%20OWNERSHIP%20RIGHTS%20OR%20ANY%20IMPLIED%20WARRANTIES%20OF%20MERCHANTABILITY%20OR%20FITNESS%20FOR%20A%20PARTICULAR%20PURPOSE.%0A%0AOASIS%20requests%20that%20any%20OASIS%20Party%20or%20any%20other%20party%20that%20believes%20it%20has%20patent%20claims%20that%20would%20necessarily%20be%20infringed%20by%20implementations%20of%20this%20OASIS%20Committee%20Specification%20or%20OASIS%20Standard%2C%20to%20notify%20OASIS%20TC%20Administrator%20and%20provide%20an%20indication%20of%20its%20willingness%20to%20grant%20patent%20licenses%20to%20such%20patent%20claims%20in%20a%20manner%20consistent%20with%20the%20IPR%20Mode%20of%20the%20OASIS%20Technical%20Committee%20that%20produced%20this%20specification.%0A%0AOASIS%20invites%20any%20party%20to%20contact%20the%20OASIS%20TC%20Administrator%20if%20it%20is%20aware%20of%20a%20claim%20of%20ownership%20of%20any%20patent%20claims%20that%20would%20necessarily%20be%20infringed%20by%20implementations%20of%20this%20specification%20by%20a%20patent%20holder%20that%20is%20not%20willing%20to%20provide%20a%20license%20to%20such%20patent%20claims%20in%20a%20manner%20consistent%20with%20the%20IPR%20Mode%20of%20the%20OASIS%20Technical%20Committee%20that%20produced%20this%20specification.%20OASIS%20may%20include%20such%20claims%20on%20its%20website%2C%20but%20disclaims%20any%20obligation%20to%20do%20so.%0A%0AOASIS%20takes%20no%20position%20regarding%20the%20validity%20or%20scope%20of%20any%20intellectual%20property%20or%20other%20rights%20that%20might%20be%20claimed%20to%20pertain%20to%20the%20implementation%20or%20use%20of%20the%20technology%20described%20in%20this%20document%20or%20the%20extent%20to%20which%20any%20license%20under%20such%20rights%20might%20or%20might%20not%20be%20available%3B%20neither%20does%20it%20represent%20that%20it%20has%20made%20any%20effort%20to%20identify%20any%20such%20rights.%20Information%20on%20OASIS%27%20procedures%20with%20respect%20to%20rights%20in%20any%20document%20or%20deliverable%20produced%20by%20an%20OASIS%20Technical%20Committee%20can%20be%20found%20on%20the%20OASIS%20website.%20Copies%20of%20claims%20of%20rights%20made%20available%20for%20publication%20and%20any%20assurances%20of%20licenses%20to%20be%20made%20available%2C%20or%20the%20result%20of%20an%20attempt%20made%20to%20obtain%20a%20general%20license%20or%20permission%20for%20the%20use%20of%20such%20proprietary%20rights%20by%20implementers%20or%20users%20of%20this%20OASIS%20Committee%20Specification%20or%20OASIS%20Standard%2C%20can%20be%20obtained%20from%20the%20OASIS%20TC%20Administrator.%20OASIS%20makes%20no%20representation%20that%20any%20information%20or%20list%20of%20intellectual%20property%20rights%20will%20at%20any%20time%20be%20complete%2C%20or%20that%20any%20claims%20in%20such%20list%20are%2C%20in%20fact%2C%20Essential%20Claims.%0A%0AThe%20name%20%22OASIS%22%20is%20a%20trademark%20of%20OASIS%2C%20the%20owner%20and%20developer%20of%20this%20specification%2C%20and%20should%20be%20used%20only%20to%20refer%20to%20the%20organization%20and%20its%20official%20outputs.%20OASIS%20welcomes%20reference%20to%2C%20and%20implementation%20and%20use%20of%2C%20specifications%2C%20while%20reserving%20the%20right%20to%20enforce%20its%20marks%20against%20misleading%20uses.%20Please%20see%20http%3A%2F%2Fwww.oasis-open.org%2Fpolicies-guidelines%2Ftrademark%20for%20above%20guidance.%0A%0ATable%20of%20Contents%0A%0A1%20%20%20%20%20%20%20%20Introduction%0A%0A1.1%20Goals%20and%20Requirements%0A%0A1.1.1%20Requirements%0A%0A1.1.2%20Non-Goals%0A%0A2%20%20%20%20%20%20%20%20Notations%20and%20Terminology%0A%0A2.1%20Notational%20Conventions%0A%0A2.2%20Namespaces%0A%0A2.3%20Acronyms%20and%20Abbreviations%0A%0A2.4%20Terminology%0A%0A2.5%20Note%20on%20Examples%0A%0A3%20%20%20%20%20%20%20%20Message%20Protection%20Mechanisms%0A%0A3.1%20Message%20Security%20Model%0A%0A3.2%20Message%20Protection%0A%0A3.3%20Invalid%20or%20Missing%20Claims%0A%0A3.4%20Example%0A%0A4%20%20%20%20%20%20%20%20ID%20References%0A%0A4.1%20Id%20Attribute%0A%0A4.2%20Id%20Schema%0A%0A5%20%20%20%20%20%20%20%20Security%20Header%0A%0A6%20%20%20%20%20%20%20%20Security%20Tokens%0A%0A6.1%20Attaching%20Security%20Tokens%0A%0A6.1.1%20Processing%20Rules%0A%0A6.1.2%20Subject%20Confirmation%0A%0A6.2%20User%20Name%20Token%0A%0A6.2.1%20Usernames%0A%0A6.3%20Binary%20Security%20Tokens%0A%0A6.3.1%20Attaching%20Security%20Tokens%0A%0A6.3.2%20Encoding%20Binary%20Security%20Tokens%0A%0A6.4%20XML%20Tokens%0A%0A6.5%20EncryptedData%20Token%0A%0A6.6%20Identifying%20and%20Referencing%20Security%20Tokens%0A%0A7%20%20%20%20%20%20%20%20Token%20References%0A%0A7.1%20SecurityTokenReference%20Element%0A%0A7.2%20Direct%20References%0A%0A7.3%20Key%20Identifiers%0A%0A7.4%20Embedded%20References%0A%0A7.5%20ds%3AKeyInfo%0A%0A7.6%20Key%20Names%0A%0A7.7%20Encrypted%20Key%20reference%0A%0A8%20%20%20%20%20%20%20%20Signatures%0A%0A8.1%20Algorithms%0A%0A8.2%20Signing%20Messages%0A%0A8.3%20Signing%20Tokens%0A%0A8.4%20Signature%20Validation%0A%0A8.5%20Signature%20Confirmation%0A%0A8.5.1%20Response%20Generation%20Rules%0A%0A8.5.2%20Response%20Processing%20Rules%0A%0A8.6%20Example%0A%0A9%20%20%20%20%20%20%20%20Encryption%0A%0A9.1%20xenc%3AReferenceList%0A%0A9.2%20xenc%3AEncryptedKey%0A%0A9.3%20Encrypted%20Header%0A%0A9.4%20Processing%20Rules%0A%0A9.4.1%20Encryption%0A%0A9.4.2%20Decryption%0A%0A9.4.3%20Encryption%20with%20EncryptedHeader%0A%0A9.4.4%20Processing%20an%20EncryptedHeader%0A%0A9.4.5%20Processing%20the%20mustUnderstand%20attribute%20on%20EncryptedHeader%0A%0A10%20%20%20%20%20%20Security%20Timestamps%0A%0A11%20%20%20%20%20%20Extended%20Example%0A%0A12%20%20%20%20%20%20Error%20Handling%0A%0A13%20%20%20%20%20%20Security%20Considerations%0A%0A13.1%20General%20Considerations%0A%0A13.2%20Additional%20Considerations%0A%0A13.2.1%20Replay%0A%0A13.2.2%20Combining%20Security%20Mechanisms%0A%0A13.2.3%20Challenges%0A%0A13.2.4%20Protecting%20Security%20Tokens%20and%20Keys%0A%0A13.2.5%20Protecting%20Timestamps%20and%20Ids%0A%0A13.2.6%20Protecting%20against%20removal%20and%20modification%20of%20XML%20Elements%0A%0A13.2.7%20Detecting%20Duplicate%20Identifiers%0A%0A14%20%20%20%20%20%20Interoperability%20Notes%0A%0A15%20%20%20%20%20%20Privacy%20Considerations%0A%0A16%20%20%20%20%20%20References%0A%0A17%20%20%20%20%20%20Conformance%0A%0AA.%20%20%20%20%20%20Acknowledgements%0A%0AB.%20%20%20%20%20%20Revision%20History%0A%0AC.%20%20%20%20%20%20Utility%20Elements%20and%20Attributes%0A%0AC.1%20Identification%20Attribute%0A%0AC.2%20Timestamp%20Elements%0A%0AC.3%20General%20Schema%20Types%0A%0AD.%20%20%20%20%20%20SecurityTokenReference%20Model%0A%0A%20%0A%0A%20%0A%0A1%20%20%20%20%20%20Introduction%0A%0AThis%20OASIS%20specification%20is%20the%20result%20of%20significant%20new%20work%20by%20the%20WSS%20Technical%20Committee%20and%20supersedes%20the%20input%20submissions%2C%20Web%20Service%20Security%20(WS-Security)%20Version%201.0%20April%205%2C%202002%20and%20Web%20Services%20Security%20Addendum%20Version%201.0%20August%2018%2C%202002.%0A%0A%20%0A%0AThis%20specification%20proposes%20a%20standard%20set%20of%20SOAP%20%5BSOAP11%2C%20SOAP12%5D%20extensions%20that%20can%20be%20used%20when%20building%20secure%20Web%20services%20to%20implement%20message%20content%20integrity%20and%20confidentiality.%20%20This%20specification%20refers%20to%20this%20set%20of%20extensions%20and%20modules%20as%20the%20%E2%80%9CWeb%20Services%20Security%3A%20%20SOAP%20Message%20Security%E2%80%9D%20or%20%E2%80%9CWSS%3A%20SOAP%20Message%20Security%E2%80%9D.%0A%0A%20%0A%0AThis%20specification%20is%20flexible%20and%20is%20designed%20to%20be%20used%20as%20the%20basis%20for%20securing%20Web%20services%20within%20a%20wide%20variety%20of%20security%20models%20including%20PKI%2C%20Kerberos%2C%20and%20SSL.%20Specifically%2C%20this%20specification%20provides%20support%20for%20multiple%20security%20token%20formats%2C%20multiple%20trust%20domains%2C%20multiple%20signature%20formats%2C%20and%20multiple%20encryption%20technologies.%20The%20token%20formats%20and%20semantics%20for%20using%20these%20are%20defined%20in%20the%20associated%20profile%20documents.%0A%0A%20%0A%0AThis%20specification%20provides%20three%20main%20mechanisms%3A%20ability%20to%20send%20security%20tokens%20as%20part%20of%20a%20message%2C%20message%20integrity%2C%20and%20message%20confidentiality.%20%20These%20mechanisms%20by%20themselves%20do%20not%20provide%20a%20complete%20security%20solution%20for%20Web%20services.%20%20Instead%2C%20this%20specification%20is%20a%20building%20block%20that%20can%20be%20used%20in%20conjunction%20with%20other%20Web%20service%20extensions%20and%20higher-level%20application-specific%20protocols%20to%20accommodate%20a%20wide%20variety%20of%20security%20models%20and%20security%20technologies.%0A%0A%20%0A%0AThese%20mechanisms%20can%20be%20used%20independently%20(e.g.%2C%20to%20pass%20a%20security%20token)%20or%20in%20a%20tightly%20coupled%20manner%20(e.g.%2C%20signing%20and%20encrypting%20a%20message%20or%20part%20of%20a%20message%20and%20providing%20a%20security%20token%20or%20token%20path%20associated%20with%20the%20keys%20used%20for%20signing%20and%20encryption).%0A1.1%20Goals%20and%20Requirements%0A%0AThe%20goal%20of%20this%20specification%20is%20to%20enable%20applications%20to%20conduct%20secure%20SOAP%20message%20exchanges.%0A%0A%20%0A%0AThis%20specification%20is%20intended%20to%20provide%20a%20flexible%20set%20of%20mechanisms%20that%20can%20be%20used%20to%20construct%20a%20range%20of%20security%20protocols%3B%20in%20other%20words%20this%20specification%20intentionally%20does%20not%20describe%20explicit%20fixed%20security%20protocols.%0A%0A%20%0A%0AAs%20with%20every%20security%20protocol%2C%20significant%20efforts%20must%20be%20applied%20to%20ensure%20that%20security%20protocols%20constructed%20using%20this%20specification%20are%20not%20vulnerable%20to%20any%20one%20of%20a%20wide%20range%20of%20attacks.%20The%20examples%20in%20this%20specification%20are%20meant%20to%20illustrate%20the%20syntax%20of%20these%20mechanisms%20and%20are%20not%20intended%20as%20examples%20of%20combining%20these%20mechanisms%20in%20secure%20ways.%0A%0AThe%20focus%20of%20this%20specification%20is%20to%20describe%20a%20single-message%20security%20language%20that%20provides%20for%20message%20security%20that%20may%20assume%20an%20established%20session%2C%20security%20context%20and%2For%20policy%20agreement.%0A%0A%20%0A%0AThe%20requirements%20to%20support%20secure%20message%20exchange%20are%20listed%20below.%0A1.1.1%20Requirements%0A%0AThe%20Web%20services%20security%20language%20must%20support%20a%20wide%20variety%20of%20security%20models.%20%20The%20following%20list%20identifies%20the%20key%20driving%20requirements%20for%20this%20specification%3A%0A%0A%20%20%20%20Multiple%20security%20token%20formats%0A%20%20%20%20Multiple%20trust%20domains%0A%20%20%20%20Multiple%20signature%20formats%0A%20%20%20%20Multiple%20encryption%20technologies%0A%20%20%20%20End-to-end%20message%20content%20security%20and%20not%20just%20transport-level%20security%0A%0A1.1.2%20Non-Goals%0A%0AThe%20following%20topics%20are%20outside%20the%20scope%20of%20this%20document%3A%0A%0A%20%20%20%20Establishing%20a%20security%20context%20or%20authentication%20mechanisms.%0A%20%20%20%20Key%20derivation.%0A%20%20%20%20Advertisement%20and%20exchange%20of%20security%20policy.%0A%20%20%20%20How%20trust%20is%20established%20or%20determined.%0A%20%20%20%20Non-repudiation.%0A%0A%20%0A2%20%20%20%20%20%20Notations%20and%20Terminology%0A%0AThis%20section%20specifies%20the%20notations%2C%20namespaces%2C%20and%20terminology%20used%20in%20this%20specification.%0A2.1%20Notational%20Conventions%0A%0AThe%20keywords%20%22MUST%22%2C%20%22MUST%20NOT%22%2C%20%22REQUIRED%22%2C%20%22SHALL%22%2C%20%22SHALL%20NOT%22%2C%20%22SHOULD%22%2C%20%22SHOULD%20NOT%22%2C%20%22RECOMMENDED%22%2C%20%22MAY%22%2C%20and%20%22OPTIONAL%22%20in%20this%20document%20are%20to%20be%20interpreted%20as%20described%20in%20RFC%202119.%0A%0A%20%0A%0AWhen%20describing%20abstract%20data%20models%2C%20this%20specification%20uses%20the%20notational%20convention%20used%20by%20the%20XML%20Infoset.%20Specifically%2C%20abstract%20property%20names%20always%20appear%20in%20square%20brackets%20(e.g.%2C%20%5Bsome%20property%5D).%0A%0A%20%0A%0AWhen%20describing%20concrete%20XML%20schemas%2C%20this%20specification%20uses%20a%20convention%20where%20each%20member%20of%20an%20element%E2%80%99s%20%5Bchildren%5D%20or%20%5Battributes%5D%20property%20is%20described%20using%20an%20XPath-like%20notation%20(e.g.%2C%20%2Fx%3AMyHeader%2Fx%3ASomeProperty%2F%40value1).%20%20The%20use%20of%20%7Bany%7D%20indicates%20the%20presence%20of%20an%20element%20wildcard%20(%3Cxs%3Aany%2F%3E).%20The%20use%20of%20%40%7Bany%7D%20indicates%20the%20presence%20of%20an%20attribute%20wildcard%20(%3Cxs%3AanyAttribute%2F%3E).%0A%0A%20%0A%0AReaders%20are%20presumed%20to%20be%20familiar%20with%20the%20terms%20in%20the%20Internet%20Security%20Glossary%20%5BGLOS%5D.%0A2.2%20Namespaces%0A%0ANamespace%20URIs%20(of%20the%20general%20form%20%22some-URI%22)%20represents%20some%20application-dependent%20or%20context-dependent%20URI%20as%20defined%20in%20RFC%202396%20%5BURI%5D.%0A%0A%20%0A%0AThis%20specification%20is%20backwardly%20compatible%20with%20version%201.0.%20%20This%20means%20that%20URIs%20and%20schema%20elements%20defined%20in%201.0%20remain%20unchanged%20and%20new%20schema%20elements%20and%20constants%20are%20defined%20using%201.1%20namespaces%20and%20URIs.%0A%0A%20%0A%0AThe%20XML%20namespace%20URIs%20that%20MUST%20be%20used%20by%20implementations%20of%20this%20specification%20are%20as%20follows%20(note%20that%20elements%20used%20in%20this%20specification%20are%20from%20various%20namespaces)%3A%0A%0A%20%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-secext-1.0.xsd%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-utility-1.0.xsd%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Foasis-wss-wssecurity-secext-1.1.xsd%0A%0A%20%0A%0AThis%20specification%20is%20designed%20to%20work%20with%20the%20general%20SOAP%20%5BSOAP11%2C%20SOAP12%5D%20message%20structure%20and%20message%20processing%20model%2C%20and%20should%20be%20applicable%20to%20any%20version%20of%20SOAP.%20The%20current%20SOAP%201.1%20namespace%20URI%20is%20used%20herein%20to%20provide%20detailed%20examples%2C%20but%20there%20is%20no%20intention%20to%20limit%20the%20applicability%20of%20this%20specification%20to%20a%20single%20version%20of%20SOAP.%0A%0A%20%0A%0AThe%20namespaces%20used%20in%20this%20document%20are%20shown%20in%20the%20following%20table%20(note%20that%20for%20brevity%2C%20the%20examples%20use%20the%20prefixes%20listed%20below%20but%20do%20not%20include%20the%20URIs%20%E2%80%93%20those%20listed%20below%20are%20assumed).%0A%0A%20%0A%0APrefix%0A%09%0A%0ANamespace%0A%0Ads%0A%09%0A%0Ahttp%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23%0A%0AS11%0A%09%0A%0Ahttp%3A%2F%2Fschemas.xmlsoap.org%2Fsoap%2Fenvelope%2F%0A%0AS12%0A%09%0A%0Ahttp%3A%2F%2Fwww.w3.org%2F2003%2F05%2Fsoap-envelope%0A%0Awsse%0A%09%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-secext-1.0.xsd%0A%0Awsse11%0A%09%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Foasis-wss-wssecurity-secext-1.1.xsd%0A%0Awsu%0A%09%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-wssecurity-utility-1.0.xsd%0A%0Axenc%0A%09%0A%0Ahttp%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmlenc%23%0A%0A%20%0A%0AThe%20URLs%20provided%20for%20the%20wsse%20and%20wsu%20namespaces%20can%20be%20used%20to%20obtain%20the%20schema%20files.%0A%0A%20%0A%0AURI%20fragments%20defined%20in%20this%20document%20are%20relative%20to%20the%20following%20base%20URI%20%20unless%20otherwise%20stated%3A%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-soap-message-security-1.0%0A2.3%20Acronyms%20and%20Abbreviations%0A%0AThe%20following%20(non-normative)%20table%20defines%20acronyms%20and%20abbreviations%20for%20this%20document.%0A%0A%20%0A%0ATerm%0A%09%0A%0ADefinition%0A%0AHMAC%0A%09%0A%0AKeyed-Hashing%20for%20Message%20Authentication%0A%0ASHA-1%0A%09%0A%0ASecure%20Hash%20Algorithm%201%0A%0ASOAP%0A%09%0A%0ASimple%20Object%20Access%20Protocol%0A%0AURI%0A%09%0A%0AUniform%20Resource%20Identifier%0A%0AXML%0A%09%0A%0AExtensible%20Markup%20Language%0A2.4%20Terminology%0A%0ADefined%20below%20are%20the%20basic%20definitions%20for%20the%20security%20terminology%20used%20in%20this%20specification.%0A%0A%20%0A%0AClaim%20%E2%80%93%20A%20claim%20is%20a%20declaration%20made%20by%20an%20entity%20(e.g.%20name%2C%20identity%2C%20key%2C%20group%2C%20privilege%2C%20capability%2C%20etc).%0A%0A%20%0A%0AClaim%20Confirmation%20%E2%80%93%20A%20claim%20confirmation%20is%20the%20process%20of%20verifying%20that%20a%20claim%20applies%20to%20an%20entity.%0A%0A%20%0A%0AConfidentiality%20%E2%80%93%20Confidentiality%20is%20the%20property%20that%20data%20is%20not%20made%20available%20to%20unauthorized%20individuals%2C%20entities%2C%20or%20processes.%0A%0A%20%0A%0ADigest%20%E2%80%93%20A%20digest%20is%20a%20cryptographic%20checksum%20of%20an%20octet%20stream.%0A%0A%20%0A%0ADigital%20Signature%20%E2%80%93%20A%20digital%20signature%20is%20a%20value%20computed%20with%20a%20cryptographic%20algorithm%20and%20bound%20to%20data%20in%20such%20a%20way%20that%20intended%20recipients%20of%20the%20data%20can%20use%20the%20digital%20signature%20to%20verify%20that%20the%20data%20has%20not%20been%20altered%20and%2For%20has%20originated%20from%20the%20signer%20of%20the%20message%2C%20providing%20message%20integrity%20and%20authentication.%20The%20digital%20signature%20can%20be%20computed%20and%20verified%20with%20symmetric%20key%20algorithms%2C%20where%20the%20same%20key%20is%20used%20for%20signing%20and%20verifying%2C%20or%20with%20asymmetric%20key%20algorithms%2C%20where%20different%20keys%20are%20used%20for%20signing%20and%20verifying%20(a%20private%20and%20public%20key%20pair%20are%20used).%0A%0A%20%0A%0AEnd-To-End%20Message%20Level%20Security%20-%20End-to-end%20message%20level%20security%20is%20established%20when%20a%20message%20that%20traverses%20multiple%20applications%20(one%20or%20more%20SOAP%20intermediaries)%20within%20and%20between%20business%20entities%2C%20e.g.%20companies%2C%20divisions%20and%20business%20units%2C%20is%20secure%20over%20its%20full%20route%20through%20and%20between%20those%20business%20entities.%20%20This%20includes%20not%20only%20messages%20that%20are%20initiated%20within%20the%20entity%20but%20also%20those%20messages%20that%20originate%20outside%20the%20entity%2C%20whether%20they%20are%20Web%20Services%20or%20the%20more%20traditional%20messages.%0A%0A%20%0A%0AIntegrity%20%E2%80%93%20Integrity%20is%20the%20property%20that%20data%20has%20not%20been%20modified.%0A%0A%20%0A%0AMessage%20Confidentiality%20-%20Message%20Confidentiality%20is%20a%20property%20of%20the%20message%20and%20encryption%20is%20the%20mechanism%20by%20which%20this%20property%20of%20the%20message%20is%20provided.%0A%0A%20%0A%0AMessage%20Integrity%20-%20Message%20Integrity%20is%20a%20property%20of%20the%20message%20and%20digital%20signature%20is%20a%20mechanism%20by%20which%20this%20property%20of%20the%20message%20is%20provided.%0A%0A%20%0A%0ASignature%20-%20In%20this%20document%2C%20signature%20and%20digital%20signature%20are%20used%20interchangeably%20and%20have%20the%20same%20meaning.%0A%0A%20%0A%0ASecurity%20Token%20%E2%80%93%20A%20security%20token%20represents%20a%20collection%20(one%20or%20more)%20of%20claims.%0A%0A%20%0A%0A%20%0A%0ASigned%20Security%20Token%20%E2%80%93%20A%20signed%20security%20token%20is%20a%20security%20token%20that%20is%20asserted%20and%20cryptographically%20signed%20by%20a%20specific%20authority%20(e.g.%20an%20X.509%20certificate%20or%20a%20Kerberos%20ticket).%0A%0A%20%0A%0ATrust%20-%20Trust%20is%20the%20characteristic%20that%20one%20entity%20is%20willing%20to%20rely%20upon%20a%20second%20entity%20to%20execute%20a%20set%20of%20actions%20and%2For%20to%20make%20set%20of%20assertions%20about%20a%20set%20of%20subjects%20and%2For%20scopes.%0A2.5%20Note%20on%20Examples%0A%0AThe%20examples%20which%20appear%20in%20this%20document%20are%20only%20intended%20to%20illustrate%20the%20correct%20syntax%20%20of%20the%20features%20being%20specified.%20The%20examples%20are%20NOT%20intended%20to%20necessarily%20represent%20best%20practice%20for%20implementing%20any%20particular%20security%20properties.%0A%0A%20%0A%0ASpecifically%2C%20the%20examples%20are%20constrained%20to%20contain%20only%20mechanisms%20defined%20in%20this%20document.%20The%20only%20reason%20for%20this%20is%20to%20avoid%20requiring%20the%20reader%20to%20consult%20other%20documents%20merely%20to%20understand%20the%20examples.%20It%20is%20NOT%20intended%20to%20suggest%20that%20the%20mechanisms%20illustrated%20represent%20best%20practice%20or%20are%20the%20strongest%20available%20to%20implement%20the%20security%20properties%20in%20question.%20In%20particular%2C%20mechanisms%20defined%20in%20other%20Token%20Profiles%20are%20known%20to%20be%20stronger%2C%20more%20efficient%20and%2For%20generally%20superior%20to%20some%20of%20the%20mechanisms%20shown%20in%20the%20examples%20in%20this%20document.%0A3%20%20%20%20%20%20Message%20Protection%20Mechanisms%0A%0AWhen%20securing%20SOAP%20messages%2C%20various%20types%20of%20threats%20should%20be%20considered.%20This%20includes%2C%20but%20is%20not%20limited%20to%3A%0A%0A%20%0A%0A%20%20%20%20the%20message%20could%20be%20modified%20or%20read%20by%20attacker%20or%0A%20%20%20%20an%20antagonist%20could%20send%20messages%20to%20a%20service%20that%2C%20while%20well-formed%2C%20lack%20appropriate%20security%20claims%20to%20warrant%20processing%0A%20%20%20%20an%20antagonist%20could%20alter%20a%20message%20to%20the%20service%20which%20being%20well%20formed%20causes%20the%20service%20to%20process%20and%20respond%20to%20the%20client%20for%20an%20incorrect%20request.%0A%0A%20%0A%0ATo%20understand%20these%20threats%20this%20specification%20defines%20a%20message%20security%20model.%0A3.1%20Message%20Security%20Model%0A%0AThis%20document%20specifies%20an%20abstract%20message%20security%20model%20in%20terms%20of%20security%20tokens%20combined%20with%20digital%20signatures%20to%20protect%20and%20authenticate%20SOAP%20messages.%0A%0A%20%0A%0ASecurity%20tokens%20assert%20claims%20and%20can%20be%20used%20to%20assert%20the%20binding%20between%20authentication%20secrets%20or%20keys%20and%20security%20identities.%20An%20authority%20can%20vouch%20for%20or%20endorse%20the%20claims%20in%20a%20security%20token%20by%20using%20its%20key%20to%20sign%20or%20encrypt%20(it%20is%20recommended%20to%20use%20a%20keyed%20encryption)%20the%20security%20token%20thereby%20enabling%20the%20authentication%20of%20the%20claims%20in%20the%20token.%20An%20X.509%20%5BX509%5D%20certificate%2C%20claiming%20the%20binding%20between%20one%E2%80%99s%20identity%20and%20public%20key%2C%20is%20an%20example%20of%20a%20signed%20security%20token%20endorsed%20by%20the%20certificate%20authority.%20In%20the%20absence%20of%20endorsement%20by%20a%20third%20party%2C%20the%20recipient%20of%20a%20security%20token%20may%20choose%20to%20accept%20the%20claims%20made%20in%20the%20token%20based%20on%20its%20trust%20of%20the%20producer%20of%20the%20containing%20message.%0A%0A%20%0A%0ASignatures%20are%20used%20to%20verify%20message%20origin%20and%20integrity.%20Signatures%20are%20also%20used%20by%20message%20producers%20to%20demonstrate%20knowledge%20of%20the%20key%2C%20typically%20from%20a%20third%20party%2C%20%20used%20to%20confirm%20the%20claims%20in%20a%20security%20token%20and%20thus%20to%20bind%20their%20identity%20(and%20any%20other%20claims%20occurring%20in%20the%20security%20token)%20to%20the%20messages%20they%20create.%0A%0A%20%0A%0AIt%20should%20be%20noted%20that%20this%20security%20model%2C%20by%20itself%2C%20is%20subject%20to%20multiple%20security%20attacks.%20%20Refer%20to%20the%20Security%20Considerations%20section%20for%20additional%20details.%0A%0A%20%0A%0AWhere%20the%20specification%20requires%20that%20an%20element%20be%20%22processed%22%20it%20means%20that%20the%20element%20type%20MUST%20be%20recognized%20to%20the%20extent%20that%20an%20appropriate%20error%20is%20returned%20if%20the%20element%20is%20not%20supported.%0A3.2%20Message%20Protection%0A%0AProtecting%20the%20message%20content%20from%20being%20disclosed%20(confidentiality)%20or%20modified%20without%20detection%20(integrity)%20are%20primary%20security%20concerns.%20This%20specification%20provides%20a%20means%20to%20protect%20a%20message%20by%20encrypting%20and%2For%20digitally%20signing%20a%20body%2C%20a%20header%2C%20or%20any%20combination%20of%20them%20(or%20parts%20of%20them).%0A%0A%20%0A%0AMessage%20integrity%20is%20provided%20by%20XML%20Signature%20%5BXMLSIG%5D%20in%20conjunction%20with%20security%20tokens%20to%20ensure%20that%20modifications%20to%20messages%20are%20detected.%20%20The%20integrity%20mechanisms%20are%20designed%20to%20support%20multiple%20signatures%2C%20potentially%20by%20multiple%20SOAP%20actors%2Froles%2C%20and%20to%20be%20extensible%20to%20support%20additional%20signature%20formats.%0A%0A%20%0A%0AMessage%20confidentiality%20leverages%20XML%20Encryption%20%5BXMLENC%5D%20in%20conjunction%20with%20security%20tokens%20to%20keep%20portions%20of%20a%20SOAP%20message%20confidential.%20The%20encryption%20mechanisms%20are%20designed%20to%20support%20additional%20encryption%20processes%20and%20operations%20by%20multiple%20SOAP%20actors%2Froles.%0A%0A%20%0A%0AThis%20document%20defines%20syntax%20and%20semantics%20of%20signatures%20within%20a%20%3Cwsse%3ASecurity%3E%20element.%20%20This%20document%20does%20not%20constrain%20any%20signature%20appearing%20outside%20of%20a%20%3Cwsse%3ASecurity%3E%20element.%0A3.3%20Invalid%20or%20Missing%20Claims%0A%0AA%20message%20recipient%20SHOULD%20reject%20messages%20containing%20invalid%20signatures%2C%20messages%20missing%20necessary%20claims%20or%20messages%20whose%20claims%20have%20unacceptable%20values.%20Such%20messages%20are%20unauthorized%20(or%20malformed).%20This%20specification%20provides%20a%20flexible%20way%20for%20the%20message%20producer%20to%20make%20a%20claim%20about%20the%20security%20properties%20by%20associating%20zero%20or%20more%20security%20tokens%20with%20the%20message.%20%20An%20example%20of%20a%20security%20claim%20is%20the%20identity%20of%20the%20producer%3B%20the%20producer%20can%20claim%20that%20he%20is%20Bob%2C%20known%20as%20an%20employee%20of%20some%20company%2C%20and%20therefore%20he%20has%20the%20right%20to%20send%20the%20message.%0A3.4%20Example%0A%0AThe%20following%20example%20illustrates%20the%20use%20of%20a%20custom%20security%20token%20and%20associated%20signature.%20The%20token%20contains%20base64%20encoded%20binary%20data%20conveying%20a%20symmetric%20key%20which%2C%20we%20assume%2C%20can%20be%20properly%20authenticated%20by%20the%20recipient.%20%20The%20message%20producer%20uses%20the%20symmetric%20key%20with%20an%20HMAC%20signing%20algorithm%20to%20sign%20the%20message.%20The%20message%20receiver%20uses%20its%20knowledge%20of%20the%20shared%20secret%20to%20repeat%20the%20HMAC%20key%20calculation%20which%20it%20uses%20to%20validate%20the%20signature%20and%20in%20the%20process%20confirm%20that%20the%20message%20was%20authored%20by%20the%20claimed%20user%20identity.%20%0A%0A%20%0A%0A(001)%20%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0A%0A(002)%20%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%20xmlns%3Awsu%3D%22...%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20xmlns%3Ads%3D%22...%22%3E%0A%0A(003)%20%20%20%3CS11%3AHeader%3E%0A%0A(004)%20%20%20%20%20%20%3Cwsse%3ASecurity%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20xmlns%3Awsse%3D%22...%22%3E%0A%0A(005)%20%20%20%20%20%3Cwsse%3ABinarySecurityToken%20ValueType%3D%22%20http%3A%2F%2Ffabrikam123%23CustomToken%20%22%0A%0A%20%20%20%20%20%20EncodingType%3D%22...%23Base64Binary%22%20wsu%3AId%3D%22%20MyID%20%22%3E%0A%0A(006)%20%20%20%20%20%20%20%20%20%20%20FHUIORv...%0A%0A(007)%20%20%20%20%20%3C%2Fwsse%3ABinarySecurityToken%3E%0A%0A(008)%20%20%20%20%20%20%20%20%20%3Cds%3ASignature%3E%0A%0A(009)%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignedInfo%3E%0A%0A(010)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ACanonicalizationMethod%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2001%2F10%2Fxml-exc-c14n%23%22%2F%3E%0A%0A(011)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignatureMethod%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23hmac-sha1%22%2F%3E%0A%0A(012)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AReference%20URI%3D%22%23MsgBody%22%3E%0A%0A(013)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestMethod%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23sha1%22%2F%3E%0A%0A(014)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestValue%3ELyLsF0Pi4wPU...%3C%2Fds%3ADigestValue%3E%0A%0A(015)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AReference%3E%0A%0A(016)%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignedInfo%3E%0A%0A(017)%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignatureValue%3EDJbchm5gK...%3C%2Fds%3ASignatureValue%3E%0A%0A(018)%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AKeyInfo%3E%0A%0A(019)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3ASecurityTokenReference%3E%0A%0A(020)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3AReference%20URI%3D%22%23MyID%22%2F%3E%0A%0A(021)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A(022)%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AKeyInfo%3E%0A%0A(023)%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignature%3E%0A%0A(024)%20%20%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A(025)%20%20%20%3C%2FS11%3AHeader%3E%0A%0A(026)%20%20%20%3CS11%3ABody%20wsu%3AId%3D%22MsgBody%22%3E%0A%0A(027)%20%20%20%20%20%3Ctru%3AStockSymbol%20xmlns%3Atru%3D%22http%3A%2F%2Ffabrikam123.com%2Fpayloads%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20QQQ%0A%20%20%20%20%20%20%20%20%20%20%3C%2Ftru%3AStockSymbol%3E%0A%0A(028)%20%20%20%3C%2FS11%3ABody%3E%0A%0A(029)%20%3C%2FS11%3AEnvelope%3E%0A%0A%20%0A%0AThe%20first%20two%20lines%20start%20the%20SOAP%20envelope.%20%20Line%20(003)%20begins%20the%20headers%20that%20are%20associated%20with%20this%20SOAP%20message.%20%0A%0A%20%0A%0ALine%20(004)%20starts%20the%20%3Cwsse%3ASecurity%3E%20header%20defined%20in%20this%20specification.%20%20This%20header%20contains%20security%20information%20for%20an%20intended%20recipient.%20%20This%20element%20continues%20until%20line%20(024).%0A%0A%20%0A%0ALines%20(005)%20to%20(007)%20specify%20a%20custom%20token%20that%20is%20associated%20with%20the%20message.%20%20In%20this%20case%2C%20it%20uses%20an%20externally%20defined%20custom%20token%20format.%0A%0A%20%0A%0ALines%20(008)%20to%20(023)%20specify%20a%20digital%20signature.%20This%20signature%20ensures%20the%20integrity%20of%20the%20signed%20elements.%20%20The%20signature%20uses%20the%20XML%20Signature%20specification%20identified%20by%20the%20ds%20namespace%20declaration%20in%20Line%20(002).%0A%0A%20%0A%0ALines%20(009)%20to%20(016)%20describe%20what%20is%20being%20signed%20and%20the%20type%20of%20canonicalization%20being%20used.%0A%0A%20%0A%0ALine%20(010)%20specifies%20how%20to%20canonicalize%20(normalize)%20the%20data%20that%20is%20being%20signed.%20Lines%20(012)%20to%20(015)%20select%20the%20elements%20that%20are%20signed%20and%20how%20to%20digest%20them.%20%20Specifically%2C%20line%20(012)%20indicates%20that%20the%20%3CS11%3ABody%3E%20element%20is%20signed.%20%20In%20this%20example%20only%20the%20message%20body%20is%20signed%3B%20typically%20all%20critical%20elements%20of%20the%20message%20are%20included%20in%20the%20signature%20(see%20the%20Extended%20Example%20below).%0A%0A%20%0A%0ALine%20(017)%20specifies%20the%20signature%20value%20of%20the%20canonicalized%20form%20of%20the%20data%20that%20is%20being%20signed%20as%20defined%20in%20the%20XML%20Signature%20specification.%0A%0A%20%0A%0ALines%20(018)%20to%20(022)%20provides%20information%2C%20partial%20or%20complete%2C%20as%20to%20where%20to%20find%20the%20security%20token%20associated%20with%20this%20signature.%20%20Specifically%2C%20lines%20(019)%20to%20(021)%20indicate%20that%20the%20security%20token%20can%20be%20found%20at%20(pulled%20from)%20the%20specified%20URL.%0A%0A%20%0A%0ALines%20(026)%20to%20(028)%20contain%20the%20body%20(payload)%20of%20the%20SOAP%20message.%0A4%20%20%20%20%20%20ID%20References%0A%0AThere%20are%20many%20motivations%20for%20referencing%20other%20message%20elements%20such%20as%20signature%20references%20or%20correlating%20signatures%20to%20security%20tokens.%20%20For%20this%20reason%2C%20this%20specification%20defines%20the%20wsu%3AId%20attribute%20so%20that%20recipients%20need%20not%20understand%20the%20full%20schema%20of%20the%20message%20for%20processing%20of%20the%20security%20elements.%20%20That%20is%2C%20they%20need%20only%20%22know%22%20that%20the%20wsu%3AId%20attribute%20represents%20a%20schema%20type%20of%20ID%20which%20is%20used%20to%20reference%20elements.%20%20However%2C%20because%20some%20key%20schemas%20used%20by%20this%20specification%20don%27t%20allow%20attribute%20extensibility%20(namely%20XML%20Signature%20and%20XML%20Encryption)%2C%20this%20specification%20also%20allows%20use%20of%20their%20local%20ID%20attributes%20in%20addition%20to%20the%20wsu%3AId%20attribute%20and%20the%20xml%3Aid%20attribute%20%5BXMLID%5D.%20%20As%20a%20consequence%2C%20when%20trying%20to%20locate%20an%20element%20referenced%20in%20a%20signature%2C%20the%20following%20attributes%20are%20considered%20(in%20no%20particular%20order)%3A%0A%0A%20%0A%0A%20%20%20%20Local%20ID%20attributes%20on%20XML%20Signature%20elements%0A%20%20%20%20Local%20ID%20attributes%20on%20XML%20Encryption%20elements%0A%20%20%20%20Global%20wsu%3AId%20attributes%20(described%20below)%20on%20elements%0A%20%20%20%20Profile%20specific%20defined%20identifiers%0A%20%20%20%20Global%20xml%3Aid%20attributes%20on%20elements%0A%0A%20%0A%0AIn%20addition%2C%20when%20signing%20a%20part%20of%20an%20envelope%20such%20as%20the%20body%2C%20it%20is%20RECOMMENDED%20that%20an%20ID%20reference%20is%20used%20instead%20of%20a%20more%20general%20transformation%2C%20especially%20XPath%20%5BXPATH%5D.%20%20This%20is%20to%20simplify%20processing.%0A%0A%20%0A%0ATokens%20and%20elements%20that%20are%20defined%20in%20this%20specification%20and%20related%20profiles%20to%20use%20wsu%3AId%20attributes%20SHOULD%20use%20wsu%3AId.%20Elements%20to%20be%20signed%20MAY%20use%20xml%3Aid%20%5BXMLID%5D%20or%20wsu%3AId%2C%20and%20use%20of%20xml%3Aid%20MAY%20be%20specified%20in%20profiles.%20All%20receivers%20MUST%20be%20able%20to%20identify%20XML%20elements%20carrying%20a%20wsu%3AId%20attribute%20as%20representing%20an%20attribute%20of%20schema%20type%20ID%20and%20process%20it%20accordingly.%0A%0A%20%0A%0AAll%20receivers%20MAY%20be%20able%20to%20identify%20XML%20elements%20with%20a%20xml%3Aid%20attribute%20as%20representing%20an%20ID%20attribute%20and%20process%20it%20accordingly.%20Senders%20SHOULD%20use%20wsu%3AId%20and%20MAY%20use%20xml%3Aid.%20Note%20that%20use%20of%20xml%3Aid%20in%20conjunction%20with%20inclusive%20canonicalization%20may%20be%20inappropriate%2C%20as%20noted%20in%20%5BXMLID%5D%20and%20thus%20this%20combination%20SHOULD%20be%20avoided.%0A%0A%20%0A4.1%20Id%20Attribute%0A%0AThere%20are%20many%20situations%20where%20elements%20within%20SOAP%20messages%20need%20to%20be%20referenced.%20%20For%20example%2C%20when%20signing%20a%20SOAP%20message%2C%20selected%20elements%20are%20included%20in%20the%20scope%20of%20the%20signature.%20%20XML%20Schema%20Part%202%20%5BXMLSCHEMA%5D%20provides%20several%20built-in%20data%20types%20that%20may%20be%20used%20for%20identifying%20and%20referencing%20elements%2C%20but%20their%20use%20requires%20that%20consumers%20of%20the%20SOAP%20message%20either%20have%20or%20must%20be%20able%20to%20obtain%20the%20schemas%20where%20the%20identity%20or%20reference%20mechanisms%20are%20defined.%20%20In%20some%20circumstances%2C%20for%20example%2C%20intermediaries%2C%20this%20can%20be%20problematic%20and%20not%20desirable.%0A%0A%20%0A%0AConsequently%20a%20mechanism%20is%20required%20for%20identifying%20and%20referencing%20elements%2C%20based%20on%20the%20SOAP%20foundation%2C%20which%20does%20not%20rely%20upon%20complete%20schema%20knowledge%20of%20the%20context%20in%20which%20an%20element%20is%20used.%20This%20functionality%20can%20be%20integrated%20into%20SOAP%20processors%20so%20that%20elements%20can%20be%20identified%20and%20referred%20to%20without%20dynamic%20schema%20discovery%20and%20processing.%0A%0A%20%0A%0AThis%20section%20specifies%20a%20namespace-qualified%20global%20attribute%20for%20identifying%20an%20element%20which%20can%20be%20applied%20to%20any%20element%20that%20either%20allows%20arbitrary%20attributes%20or%20specifically%20allows%20a%20particular%20attribute.%0A%0A%20%0A%0AAlternatively%2C%20the%20xml%3Aid%20attribute%20MAY%20be%20used.%20Applications%20MUST%20NOT%20specify%20both%20a%20wsu%3AId%20and%20xml%3Aid%20attribute%20on%20a%20single%20element.%20It%20is%20an%20XML%20requirement%20that%20only%20one%20id%20attribute%20be%20specified%20on%20a%20single%20element.%0A4.2%20Id%20Schema%0A%0ATo%20simplify%20the%20processing%20for%20intermediaries%20and%20recipients%2C%20a%20common%20attribute%20is%20defined%20for%20identifying%20an%20element.%20%20This%20attribute%20utilizes%20the%20XML%20Schema%20ID%20type%20and%20specifies%20a%20common%20attribute%20for%20indicating%20this%20information%20for%20elements.%0A%0AThe%20syntax%20for%20this%20attribute%20is%20as%20follows%3A%0A%0A%20%0A%0A%3CanyElement%20wsu%3AId%3D%22...%22%3E...%3C%2FanyElement%3E%0A%0A%20%0A%0AThe%20following%20describes%20the%20attribute%20illustrated%20above%3A%0A%0A...%2F%40wsu%3AId%0A%0AThis%20attribute%2C%20defined%20as%20type%20xsd%3AID%2C%20provides%20a%20well-known%20attribute%20for%20specifying%20the%20local%20ID%20of%20an%20element.%0A%0A%20%0A%0ATwo%20wsu%3AId%20attributes%20within%20an%20XML%20document%20MUST%20NOT%20have%20the%20same%20value.%20Implementations%20MAY%20rely%20on%20XML%20Schema%20validation%20to%20provide%20rudimentary%20enforcement%20for%20intra-document%20uniqueness.%20%20However%2C%20applications%20SHOULD%20NOT%20rely%20on%20schema%20validation%20alone%20to%20enforce%20uniqueness.%0A%0A%20%0A%0AThis%20specification%20does%20not%20specify%20how%20this%20attribute%20will%20be%20used%20and%20it%20is%20expected%20that%20other%20specifications%20MAY%20add%20additional%20semantics%20(or%20restrictions)%20for%20their%20usage%20of%20this%20attribute.%0A%0AThe%20following%20example%20illustrates%20use%20of%20this%20attribute%20to%20identify%20an%20element%3A%0A%0A%20%0A%0A%3Cx%3AmyElement%20wsu%3AId%3D%22ID1%22%20xmlns%3Ax%3D%22...%22%0A%20%20%20%20%20%20%20%20%20%20%20xmlns%3Awsu%3D%22...%22%2F%3E%0A%0A%20%0A%0AConformant%20processors%20that%20do%20support%20XML%20Schema%20MUST%20treat%20this%20attribute%20as%20if%20it%20was%20defined%20using%20a%20global%20attribute%20declaration.%0A%0A%20%0A%0AConformant%20processors%20that%20do%20not%20support%20dynamic%20XML%20Schema%20or%20DTDs%20discovery%20and%20processing%20are%20strongly%20encouraged%20to%20integrate%20this%20attribute%20definition%20into%20their%20parsers.%20%20That%20is%2C%20to%20treat%20this%20attribute%20information%20item%20as%20if%20its%20PSVI%20has%20a%20%5Btype%20definition%5D%20which%20%7Btarget%20namespace%7D%20is%20%22http%3A%2F%2Fwww.w3.org%2F2001%2FXMLSchema%22%20and%20which%20%7Btype%7D%20is%20%22ID.%22%20Doing%20so%20allows%20the%20processor%20to%20inherently%20know%20how%20to%20process%20the%20attribute%20without%20having%20to%20locate%20and%20process%20the%20associated%20schema.%20%20Specifically%2C%20implementations%20MAY%20support%20the%20value%20of%20the%20wsu%3AId%20as%20the%20valid%20identifier%20for%20use%20as%20an%20XPointer%20%5BXPointer%5D%20shorthand%20pointer%20for%20interoperability%20with%20XML%20Signature%20references.%0A%0A%20%0A5%20%20%20%20%20%20Security%20Header%0A%0AThe%20%3Cwsse%3ASecurity%3E%20header%20block%20provides%20a%20mechanism%20for%20attaching%20security-related%20information%20targeted%20at%20a%20specific%20recipient%20in%20the%20form%20of%20a%20SOAP%20actor%2Frole.%20%20This%20may%20be%20either%20the%20ultimate%20recipient%20of%20the%20message%20or%20an%20intermediary.%20%20Consequently%2C%20elements%20of%20this%20type%20may%20be%20present%20multiple%20times%20in%20a%20SOAP%20message.%20%20An%20active%20intermediary%20on%20the%20message%20path%20MAY%20add%20one%20or%20more%20new%20sub-elements%20to%20an%20existing%20%3Cwsse%3ASecurity%3E%20header%20block%20if%20they%20are%20targeted%20for%20its%20SOAP%20node%20or%20it%20MAY%20add%20one%20or%20more%20new%20headers%20for%20additional%20targets.%0A%0A%20%0A%0AAs%20stated%2C%20a%20message%20MAY%20have%20multiple%20%3Cwsse%3ASecurity%3E%20header%20blocks%20if%20they%20are%20targeted%20for%20separate%20recipients.%20A%20message%20MUST%20NOT%20have%20multiple%20%3Cwsse%3ASecurity%3E%20header%20blocks%20targeted%20(whether%20explicitly%20or%20implicitly)%20at%20the%20same%20recipient.%20However%2C%20only%20one%20%3Cwsse%3ASecurity%3E%20header%20block%20MAY%20omit%20the%20S11%3Aactor%20or%20S12%3Arole%20attributes.%20Two%20%3Cwsse%3ASecurity%3E%20header%20blocks%20MUST%20NOT%20have%20the%20same%20value%20for%20S11%3Aactor%20or%20S12%3Arole.%20%20Message%20security%20information%20targeted%20for%20different%20recipients%20MUST%20appear%20in%20different%20%3Cwsse%3ASecurity%3E%20header%20blocks.%20%20This%20is%20due%20to%20potential%20processing%20order%20issues%20(e.g.%20due%20to%20possible%20header%20re-ordering).%20The%20%3Cwsse%3ASecurity%3E%20header%20block%20without%20a%20specified%20S11%3Aactor%20or%20S12%3Arole%20MAY%20be%20processed%20by%20anyone%2C%20but%20MUST%20NOT%20be%20removed%20prior%20to%20the%20final%20destination%20or%20endpoint.%0A%0A%20%0A%0AAs%20elements%20are%20added%20to%20a%20%3Cwsse%3ASecurity%3E%20header%20block%2C%20they%20SHOULD%20be%20prepended%20to%20the%20existing%20elements.%20%20As%20such%2C%20the%20%3Cwsse%3ASecurity%3E%20header%20block%20represents%20the%20signing%20and%20encryption%20steps%20the%20message%20producer%20took%20to%20create%20the%20message.%20%20This%20prepending%20rule%20ensures%20that%20the%20receiving%20application%20can%20process%20sub-elements%20in%20the%20order%20they%20appear%20in%20the%20%3Cwsse%3ASecurity%3E%20header%20block%2C%20because%20there%20will%20be%20no%20forward%20dependency%20among%20the%20sub-elements.%20%20Note%20that%20this%20specification%20does%20not%20impose%20any%20specific%20order%20of%20processing%20the%20sub-elements.%20%20The%20receiving%20application%20can%20use%20whatever%20order%20is%20required.%0A%0A%20%0A%0AWhen%20a%20sub-element%20refers%20to%20a%20key%20carried%20in%20another%20sub-element%20(for%20example%2C%20a%20signature%20sub-element%20that%20refers%20to%20a%20binary%20security%20token%20sub-element%20that%20contains%20the%20X.509%20certificate%20used%20for%20the%20signature)%2C%20the%20key-bearing%20element%20SHOULD%20be%20ordered%20to%20precede%20the%20key-using%0A%0AElement%3A%0A%0A%20%0A%0A%3CS11%3AEnvelope%3E%0A%0A%20%20%20%20%3CS11%3AHeader%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%3Cwsse%3ASecurity%20S11%3Aactor%3D%22...%22%20S11%3AmustUnderstand%3D%22...%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%3C%2FS11%3AHeader%3E%0A%0A%20%20%20%20...%0A%0A%3C%2FS11%3AEnvelope%3E%20%20%20%20%20%20%0A%0A%20%0A%0AThe%20following%20describes%20the%20attributes%20and%20elements%20listed%20in%20the%20example%20above%3A%0A%0A%2Fwsse%3ASecurity%0A%0AThis%20is%20the%20header%20block%20for%20passing%20security-related%20message%20information%20to%20a%20recipient.%0A%0A%20%0A%0A%2Fwsse%3ASecurity%2F%40S11%3Aactor%0A%0AThis%20attribute%20allows%20a%20specific%20SOAP%201.1%20%5BSOAP11%5D%20actor%20to%20be%20identified.%20%20This%20attribute%20is%20optional%3B%20however%2C%20no%20two%20instances%20of%20the%20header%20block%20may%20omit%20an%20actor%20or%20specify%20the%20same%20actor.%0A%0A%20%0A%0A%2Fwsse%3ASecurity%2F%40S12%3Arole%0A%0AThis%20attribute%20allows%20a%20specific%20SOAP%201.2%20%5BSOAP12%5D%20role%20to%20be%20identified.%20%20This%20attribute%20is%20optional%3B%20however%2C%20no%20two%20instances%20of%20the%20header%20block%20may%20omit%20a%20role%20or%20specify%20the%20same%20role.%0A%0A%20%0A%0A%2Fwsse%3ASecurity%2F%40S11%3AmustUnderstand%0A%0AThis%20SOAP%201.1%20%5BSOAP11%5D%20attribute%20is%20used%20to%20indicate%20whether%20a%20header%20entry%20is%20mandatory%20or%20optional%20for%20the%20recipient%20to%20process.%20The%20value%20of%20the%20mustUnderstand%20attribute%20is%20either%20%221%22%20or%20%220%22.%20The%20absence%20of%20the%20SOAP%20mustUnderstand%20attribute%20is%20semantically%20equivalent%20to%20its%20presence%20with%20the%20value%20%220%22.%0A%0A%20%0A%0A%2Fwsse%3ASecurity%2F%40S12%3AmustUnderstand%0A%0AThis%20SOAP%201.2%20%5BSPOAP12%5D%20attribute%20is%20used%20to%20indicate%20whether%20a%20header%20entry%20is%20mandatory%20or%20optional%20for%20the%20recipient%20to%20process.%20The%20value%20of%20the%20mustUnderstand%20attribute%20is%20either%20%22true%22%2C%20%221%22%20%20%22false%22%20or%20%220%22.%20The%20absence%20of%20the%20SOAP%20mustUnderstand%20attribute%20is%20semantically%20equivalent%20to%20its%20presence%20with%20the%20value%20%22false%22.%0A%0A%20%0A%0A%2Fwsse%3ASecurity%2F%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20different%20(extensible)%20types%20of%20security%20information%2C%20based%20on%20a%20schema%2C%20to%20be%20passed.%20%20Unrecognized%20elements%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0A%2Fwsse%3ASecurity%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added%20to%20the%20header.%20Unrecognized%20attributes%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0AAll%20compliant%20implementations%20MUST%20be%20able%20to%20process%20a%20%3Cwsse%3ASecurity%3E%20element.%0A%0A%20%0A%0AAll%20compliant%20implementations%20MUST%20declare%20which%20profiles%20they%20support%20and%20MUST%20be%20able%20to%20process%20a%20%3Cwsse%3ASecurity%3E%20element%20including%20any%20sub-elements%20which%20may%20be%20defined%20by%20that%20profile.%20It%20is%20RECOMMENDED%20that%20undefined%20elements%20within%20the%20%3Cwsse%3ASecurity%3E%20header%20not%20be%20processed.%0A%0A%20%0A%0AThe%20next%20few%20sections%20outline%20elements%20that%20are%20expected%20to%20be%20used%20within%20a%20%3Cwsse%3ASecurity%3E%20header.%0A%0A%20%0A%0AWhen%20a%20%3Cwsse%3ASecurity%3E%20header%20includes%20a%20mustUnderstand%3D%22true%22%20attribute%3A%0A%0A%20%20%20%20The%20receiver%20MUST%20generate%20a%20SOAP%20fault%20if%20does%20not%20implement%20the%20WSS%3A%20SOAP%20Message%20Security%20specification%20corresponding%20to%20the%20namespace.%20Implementation%20means%20ability%20to%20interpret%20the%20schema%20as%20well%20as%20follow%20the%20required%20processing%20rules%20specified%20in%20WSS%3A%20SOAP%20Message%20Security.%0A%20%20%20%20The%20receiver%20MUST%20generate%20a%20fault%20if%20unable%20to%20interpret%20or%20process%20security%20tokens%20contained%20in%20the%20%3Cwsse%3ASecurity%3E%20header%20block%20according%20to%20the%20corresponding%20WSS%3A%20SOAP%20Message%20Security%20token%20profiles.%0A%20%20%20%20Receivers%20MAY%20ignore%20elements%20or%20extensions%20within%20the%20%3Cwsse%3ASecurity%3E%20element%2C%20based%20on%20local%20security%20policy.%0A%0A6%20%20%20%20%20%20Security%20Tokens%0A%0AThis%20chapter%20specifies%20some%20different%20types%20of%20security%20tokens%20and%20how%20they%20are%20attached%20to%20messages.%0A6.1%20Attaching%20Security%20Tokens%0A%0AThis%20specification%20defines%20the%20%3Cwsse%3ASecurity%3E%20header%20as%20a%20mechanism%20for%20conveying%20security%20information%20with%20and%20about%20a%20SOAP%20message.%20%20This%20header%20is%2C%20by%20design%2C%20extensible%20to%20support%20many%20types%20of%20security%20information.%0A%0A%20%0A%0AFor%20security%20tokens%20based%20on%20XML%2C%20the%20extensibility%20of%20the%20%3Cwsse%3ASecurity%3E%20header%20allows%20for%20these%20security%20tokens%20to%20be%20directly%20inserted%20into%20the%20header.%0A6.1.1%20Processing%20Rules%0A%0AThis%20specification%20describes%20the%20processing%20rules%20for%20using%20and%20processing%20XML%20Signature%20and%20XML%20Encryption.%20%20These%20rules%20MUST%20be%20followed%20when%20using%20any%20type%20of%20security%20token.%20%20Note%20that%20if%20signature%20or%20encryption%20is%20used%20in%20conjunction%20with%20security%20tokens%2C%20they%20MUST%20be%20used%20in%20a%20way%20that%20conforms%20to%20the%20processing%20rules%20defined%20by%20this%20specification.%0A6.1.2%20Subject%20Confirmation%0A%0AThis%20specification%20does%20not%20dictate%20if%20and%20how%20claim%20confirmation%20must%20be%20done%3B%20however%2C%20it%20does%20define%20how%20signatures%20may%20be%20used%20and%20associated%20with%20security%20tokens%20(by%20referencing%20the%20security%20tokens%20from%20the%20signature)%20as%20a%20form%20of%20claim%20confirmation.%0A6.2%20User%20Name%20Token%0A6.2.1%20Usernames%0A%0AThe%20%3Cwsse%3AUsernameToken%3E%20element%20is%20introduced%20as%20a%20way%20of%20providing%20a%20username.%20%20This%20element%20is%20optionally%20included%20in%20the%20%3Cwsse%3ASecurity%3E%20header.%0A%0AThe%20following%20illustrates%20the%20syntax%20of%20this%20element%3A%0A%0A%20%0A%0A%3Cwsse%3AUsernameToken%20wsu%3AId%3D%22...%22%3E%0A%0A%20%20%20%20%3Cwsse%3AUsername%3E...%3C%2Fwsse%3AUsername%3E%0A%0A%3C%2Fwsse%3AUsernameToken%3E%20%20%20%20%20%20%0A%0A%20%0A%0AThe%20following%20describes%20the%20attributes%20and%20elements%20listed%20in%20the%20example%20above%3A%0A%0A%20%0A%0A%2Fwsse%3AUsernameToken%0A%0AThis%20element%20is%20used%20to%20represent%20a%20claimed%20identity.%20%0A%0A%20%0A%0A%2Fwsse%3AUsernameToken%2F%40wsu%3AId%0A%0AA%20string%20label%20for%20this%20security%20token.%20The%20wsu%3AId%20allow%20for%20an%20open%20attribute%20model.%0A%0A%20%0A%0A%2Fwsse%3AUsernameToken%2Fwsse%3AUsername%0A%0AThis%20required%20element%20specifies%20the%20claimed%20identity.%0A%0A%20%0A%0A%2Fwsse%3AUsernameToken%2Fwsse%3AUsername%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added%20to%20the%20%3Cwsse%3AUsername%3E%20element.%0A%0A%20%0A%0A%2Fwsse%3AUsernameToken%2F%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20different%20(extensible)%20types%20of%20security%20information%2C%20based%20on%20a%20schema%2C%20to%20be%20passed.%20Unrecognized%20elements%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0A%2Fwsse%3AUsernameToken%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added%20to%20the%20%3Cwsse%3AUsernameToken%3E%20element.%20Unrecognized%20attributes%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0AAll%20compliant%20implementations%20MUST%20be%20able%20to%20process%20a%20%3Cwsse%3AUsernameToken%3E%20element.%0A%0AThe%20following%20illustrates%20the%20use%20of%20this%3A%0A%0A%20%0A%0A%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%3E%0A%0A%20%20%20%20%3CS11%3AHeader%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3AUsernameToken%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3AUsername%3EZoe%3C%2Fwsse%3AUsername%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3AUsernameToken%3E%0A%0A%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%3C%2FS11%3AHeader%3E%0A%0A%20%20%20%20...%0A%0A%3C%2FS11%3AEnvelope%3E%20%0A%0A%20%20%20%20%0A6.3%20Binary%20Security%20Tokens%0A6.3.1%20Attaching%20Security%20Tokens%0A%0AFor%20binary-formatted%20security%20tokens%2C%20this%20specification%20provides%20a%20%3Cwsse%3ABinarySecurityToken%3E%20element%20that%20can%20be%20included%20in%20the%20%3Cwsse%3ASecurity%3E%20header%20block.%20%0A6.3.2%20Encoding%20Binary%20Security%20Tokens%0A%0ABinary%20security%20tokens%20(e.g.%2C%20X.509%20certificates%20and%20Kerberos%20%5BKERBEROS%5D%20tickets)%20or%20other%20non-XML%20formats%20require%20a%20special%20encoding%20format%20for%20inclusion.%20%20This%20section%20describes%20a%20basic%20framework%20for%20using%20binary%20security%20tokens.%20%20Subsequent%20specifications%20MUST%20describe%20the%20rules%20for%20creating%20and%20processing%20specific%20binary%20security%20token%20formats.%0A%0A%20%0A%0AThe%20%3Cwsse%3ABinarySecurityToken%3E%20element%20defines%20two%20attributes%20that%20are%20used%20to%20interpret%20it.%20%20The%20ValueType%20attribute%20indicates%20what%20the%20security%20token%20is%2C%20for%20example%2C%20a%20Kerberos%20%20ticket.%0A%0AThe%20EncodingType%20tells%20how%20the%20security%20token%20is%20encoded%2C%20for%20example%20Base64Binary.%20%0A%0AThe%20following%20is%20an%20overview%20of%20the%20syntax%3A%0A%0A%20%0A%0A%3Cwsse%3ABinarySecurityToken%20wsu%3AId%3D...%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20EncodingType%3D...%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ValueType%3D...%2F%3E%0A%0A%20%0A%0AThe%20following%20describes%20the%20attributes%20and%20elements%20listed%20in%20the%20example%20above%3A%0A%0A%2Fwsse%3ABinarySecurityToken%0A%0AThis%20element%20is%20used%20to%20include%20a%20binary-encoded%20security%20token.%0A%0A%20%0A%0A%2Fwsse%3ABinarySecurityToken%2F%40wsu%3AId%0A%0AAn%20optional%20string%20label%20for%20this%20security%20token.%0A%0A%20%0A%0A%2Fwsse%3ABinarySecurityToken%2F%40ValueType%0A%0AThe%20ValueType%20attribute%20is%20used%20to%20indicate%20the%20%22value%20space%22%20of%20the%20encoded%20binary%20data%20(e.g.%20an%20X.509%20certificate).%20%20The%20ValueType%20attribute%20allows%20a%20URI%20that%20defines%20the%20value%20type%20and%20space%20of%20the%20encoded%20binary%20data.%20Subsequent%20specifications%20MUST%20define%20the%20ValueType%20value%20for%20the%20tokens%20that%20they%20define.%20The%20usage%20of%20ValueType%20is%20RECOMMENDED.%0A%0A%20%0A%0A%2Fwsse%3ABinarySecurityToken%2F%40EncodingType%0A%0AThe%20EncodingType%20attribute%20is%20used%20to%20indicate%2C%20using%20a%20URI%2C%20the%20encoding%20format%20of%20the%20binary%20data%20(e.g.%2C%20base64%20encoded).%20%20A%20new%20attribute%20is%20introduced%2C%20as%20there%20are%20issues%20with%20the%20current%20schema%20validation%20tools%20that%20make%20derivations%20of%20mixed%20simple%20and%20complex%20types%20difficult%20within%20XML%20Schema.%20The%20EncodingType%20attribute%20is%20interpreted%20to%20indicate%20the%20encoding%20format%20of%20the%20element.%20The%20following%20encoding%20formats%20are%20pre-defined%3A%0A%0A%20%0A%0AURI%0A%09%0A%0ADescription%0A%0A%23Base64Binary%20(default)%0A%09%0A%0AXML%20Schema%20base%2064%20encoding%0A%0A%20%0A%0A%2Fwsse%3ABinarySecurityToken%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added.%0A%0A%20%0A%0AAll%20compliant%20implementations%20MUST%20be%20able%20to%20process%20a%20%3Cwsse%3ABinarySecurityToken%3E%20element.%0A6.4%20XML%20Tokens%0A%0AThis%20section%20presents%20a%20framework%20for%20using%20XML-based%20security%20tokens.%20%20Profile%20specifications%20describe%20rules%20and%20processes%20for%20specific%20XML-based%20security%20token%20formats.%0A6.5%20EncryptedData%20Token%0A%0AIn%20certain%20cases%20it%20is%20desirable%20that%20the%20token%20included%20in%20the%20%3Cwsse%3ASecurity%3E%20header%20be%20encrypted%20for%20the%20recipient%20processing%20role.%20In%20such%20a%20case%20the%20%3Cxenc%3AEncryptedData%3E%20element%20MAY%20be%20used%20to%20contain%20a%20security%20token%20and%20included%20in%20the%20%3Cwsse%3ASecurity%3E%20header.%20That%20is%20this%20specification%20defines%20the%20usage%20of%20%3Cxenc%3AEncryptedData%3E%20to%20encrypt%20security%20tokens%20contained%20in%20%3Cwsse%3ASecurity%3E%20header.%0A%0A%20%0A%0AIt%20should%20be%20noted%20that%20token%20references%20are%20not%20made%20to%20the%20%3Cxenc%3AEncryptedData%3E%20element%2C%20but%20instead%20to%20the%20token%20represented%20by%20the%20clear-text%2C%20once%20the%20%3Cxenc%3AEncryptedData%3E%20element%20has%20been%20processed%20(decrypted).%20%20Such%20references%20utilize%20the%20token%20profile%20for%20the%20contained%20token.%20i.e.%2C%20%3Cxenc%3AEncryptedData%3E%20SHOULD%20NOT%20include%20an%20XML%20ID%20for%20referencing%20the%20contained%20security%20token.%0A%0A%20%0A%0AAll%20%3Cxenc%3AEncryptedData%3E%20tokens%20SHOULD%20either%20have%20an%20embedded%20encryption%20key%20or%20should%20be%20referenced%20by%20a%20separate%20encryption%20key.%0A%0AWhen%20a%20%3Cxenc%3AEncryptedData%3E%20token%20is%20processed%2C%20it%20is%20replaced%20in%20the%20message%20infoset%20with%20its%20decrypted%20form.%0A6.6%20Identifying%20and%20Referencing%20Security%20Tokens%0A%0AThis%20specification%20also%20defines%20multiple%20mechanisms%20for%20identifying%20and%20referencing%20security%20tokens%20using%20the%20wsu%3AId%20attribute%20and%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element%20(as%20well%20as%20some%20additional%20mechanisms).%20%20Please%20refer%20to%20the%20specific%20profile%20documents%20for%20the%20appropriate%20reference%20mechanism.%20%20However%2C%20specific%20extensions%20MAY%20be%20made%20to%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element.%0A7%20%20%20%20%20%20Token%20References%0A%0AThis%20chapter%20discusses%20and%20defines%20mechanisms%20for%20referencing%20security%20tokens%20and%20other%20key%20bearing%20elements..%0A7.1%20SecurityTokenReference%20Element%0A%0ADigital%20signature%20and%20encryption%20operations%20require%20that%20a%20key%20be%20specified.%20%20For%20various%20reasons%2C%20the%20element%20containing%20the%20key%20in%20question%20may%20be%20located%20elsewhere%20in%20the%20message%20or%20completely%20outside%20the%20message.%20The%20%3Cwsse%3ASecurityTokenReference%3E%20element%20provides%20an%20extensible%20mechanism%20for%20referencing%20security%20tokens%20and%20other%20key%20bearing%20elements.%0A%0A%20%0A%0AThe%20%3Cwsse%3ASecurityTokenReference%3E%20element%20provides%20an%20open%20content%20model%20for%20referencing%20key%20bearing%20elements%20because%20not%20all%20of%20them%20support%20a%20common%20reference%20pattern.%20Similarly%2C%20some%20have%20closed%20schemas%20and%20define%20their%20own%20reference%20mechanisms.%20The%20open%20content%20model%20allows%20appropriate%20reference%20mechanisms%20to%20be%20used.%0A%0A%20%0A%0AIf%20a%20%3Cwsse%3ASecurityTokenReference%3E%20is%20used%20outside%20of%20the%20security%20header%20processing%20block%20the%20meaning%20of%20the%20response%20and%2For%20processing%20rules%20of%20the%20resulting%20references%20MUST%20be%20specified%20by%20the%20the%20specific%20profile%20and%20are%20out%20of%20scope%20of%20this%20specification.%0A%0AThe%20following%20illustrates%20the%20syntax%20of%20this%20element%3A%0A%0A%20%0A%0A%3Cwsse%3ASecurityTokenReference%20wsu%3AId%3D%22...%22%2C%20wsse11%3ATokenType%3D%22...%22%2C%20wsse%3AUsage%3D%22...%22%2C%20wsse%3AUsage%3D%22...%22%3E%0A%0A%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A%20%0A%0AThe%20following%20describes%20the%20elements%20defined%20above%3A%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%0A%0AThis%20element%20provides%20a%20reference%20to%20a%20security%20token.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2F%40wsu%3AId%0A%0AA%20string%20label%20for%20this%20security%20token%20reference%20which%20names%20the%20reference.%20%20This%20attribute%20does%20not%20indicate%20the%20ID%20of%20what%20is%20being%20referenced%2C%20that%20SHOULD%20be%20done%20using%20a%20fragment%20URI%20in%20a%20%3Cwsse%3AReference%3E%20element%20within%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2F%40wsse11%3ATokenType%0A%0AThis%20optional%20attribute%20is%20used%20to%20identify%2C%20by%20URI%2C%20the%20type%20of%20the%20referenced%20token.%0A%0AThis%20specification%20recommends%20that%20token%20specific%20profiles%20define%20appropriate%20token%20type%20identifying%20URI%20values%2C%20and%20that%20these%20same%20profiles%20require%20that%20these%20values%20be%20specified%20in%20the%20profile%20defined%20reference%20forms.%0A%0A%20%0A%0AWhen%20a%20wsse11%3ATokenType%20attribute%20is%20specified%20in%20conjunction%20with%20a%20wsse%3AKeyIdentifier%2F%40ValueType%20attribute%20or%20a%20wsse%3AReference%2F%40ValueType%0A%0Aattribute%20that%20indicates%20the%20type%20of%20the%20referenced%20token%2C%20the%20security%20token%20type%20identified%20by%20the%20wsse11%3ATokenType%20attribute%20MUST%20be%20consistent%20with%20the%20security%20token%20type%20identified%20by%20the%20wsse%3AValueType%20attribute.%0A%0A%20%0A%0AURI%0A%09%0A%0ADescription%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Foasis-wss-soap-message-security-1.1%23EncryptedKey%0A%09%0A%0AA%20token%20type%20of%20an%20%3Cxenc%3AEncryptedKey%3E%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2F%40wsse%3AUsage%0A%0AThis%20optional%20attribute%20is%20used%20to%20type%20the%20usage%20of%20the%20%3Cwsse%3ASecurityTokenReference%3E.%20%20Usages%20are%20specified%20using%20URIs%20and%20multiple%20usages%20MAY%20be%20specified%20using%20XML%20list%20semantics.%20%20No%20usages%20are%20defined%20by%20this%20specification.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2F%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20different%20(extensible)%20types%20of%20security%20references%2C%20based%20on%20a%20schema%2C%20to%20be%20passed.%20Unrecognized%20elements%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added%20to%20the%20header.%20Unrecognized%20attributes%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0AAll%20compliant%20implementations%20MUST%20be%20able%20to%20process%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element.%0A%0A%20%0A%0AThis%20element%20can%20also%20be%20used%20as%20a%20direct%20child%20element%20of%20%3Cds%3AKeyInfo%3E%20to%20indicate%20a%20hint%20to%20retrieve%20the%20key%20information%20from%20a%20security%20token%20placed%20somewhere%20else.%20%20In%20particular%2C%20it%20is%20RECOMMENDED%2C%20when%20using%20XML%20Signature%20and%20XML%20Encryption%2C%20that%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element%20be%20placed%20inside%20a%20%3Cds%3AKeyInfo%3E%20to%20reference%20the%20security%20token%20used%20for%20the%20signature%20or%20encryption.%0A%0A%20%0A%0AThere%20are%20several%20challenges%20that%20implementations%20face%20when%20trying%20to%20interoperate.%20Processing%20the%20IDs%20and%20references%20requires%20the%20recipient%20to%20understand%20the%20schema.%20%20This%20may%20be%20an%20expensive%20task%20and%20in%20the%20general%20case%20impossible%20as%20there%20is%20no%20way%20to%20know%20the%20%22schema%20location%22%20for%20a%20specific%20namespace%20URI.%20%20As%20well%2C%20the%20primary%20goal%20of%20a%20reference%20is%20to%20uniquely%20identify%20the%20desired%20token.%20%20ID%20references%20are%2C%20by%20definition%2C%20unique%20by%20XML.%20%20However%2C%20other%20mechanisms%20such%20as%20%22principal%20name%22%20are%20not%20required%20to%20be%20unique%20and%20therefore%20such%20references%20may%20be%20not%20unique.%0A%0A%20%0A%0AThis%20specification%20allows%20for%20the%20use%20of%20multiple%20reference%20mechanisms%20within%20a%20single%20%3Cwsse%3ASecurityTokenReference%3E.%20When%20multiple%20references%20are%20present%20in%20a%20given%20%3Cwsse%3ASecurityTokenReference%3E%2C%20they%20MUST%20%20%20resolve%20to%20a%20single%20token%20in%20common.%20Specific%20token%20profiles%20SHOULD%20define%20the%20reference%20mechanisms%20to%20be%20used.%0A%0A%20%0A%0AThe%20following%20list%20provides%20a%20list%20of%20the%20specific%20reference%20mechanisms%20defined%20in%20WSS%3A%20SOAP%20Message%20Security%20in%20preferred%20order%20(i.e.%2C%20most%20specific%20to%20least%20specific)%3A%0A%0A%20%0A%0A%20%20%20%20Direct%20References%20%E2%80%93%20This%20allows%20references%20to%20included%20tokens%20using%20URI%20fragments%20and%20external%20tokens%20using%20full%20URIs.%0A%20%20%20%20Key%20Identifiers%20%E2%80%93%20This%20allows%20tokens%20to%20be%20referenced%20using%20an%20opaque%20value%20that%20represents%20the%20token%20(defined%20by%20token%20type%2Fprofile).%0A%20%20%20%20Key%20Names%20%E2%80%93%20This%20allows%20tokens%20to%20be%20referenced%20using%20a%20string%20that%20matches%20an%20identity%20assertion%20within%20the%20security%20token.%20%20This%20is%20a%20subset%20match%20and%20may%20result%20in%20multiple%20security%20tokens%20that%20match%20the%20specified%20name.%0A%20%20%20%20Embedded%20References%20-%20%20%20This%20allows%20tokens%20to%20be%20embedded%20(as%20opposed%20to%20a%20pointer%20to%20a%20token%20that%20resides%20elsewhere).%0A%0A7.2%20Direct%20References%0A%0AThe%20%3Cwsse%3AReference%3E%20element%20provides%20an%20extensible%20mechanism%20for%20directly%20referencing%20security%20tokens%20using%20URIs.%0A%0A%20%0A%0AThe%20following%20illustrates%20the%20syntax%20of%20this%20element%3A%0A%0A%20%0A%0A%3Cwsse%3ASecurityTokenReference%20wsu%3AId%3D%22...%22%3E%0A%0A%20%20%20%20%3Cwsse%3AReference%20URI%3D%22...%22%20ValueType%3D%22...%22%2F%3E%0A%0A%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A%20%0A%0AThe%20following%20describes%20the%20elements%20defined%20above%3A%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AReference%0A%0AThis%20element%20is%20used%20to%20identify%20an%20abstract%20URI%20location%20for%20locating%20a%20security%20token.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AReference%2F%40URI%0A%0AThis%20optional%20attribute%20specifies%20an%20abstract%20URI%20for%20a%20security%20token.%20If%20a%20fragment%20is%20specified%2C%20then%20it%20indicates%20the%20local%20ID%20of%20the%20security%20token%20being%20referenced.%20The%20URI%20MUST%20identify%20a%20security%20token.%20%20The%20URI%20MUST%20NOT%20identify%20a%20%20%3Cwsse%3ASecurityTokenReference%3E%20element%2C%20a%20%3Cwsse%3AEmbedded%3E%20element%2C%20a%20%3Cwsse%3AReference%3E%20element%2C%20or%20a%20%3Cwsse%3AKeyIdentifier%3E%20element.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AReference%2F%40ValueType%0A%0AThis%20optional%20attribute%20specifies%20a%20URI%20that%20is%20used%20to%20identify%20the%20type%20of%20token%20being%20referenced.%20%20This%20specification%20does%20not%20define%20any%20processing%20rules%20around%20the%20usage%20of%20this%20attribute%2C%20however%2C%20specifications%20for%20individual%20token%20types%20MAY%20define%20specific%20processing%20rules%20and%20semantics%20around%20the%20value%20of%20the%20URI%20and%20its%20interpretation.%20If%20this%20attribute%20is%20not%20present%2C%20the%20URI%20MUST%20be%20processed%20as%20a%20normal%20URI.%0A%0A%20%0A%0AIn%20this%20version%20of%20the%20specification%20the%20use%20of%20this%20attribute%20to%20identify%20the%20type%20of%20the%20referenced%20security%20token%20is%20deprecated.%20Profiles%20which%20require%20or%20recommend%20the%20use%20of%20this%20attribute%20to%20identify%20the%20type%20of%20the%20referenced%20security%20token%20SHOULD%20evolve%20to%20require%20or%20recommend%20the%20use%20of%20the%20wsse%3ASecurityTokenReference%2F%40wsse11%3ATokenType%20attribute%20to%20identify%20the%20type%20of%20the%20referenced%20token.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AReference%2F%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20different%20(extensible)%20types%20of%20security%20references%2C%20based%20on%20a%20schema%2C%20to%20be%20passed.%20Unrecognized%20elements%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AReference%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added%20to%20the%20header.%20Unrecognized%20attributes%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0AThe%20following%20illustrates%20the%20use%20of%20this%20element%3A%0A%0A%20%0A%0A%3Cwsse%3ASecurityTokenReference%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20xmlns%3Awsse%3D%22...%22%3E%0A%0A%20%20%20%3Cwsse%3AReference%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20URI%3D%22http%3A%2F%2Fwww.fabrikam123.com%2Ftokens%2FZoe%22%2F%3E%0A%0A%3C%2Fwsse%3ASecurityTokenReference%3E%0A7.3%20Key%20Identifiers%0A%0AAlternatively%2C%20if%20a%20direct%20reference%20is%20not%20used%2C%20then%20it%20is%20RECOMMENDED%20that%20a%20key%20identifier%20be%20used%20to%20specify%2Freference%20a%20security%20token%20instead%20of%20a%20%3Cds%3AKeyName%3E.%20%20A%20%3Cwsse%3AKeyIdentifier%3E%20is%20a%20value%20that%20can%20be%20used%20to%20uniquely%20identify%20a%20security%20token%20(e.g.%20a%20hash%20of%20the%20important%20elements%20of%20the%20security%20token).%20%20The%20exact%20value%20type%20and%20generation%20algorithm%20varies%20by%20security%20token%20type%20(and%20sometimes%20by%20the%20data%20within%20the%20token)%2C%20Consequently%2C%20the%20values%20and%20algorithms%20are%20described%20in%20the%20token-specific%20profiles%20rather%20than%20this%20specification.%0A%0A%20%0A%0AThe%20%3Cwsse%3AKeyIdentifier%3E%20element%20SHALL%20be%20placed%20in%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element%20to%20reference%20a%20token%20using%20an%20identifier.%20%20This%20element%20SHOULD%20be%20used%20for%20all%20key%20identifiers.%0A%0A%20%0A%0AThe%20processing%20model%20assumes%20that%20the%20key%20identifier%20for%20a%20security%20token%20is%20constant.%20%20Consequently%2C%20processing%20a%20key%20identifier%20involves%20simply%20looking%20for%20a%20security%20token%20whose%20key%20identifier%20matches%20the%20specified%20constant.%20The%20%3Cwsse%3AKeyIdentifier%3E%20element%20is%20only%20allowed%20inside%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element%0A%0AThe%20following%20is%20an%20overview%20of%20the%20syntax%3A%0A%0A%20%0A%0A%3Cwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%3Cwsse%3AKeyIdentifier%20wsu%3AId%3D%22...%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ValueType%3D%22...%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20EncodingType%3D%22...%22%3E%0A%0A%20%20%20%20%20%20...%0A%0A%20%20%20%3C%2Fwsse%3AKeyIdentifier%3E%0A%0A%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A%20%0A%0AThe%20following%20describes%20the%20attributes%20and%20elements%20listed%20in%20the%20example%20above%3A%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AKeyIdentifier%0A%0AThis%20element%20is%20used%20to%20include%20a%20binary-encoded%20key%20identifier.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AKeyIdentifier%2F%40wsu%3AId%0A%0AAn%20optional%20string%20label%20for%20this%20identifier.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AKeyIdentifier%2F%40ValueType%0A%0AThe%20optional%20ValueType%20attribute%20is%20used%20to%20indicate%20the%20type%20of%20KeyIdentifier%20being%20used.%20This%20specification%20defines%20one%20ValueType%20that%20can%20be%20applied%20to%20all%20token%20types.%20Each%20specific%20token%20profile%20specifies%20the%20KeyIdentifier%20types%20that%20may%20be%20used%20to%20refer%20to%20tokens%20of%20that%20type.%20It%20also%20specifies%20the%20critical%20semantics%20of%20the%20identifier%2C%20such%20as%20whether%20the%20KeyIdentifier%20is%20unique%20to%20the%20key%20or%20the%20token.%20If%20no%20value%20is%20specified%20then%20the%20key%20identifier%20will%20be%20interpreted%20in%20an%20application-specific%20manner.%20This%20URI%20fragment%20is%20relative%20to%20a%20base%20URI%20%20as%20ndicated%20in%20the%20table%20below.%0A%0A%20%0A%0AURI%0A%09%0A%0ADescription%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Foasis-wss-soap-message-security-1.1%23ThumbprintSHA1%0A%09%0A%0AIf%20the%20security%20token%20type%20that%20the%20Security%20Token%20Reference%20refers%20to%20already%20contains%20a%20representation%20for%20the%20thumbprint%2C%20the%20value%20obtained%20from%20the%20token%20MAY%20be%20used.%20If%20the%20token%20does%20not%20contain%20a%20representation%20of%20a%20thumbprint%2C%20then%20the%20value%20of%20the%20KeyIdentifier%20MUST%20be%20the%20SHA1%20of%20the%20raw%20octets%20which%20would%20be%20encoded%20within%20the%20security%20token%20element%20were%20it%20to%20be%20included.%20A%20thumbprint%20reference%20MUST%20occur%20in%20combination%20with%20a%20required%20to%20be%20supported%20(by%20the%20applicable%20profile)%20reference%20form%20unless%20a%20thumbprint%20reference%20is%20among%20the%20reference%20forms%20required%20to%20be%20supported%20by%20the%20applicable%20profile%2C%20or%20the%20parties%20to%20the%20communication%20have%20agreed%20to%20accept%20thumbprint%20only%20references.%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Foasis-wss-soap-message-security-1.1%23EncryptedKeySHA1%0A%09%0A%0AIf%20the%20security%20token%20type%20that%20the%20Security%20Token%20Reference%20refers%20to%20already%20contains%20a%20representation%20for%20the%20EncryptedKey%2C%20the%20value%20obtained%20from%20the%20token%20MAY%20be%20used.%20If%20the%20token%20does%20not%20contain%20a%20representation%20of%20a%20EncryptedKey%2C%20then%20the%20value%20of%20the%20KeyIdentifier%20MUST%20be%20the%20SHA1%20of%20the%20raw%20octets%20which%20would%20be%20encoded%20within%20the%20security%20token%20element%20were%20it%20to%20be%20included.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AKeyIdentifier%2F%40EncodingType%0A%0AThe%20optional%20EncodingType%20attribute%20is%20used%20to%20indicate%2C%20using%20a%20URI%2C%20the%20encoding%20format%20of%20the%20KeyIdentifier%20(%23Base64Binary).%20This%20specification%20defines%20the%20EncodingType%20URI%20values%20appearing%20in%20the%20following%20table.%20A%20token%20specific%20profile%20MAY%20define%20additional%20token%20specific%20EncodingType%20URI%20values.%20A%20KeyIdentifier%20MUST%20include%20an%20EncodingType%20attribute%20when%20its%20ValueType%20is%20not%20sufficient%20to%20identify%20its%20encoding%20type.%20The%20base%20values%20defined%20in%20this%20specification%20are%3A%0A%0A%20%0A%0AURI%0A%09%0A%0ADescription%0A%0A%23Base64Binary%0A%09%0A%0AXML%20Schema%20base%2064%20encoding%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AKeyIdentifier%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added.%0A7.4%20Embedded%20References%0A%0AIn%20some%20cases%20a%20reference%20may%20be%20to%20an%20embedded%20token%20(as%20opposed%20to%20a%20pointer%20to%20a%20token%20that%20resides%20elsewhere).%20%20To%20do%20this%2C%20the%20%3Cwsse%3AEmbedded%3E%20element%20is%20specified%20within%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element.%20The%20%3Cwsse%3AEmbedded%3E%20element%20is%20only%20allowed%20inside%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element.%0A%0AThe%20following%20is%20an%20overview%20of%20the%20syntax%3A%0A%0A%20%0A%0A%3Cwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%3Cwsse%3AEmbedded%20wsu%3AId%3D%22...%22%3E%0A%0A%20%20%20%20%20%20...%0A%0A%20%20%20%3C%2Fwsse%3AEmbedded%3E%0A%0A%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A%20%0A%0AThe%20following%20describes%20the%20attributes%20and%20elements%20listed%20in%20the%20example%20above%3A%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AEmbedded%0A%0AThis%20element%20is%20used%20to%20embed%20a%20token%20directly%20within%20a%20reference%20(that%20is%2C%20to%20create%20a%20local%20or%20literal%20reference).%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AEmbedded%2F%40wsu%3AId%0A%0AAn%20optional%20string%20label%20for%20this%20element.%20This%20allows%20this%20embedded%20token%20to%20be%20referenced%20by%20a%20signature%20or%20encryption.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AEmbedded%2F%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20any%20security%20token%2C%20based%20on%20schemas%2C%20to%20be%20embedded.%20Unrecognized%20elements%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0A%2Fwsse%3ASecurityTokenReference%2Fwsse%3AEmbedded%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added.%20Unrecognized%20attributes%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0AThe%20following%20example%20illustrates%20embedding%20a%20SAML%20assertion%3A%0A%0A%20%0A%0A%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%20xmlns%3Awsu%3D%22...%22%3E%0A%0A%20%20%20%20%3CS11%3AHeader%3E%0A%0A%20%20%20%20%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3AEmbedded%20wsu%3AId%3D%22tok1%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Csaml%3AAssertion%20xmlns%3Asaml%3D%22...%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fsaml%3AAssertion%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3AEmbedded%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A%20%20%20%20%3C%2FS11%3AHeader%3E%0A%0A%20%20%20%20...%0A%0A%3C%2FS11%3AEnvelope%3E%0A7.5%20ds%3AKeyInfo%0A%0AThe%20%3Cds%3AKeyInfo%3E%20element%20(from%20XML%20Signature)%20can%20be%20used%20for%20carrying%20the%20key%20information%20and%20is%20allowed%20for%20different%20key%20types%20and%20for%20future%20extensibility.%20%20However%2C%20in%20this%20specification%2C%20the%20use%20of%20%3Cwsse%3ABinarySecurityToken%3E%20is%20the%20RECOMMENDED%20mechanism%20to%20carry%20key%20material%20if%20the%20key%20type%20contains%20binary%20data.%20Please%20refer%20to%20the%20specific%20profile%20documents%20for%20the%20appropriate%20way%20to%20carry%20key%20material.%0A%0A%20%0A%0AThe%20following%20example%20illustrates%20use%20of%20this%20element%20to%20fetch%20a%20named%20key%3A%0A%0A%20%0A%0A%3Cds%3AKeyInfo%20Id%3D%22...%22%20xmlns%3Ads%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23%22%3E%0A%0A%20%20%20%20%3Cds%3AKeyName%3ECN%3DHiroshi%20Maruyama%2C%20C%3DJP%3C%2Fds%3AKeyName%3E%0A%0A%3C%2Fds%3AKeyInfo%3E%0A7.6%20Key%20Names%0A%0AIt%20is%20strongly%20RECOMMENDED%20to%20use%20%3Cwsse%3AKeyIdentifier%3E%20elements.%20However%2C%20if%20key%20names%20are%20used%2C%20then%20it%20is%20strongly%20RECOMMENDED%20that%20%3Cds%3AKeyName%3E%20elements%20conform%20to%20the%20attribute%20names%20in%20section%202.3%20of%20RFC%202253%20(this%20is%20recommended%20by%20XML%20Signature%20for%20%3Cds%3AX509SubjectName%3E)%20for%20interoperability.%20%0A%0A%20%0A%0AAdditionally%2C%20e-mail%20addresses%2C%20SHOULD%20conform%20to%20RFC%20822%3A%0A%0A%20%20%20%20%20EmailAddress%3Dckaler%40microsoft.com%0A7.7%20Encrypted%20Key%20reference%0A%0AIn%20certain%20cases%2C%20an%20%3Cxenc%3AEncryptedKey%3E%20element%20MAY%20be%20used%20to%20carry%20key%20material%20encrypted%20for%20the%20recipient%E2%80%99s%20key.%20This%20key%20material%20is%20henceforth%20referred%20to%20as%20EncryptedKey.%0A%0A%20%0A%0AThe%20EncryptedKey%20MAY%20be%20used%20to%20perform%20other%20cryptographic%20operations%20within%20the%20same%20message%2C%20such%20as%20signatures.%20The%20EncryptedKey%20MAY%20also%20be%20used%20for%20performing%20cryptographic%20operations%20in%20subsequent%20messages%20exchanged%20by%20the%20two%20parties.%20Two%20mechanisms%20are%20defined%20for%20referencing%20the%20EncryptedKey.%0A%0A%20%0A%0AWhen%20referencing%20the%20EncryptedKey%20within%20the%20same%20message%20that%20contains%20the%20%3Cxenc%3AEncryptedKey%3E%20element%2C%20the%20%3Cds%3AKeyInfo%3E%20element%20of%20the%20referencing%20construct%20MUST%20contain%20a%20%20%3Cwsse%3ASecurityTokenReference%3E.%20The%20%3Cwsse%3ASecurityTokenReference%3E%20element%20MUST%20contain%20a%20%3Cwsse%3AReference%3E%20element.%0A%0A%20%0A%0AThe%20URI%20attribute%20value%20of%20the%20%3Cwsse%3AReference%3E%20element%20MUST%20be%20set%20to%20the%20value%20of%20the%20ID%20attribute%20of%20the%20referenced%20%3Cxenc%3AEncryptedKey%3E%20element%20that%20contains%20the%20EncryptedKey.%0A%0AWhen%20referencing%20the%20EncryptedKey%20in%20a%20message%20that%20does%20not%20contain%20the%20%3Cxenc%3AEncryptedKey%3E%20element%2C%20the%20%3Cds%3AKeyInfo%3E%20element%20of%20the%20referencing%20construct%20MUST%20contain%20a%20%20%3Cwsse%3ASecurityTokenReference%3E.%20The%20%3Cwsse%3ASecurityTokenReference%3E%20element%20MUST%20contain%20a%20%3Cwsse%3AKeyIdentifier%3E%20element.%20The%20EncodingType%20attribute%20SHOULD%20be%20set%20to%20%23Base64Binary.%20Other%20encoding%20types%20MAY%20be%20specified%20if%20agreed%20on%20by%20all%20parties.%20The%20wsse11%3ATokenType%20attribute%20MUST%20be%20set%20to%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Foasis-wss-soap-message-security-1.1%23EncryptedKey.The%20identifier%20for%20a%20%3Cxenc%3AEncryptedKey%3E%20token%20is%20defined%20as%20the%20SHA1%20of%20the%20raw%20(pre-base64%20encoding)%20octets%20specified%20in%20the%20%3Cxenc%3ACipherValue%3E%20element%20of%20the%20referenced%20%3Cxenc%3AEncryptedKey%3E%20token.%20This%20value%20is%20encoded%20as%20indicated%20in%20the%20%3Cwsse%3AKeyIdentifier%3E%20reference.%20The%20%3Cwsse%3AValueType%3E%20attribute%20of%20%3Cwsse%3AKeyIdentifier%3E%20%20MUST%20%20be%20set%20to%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2Foasis-wss-soap-message-security-1.1%23EncryptedKeySHA1.%0A8%20%20%20%20%20%20Signatures%0A%0AMessage%20producers%20may%20want%20to%20enable%20message%20recipients%20to%20determine%20whether%20a%20message%20was%20altered%20in%20transit%20and%20to%20verify%20that%20the%20claims%20in%20a%20particular%20security%20token%20apply%20to%20the%20producer%20of%20the%20message.%0A%0A%20%0A%0ADemonstrating%20knowledge%20of%20a%20confirmation%20key%20associated%20with%20a%20token%20key-claim%20confirms%20the%20accompanying%20token%20claims.%20%20Knowledge%20of%20a%20confirmation%20key%20may%20be%20demonstrated%20by%20using%20that%20key%20to%20create%20an%20XML%20Signature%2C%20for%20example.%20The%20relying%20party%E2%80%99s%20acceptance%20of%20the%20claims%20may%20depend%20on%20its%20confidence%20in%20the%20token.%20%20Multiple%20tokens%20may%20contain%20a%20key-claim%20for%20a%20signature%20and%20may%20be%20referenced%20from%20the%20signature%20using%20a%20%3Cwsse%3ASecurityTokenReference%3E.%20%20A%20key-claim%20may%20be%20an%20X.509%20Certificate%20token%2C%20or%20a%20Kerberos%20service%20ticket%20token%20to%20give%20two%20examples.%0A%0A%20%0A%0ABecause%20of%20the%20mutability%20of%20some%20SOAP%20headers%2C%20producers%20SHOULD%20NOT%20use%20the%20Enveloped%20Signature%20Transform%20defined%20in%20XML%20Signature.%20%20Instead%2C%20messages%20SHOULD%20explicitly%20include%20the%20elements%20to%20be%20signed.%20%20Similarly%2C%20producers%20SHOULD%20NOT%20use%20the%20Enveloping%20Signature%20defined%20in%20XML%20Signature%20%5BXMLSIG%5D.%0A%0A%20%0A%0AThis%20specification%20allows%20for%20multiple%20signatures%20and%20signature%20formats%20to%20be%20attached%20to%20a%20message%2C%20each%20referencing%20different%2C%20even%20overlapping%2C%20parts%20of%20the%20message.%20%20This%20is%20important%20for%20many%20distributed%20applications%20where%20messages%20flow%20through%20multiple%20processing%20stages.%20%20For%20example%2C%20a%20producer%20may%20submit%20an%20order%20that%20contains%20an%20orderID%20header.%20%20The%20producer%20signs%20the%20orderID%20header%20and%20the%20body%20of%20the%20request%20(the%20contents%20of%20the%20order).%20%20When%20this%20is%20received%20by%20the%20order%20processing%20sub-system%2C%20it%20may%20insert%20a%20shippingID%20into%20the%20header.%20%20The%20order%20sub-system%20would%20then%20sign%2C%20at%20a%20minimum%2C%20the%20orderID%20and%20the%20shippingID%2C%20and%20possibly%20the%20body%20as%20well.%20%20Then%20when%20this%20order%20is%20processed%20and%20shipped%20by%20the%20shipping%20department%2C%20a%20shippedInfo%20header%20might%20be%20appended.%20%20The%20shipping%20department%20would%20sign%2C%20at%20a%20minimum%2C%20the%20shippedInfo%20and%20the%20shippingID%20and%20possibly%20the%20body%20and%20forward%20the%20message%20to%20the%20billing%20department%20for%20processing.%20%20The%20billing%20department%20can%20verify%20the%20signatures%20and%20determine%20a%20valid%20chain%20of%20trust%20for%20the%20order%2C%20as%20well%20as%20who%20authorized%20each%20step%20in%20the%20process.%0A%0A%20%0A%0AAll%20compliant%20implementations%20MUST%20be%20able%20to%20support%20the%20XML%20Signature%20standard.%0A8.1%20Algorithms%0A%0AThis%20specification%20builds%20on%20XML%20Signature%20and%20therefore%20has%20the%20same%20algorithm%20requirements%20as%20those%20specified%20in%20the%20XML%20Signature%20specification.%20%0A%0AThe%20following%20table%20outlines%20additional%20algorithms%20that%20are%20strongly%20RECOMMENDED%20by%20this%20specification%3A%0A%0A%20%0A%0AAlgorithm%20Type%0A%09%0A%0AAlgorithm%0A%09%0A%0AAlgorithm%20URI%0A%0ACanonicalization%0A%09%0A%0AExclusive%20XML%20Canonicalization%0A%09%0A%0Ahttp%3A%2F%2Fwww.w3.org%2F2001%2F10%2Fxml-exc-c14n%23%0A%0A%20%0A%0AAs%20well%2C%20the%20following%20table%20outlines%20additional%20algorithms%20that%20MAY%20be%20used%3A%0A%0A%20%0A%0AAlgorithm%20Type%0A%09%0A%0AAlgorithm%0A%09%0A%0AAlgorithm%20URI%0A%0ATransform%0A%09%0A%0ASOAP%20Message%20Normalization%0A%09%0A%0Ahttp%3A%2F%2Fwww.w3.org%2FTR%2Fsoap12-n11n%2F%0A%0A%20%0A%0AThe%20Exclusive%20XML%20Canonicalization%20algorithm%20addresses%20the%20pitfalls%20of%20general%20canonicalization%20that%20can%20occur%20from%20leaky%20namespaces%20with%20pre-existing%20signatures.%0A%0A%20%0A%0AFinally%2C%20if%20a%20producer%20wishes%20to%20sign%20a%20message%20before%20encryption%2C%20then%20following%20the%20ordering%20rules%20laid%20out%20in%20section%205%2C%20%22Security%20Header%22%2C%20they%20SHOULD%20first%20prepend%20the%20signature%20element%20to%20the%20%20%3Cwsse%3ASecurity%3E%20header%2C%20and%20then%20prepend%20the%20encryption%20element%2C%20resulting%20in%20a%20%3Cwsse%3ASecurity%3E%20header%20that%20has%20the%20encryption%20element%20first%2C%20followed%20by%20the%20signature%20element%3A%0A%0A%20%0A%0A%3Cwsse%3ASecurity%3E%20header%0A%0A%5Bencryption%20element%5D%0A%0A%5Bsignature%20element%5D%0A%0A.%0A%0A.%0A%0A%20%0A%0ALikewise%2C%20if%20a%20producer%20wishes%20to%20sign%20a%20message%20after%20encryption%2C%20they%20SHOULD%20first%20prepend%20the%20encryption%20element%20to%20the%20%3Cwsse%3ASecurity%3E%20%20header%2C%20and%20then%20prepend%20the%20signature%20element.%20%20This%20will%20result%20in%20a%20%3Cwsse%3ASecurity%3E%20header%20that%20has%20the%20signature%20element%20first%2C%20followed%20by%20the%20encryption%20element%3A%0A%0A%20%0A%0A%3Cwsse%3ASecurity%3E%20header%0A%0A%5Bsignature%20element%5D%0A%0A%5Bencryption%20element%5D%0A%0A.%0A%0A.%0A%0A%20%0A%0AThe%20XML%20Digital%20Signature%20WG%20has%20defined%20two%20canonicalization%20algorithms%3A%20XML%20Canonicalization%20%20and%20Exclusive%20XML%20Canonicalization.%20To%20prevent%20confusion%2C%20the%20first%20is%20also%20called%20Inclusive%20Canonicalization.%20Neither%20one%20solves%20all%20possible%20problems%20that%20can%20arise.%20The%20following%20informal%20discussion%20is%20intended%20to%20provide%20guidance%20on%20the%20choice%20of%20which%20one%20to%20use%0A%0Ain%20particular%20circumstances.%20For%20a%20more%20detailed%20and%20technically%20precise%20discussion%20of%20these%20issues%20see%3A%20%5BXML-C14N%5D%20and%20%5BEXCC14N%5D.%0A%0A%20%0A%0AThere%20are%20two%20problems%20to%20be%20avoided.%20On%20the%20one%20hand%2C%20XML%20allows%20documents%20to%20be%20changed%20in%20various%20ways%20and%20still%20be%20considered%20equivalent.%20For%20example%2C%20duplicate%20namespace%20declarations%20can%20be%20removed%20or%20created.%20As%20a%20result%2C%20XML%20tools%20make%20these%20kinds%20of%20changes%20freely%20when%20processing%20XML.%20Therefore%2C%20it%20is%20vital%20that%20these%20equivalent%20forms%20match%20the%20same%20signature.%0A%0A%20%0A%0AOn%20the%20other%20hand%2C%20if%20the%20signature%20simply%20covers%20something%20like%20xx%3Afoo%2C%20its%20meaning%20may%20change%20if%20xx%20is%20redefined.%20In%20this%20case%20the%20signature%20does%20not%20prevent%20tampering.%20It%20might%20be%20thought%20that%20the%20problem%20could%20be%20solved%20by%20expanding%20all%20the%20values%20in%20line.%20Unfortunately%2C%20there%20are%20mechanisms%20like%20XPATH%20which%20consider%20xx%3D%22http%3A%2F%2Fexample.com%2F%22%3B%20to%20be%20different%20from%20yy%3D%22http%3A%2F%2Fexample.com%2F%22%3B%20even%20though%20both%20xx%20and%20yy%20are%20bound%20to%20the%20same%20namespace.%0A%0AThe%20fundamental%20difference%20between%20the%20Inclusive%20and%20Exclusive%20Canonicalization%20is%20the%20namespace%20declarations%20which%20are%20placed%20in%20the%20output.%20Inclusive%20Canonicalization%20copies%20all%20the%20declarations%20that%20are%20currently%20in%20force%2C%20even%20if%20they%20are%20defined%20outside%20of%20the%20scope%20of%20the%20signature.%20It%20also%20copies%20any%20xml%3A%20attributes%20that%20are%20in%20force%2C%20such%20as%20xml%3Alang%20or%20xml%3Abase.%20This%20guarantees%20that%20all%20the%20declarations%20you%20might%20make%20use%20of%20will%20be%20unambiguously%20specified.%20The%20problem%20with%20this%20is%20that%20if%20the%20signed%20XML%20is%20moved%20into%20another%20XML%20document%20which%20has%20other%20declarations%2C%20the%20Inclusive%20Canonicalization%20will%20copy%20then%20and%20the%20signature%20will%20be%20invalid.%20This%20can%20even%20happen%20if%20you%20simply%20add%20an%20attribute%20in%20a%20different%20namespace%20to%20the%20surrounding%20context.%0A%0A%20%0A%0AExclusive%20Canonicalization%20tries%20to%20figure%20out%20what%20namespaces%20you%20are%20actually%20using%20and%20just%20copies%20those.%20Specifically%2C%20it%20copies%20the%20ones%20that%20are%20%22visibly%20used%22%2C%20which%20means%20the%20ones%20that%20are%20a%20part%20of%20the%20XML%20syntax.%20However%2C%20it%20does%20not%20look%20into%20attribute%20values%20or%20element%20content%2C%20so%20the%20namespace%20declarations%20required%20to%20process%20these%20are%20not%20copied.%20For%20example%0A%0Aif%20you%20had%20an%20attribute%20like%20xx%3Afoo%3D%22yy%3Abar%22%20it%20would%20copy%20the%20declaration%20for%20xx%2C%20but%20not%20yy.%20(This%20can%20even%20happen%20without%20your%20knowledge%20because%20XML%20processing%20tools%20might%20add%20xsi%3Atype%20if%20you%20use%20a%20schema%20subtype.)%20It%20also%20does%20not%20copy%20the%20xml%3A%20attributes%20that%20are%20declared%20outside%20the%20scope%20of%20the%20signature.%0A%0A%20%0A%0AExclusive%20Canonicalization%20allows%20you%20to%20create%20a%20list%20of%20the%20namespaces%20that%20must%20be%20declared%2C%20so%20that%20it%20will%20pick%20up%20the%20declarations%20for%20the%20ones%20that%20are%20not%20visibly%20used.%20The%20only%20problem%20is%20that%20the%20software%20doing%20the%20signing%20must%20know%20what%20they%20are.%20In%20a%20typical%20SOAP%20software%20environment%2C%20the%20security%20code%20will%20typically%20be%20unaware%20of%20all%20the%20namespaces%20being%20used%20by%20the%20application%20in%20the%20message%20body%20that%20it%20is%20signing.%0A%0A%20%0A%0AExclusive%20Canonicalization%20is%20useful%20when%20you%20have%20a%20signed%20XML%20document%20that%20you%20wish%20to%20insert%20into%20other%20XML%20documents.%20A%20good%20example%20is%20a%20signed%20SAML%20assertion%20which%20might%20be%20inserted%20as%20a%20XML%20Token%20in%20the%20security%20header%20of%20various%20SOAP%20messages.%20The%20Issuer%20who%20signs%20the%20assertion%20will%20be%20aware%20of%20the%20namespaces%20being%20used%20and%20able%20to%20construct%20the%20list.%20The%20use%20of%20Exclusive%20Canonicalization%20will%20insure%20the%20signature%20verifies%20correctly%20every%20time.%0A%0AInclusive%20Canonicalization%20is%20useful%20in%20the%20typical%20case%20of%20signing%20part%20or%20all%20of%20the%20SOAP%20body%20in%20accordance%20with%20this%20specification.%20This%20will%20insure%20all%20the%20declarations%20fall%20under%20the%20signature%2C%20even%20though%20the%20code%20is%20unaware%20of%20what%20namespaces%20are%20being%20used.%20At%20the%20same%20time%2C%20it%20is%20less%20likely%20that%20the%20signed%20data%20(and%20signature%20element)%20will%20be%20inserted%20in%20some%20other%20XML%20document.%20Even%20if%20this%20is%20desired%2C%20it%20still%20may%20not%20be%20feasible%20for%20other%20reasons%2C%20for%20example%20there%20may%20be%20Id%27s%20with%20the%20same%20value%20defined%20in%20both%20XML%20documents.%0A%0A%20%0A%0AIn%20other%20situations%20it%20will%20be%20necessary%20to%20study%20the%20requirements%20of%20the%20application%20and%20the%20detailed%20operation%20of%20the%20canonicalization%20methods%20to%20determine%20which%20is%20appropriate.%0A%0AThis%20section%20is%20non-normative.%0A8.2%20Signing%20Messages%0A%0AThe%20%3Cwsse%3ASecurity%3E%20header%20block%20MAY%20be%20used%20to%20carry%20a%20signature%20compliant%20with%20the%20XML%20Signature%20specification%20within%20a%20SOAP%20Envelope%20for%20the%20purpose%20of%20signing%20one%20or%20more%20elements%20in%20the%20SOAP%20Envelope.%20Multiple%20signature%20entries%20MAY%20be%20added%20into%20a%20single%20SOAP%20Envelope%20within%20one%20%3Cwsse%3ASecurity%3E%20header%20block.%20%20Producers%20SHOULD%20sign%20all%20important%20elements%20of%20the%20message%2C%20and%20careful%20thought%20must%20be%20given%20to%20creating%20a%20signing%20policy%20that%20requires%20signing%20of%20parts%20of%20the%20message%20that%20might%20legitimately%20be%20altered%20in%20transit.%0A%0A%20%0A%0ASOAP%20applications%20MUST%20satisfy%20the%20following%20conditions%3A%0A%0A%20%0A%0A%20%20%20%20A%20compliant%20implementation%20MUST%20be%20capable%20of%20processing%20the%20required%20elements%20defined%20in%20the%20XML%20Signature%20specification.%0A%20%20%20%20To%20add%20a%20signature%20to%20a%20%3Cwsse%3ASecurity%3E%20header%20block%2C%20a%20%3Cds%3ASignature%3E%20element%20conforming%20to%20the%20XML%20Signature%20specification%20MUST%20be%20prepended%20to%20the%20existing%20content%20of%20the%20%3Cwsse%3ASecurity%3E%20header%20block%2C%20in%20order%20to%20indicate%20to%20the%20receiver%20the%20correct%20order%20of%20operations.%20All%20the%20%3Cds%3AReference%3E%20elements%20contained%20in%20the%20signature%20SHOULD%20refer%20to%20a%20resource%20within%20the%20enclosing%20SOAP%20envelope%20as%20described%20in%20the%20XML%20Signature%20specification.%20However%2C%20since%20the%20SOAP%20message%20exchange%20model%20allows%20intermediate%20applications%20to%20modify%20the%20Envelope%20(add%20or%20delete%20a%20header%20block%3B%20for%20example)%2C%20XPath%20filtering%20does%20not%20always%20result%20in%20the%20same%20objects%20after%20message%20delivery.%20Care%20should%20be%20taken%20in%20using%20XPath%20filtering%20so%20that%20there%20is%20no%20unintentional%20validation%20failure%20due%20to%20such%20modifications.%0A%20%20%20%20The%20problem%20of%20modification%20by%20intermediaries%20(especially%20active%20ones)%20is%20applicable%20to%20more%20than%20just%20XPath%20processing.%20%20Digital%20signatures%2C%20because%20of%20canonicalization%20and%20digests%2C%20present%20particularly%20fragile%20examples%20of%20such%20relationships.%20If%20overall%20message%20processing%20is%20to%20remain%20robust%2C%20intermediaries%20must%20exercise%20care%20that%20the%20transformation%20algorithms%20used%20do%20not%20affect%20the%20validity%20of%20a%20digitally%20signed%20component.%0A%20%20%20%20Due%20to%20security%20concerns%20with%20namespaces%2C%20this%20specification%20strongly%20RECOMMENDS%20the%20use%20of%20the%20%22Exclusive%20XML%20Canonicalization%22%20algorithm%20or%20another%20canonicalization%20algorithm%20that%20provides%20equivalent%20or%20greater%20protection.%0A%20%20%20%20For%20processing%20efficiency%20it%20is%20RECOMMENDED%20to%20have%20the%20signature%20added%20and%20then%20the%20security%20token%20prepended%20so%20that%20a%20processor%20can%20read%20and%20cache%20the%20token%20before%20it%20is%20used.%0A%0A8.3%20Signing%20Tokens%0A%0AIt%20is%20often%20desirable%20to%20sign%20security%20tokens%20that%20are%20included%20in%20a%20message%20or%20even%20external%20to%20the%20message.%20%20The%20XML%20Signature%20specification%20provides%20several%20common%20ways%20for%20referencing%20information%20to%20be%20signed%20such%20as%20URIs%2C%20IDs%2C%20and%20XPath%2C%20but%20some%20token%20formats%20may%20not%20allow%20tokens%20to%20be%20referenced%20using%20URIs%20or%20IDs%20and%20XPaths%20may%20be%20undesirable%20in%20some%20situations.%0A%0AThis%20specification%20allows%20different%20tokens%20to%20have%20their%20own%20unique%20reference%20mechanisms%20which%20are%20specified%20in%20their%20profile%20as%20extensions%20to%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element.%20%20This%20element%20provides%20a%20uniform%20referencing%20mechanism%20that%20is%20guaranteed%20to%20work%20with%20all%20token%20formats.%20%20Consequently%2C%20this%20specification%20defines%20a%20new%20reference%20option%20for%20XML%20Signature%3A%20the%20STR%20Dereference%20Transform.%20%0A%0A%20%0A%0AThis%20transform%20is%20specified%20by%20the%20URI%20%23STR-Transform%20and%20when%20applied%20to%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element%20it%20means%20that%20the%20output%20is%20the%20token%20referenced%20by%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element%20not%20the%20element%20itself.%0A%0A%20%0A%0AAs%20an%20overview%20the%20processing%20model%20is%20to%20echo%20the%20input%20to%20the%20transform%20except%20when%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element%20is%20encountered.%20%20When%20one%20is%20found%2C%20the%20element%20is%20not%20echoed%2C%20but%20instead%2C%20it%20is%20used%20to%20locate%20the%20token(s)%20matching%20the%20criteria%20and%20rules%20defined%20by%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element%20and%20echo%20it%20(them)%20to%20the%20output.%20%20Consequently%2C%20the%20output%20of%20the%20transformation%20is%20the%20resultant%20sequence%20representing%20the%20input%20with%20any%20%3Cwsse%3ASecurityTokenReference%3E%20elements%20replaced%20by%20the%20referenced%20security%20token(s)%20matched.%0A%0A%20%0A%0AThe%20following%20illustrates%20an%20example%20of%20this%20transformation%20which%20references%20a%20token%20contained%20within%20the%20message%20envelope%3A%0A%0A%20%0A%0A...%0A%0A%3Cwsse%3ASecurityTokenReference%20wsu%3AId%3D%22Str1%22%3E%0A%0A%20%20%20%20%20...%0A%0A%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A...%0A%0A%3Cds%3ASignature%20xmlns%3Ads%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23%22%3E%0A%0A%20%20%20%20%20%3Cds%3ASignedInfo%3E%0A%0A%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%3Cds%3AReference%20URI%3D%22%23Str1%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%3Cds%3ATransforms%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ATransform%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22...%23STR-Transform%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3ATransformationParameters%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ACanonicalizationMethod%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2FTR%2F2001%2FREC-xml-c14n-20010315%22%20%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ATransformationParameters%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ATransform%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ATransforms%3E%0A%0A%20%20%20%20%20%20%20%20%20%3Cds%3ADigestMethod%20Algorithm%3D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23sha1%22%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%3Cds%3ADigestValue%3E...%3C%2Fds%3ADigestValue%3E%0A%0A%20%20%20%20%20%20%20%3C%2Fds%3AReference%3E%0A%0A%20%20%20%20%20%3C%2Fds%3ASignedInfo%3E%0A%0A%20%20%20%20%20%3Cds%3ASignatureValue%3E%3C%2Fds%3ASignatureValue%3E%0A%0A%3C%2Fds%3ASignature%3E%20%20%0A%0A...%0A%0A%20%0A%0AThe%20following%20describes%20the%20attributes%20and%20elements%20listed%20in%20the%20example%20above%3A%0A%0A%20%0A%0A%2Fwsse%3ATransformationParameters%0A%0AThis%20element%20is%20used%20to%20wrap%20parameters%20for%20a%20transformation%20allows%20elements%20even%20from%20the%20XML%20Signature%20namespace.%0A%0A%20%0A%0A%2Fwsse%3ATransformationParameters%2Fds%3ACanonicalization%0A%0AThis%20specifies%20the%20canonicalization%20algorithm%20to%20apply%20to%20the%20selected%20data.%0A%0A%20%0A%0A%2Fwsse%3ATransformationParameters%2F%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20different%20(extensible)%20parameters%20to%20be%20specified%20in%20the%20future.%20%20Unrecognized%20parameters%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0A%2Fwsse%3ATransformationParameters%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%2C%20based%20on%20schemas%2C%20to%20be%20added%20to%20the%20element%20in%20the%20future.%20%20Unrecognized%20attributes%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0AThe%20following%20is%20a%20detailed%20specification%20of%20the%20transformation.%20The%20algorithm%20is%20identified%20by%20the%20URI%3A%20%23STR-Transform.%0A%0A%20%0A%0ATransform%20Input%3A%0A%0A%20%20%20%20The%20input%20is%20a%20node%20set.%20If%20the%20input%20is%20an%20octet%20stream%2C%20then%20it%20is%20automatically%20parsed%3B%20cf.%20XML%20Digital%20Signature%20%5BXMLSIG%5D.%0A%0ATransform%20Output%3A%0A%0A%20%20%20%20The%20output%20is%20an%20octet%20steam.%0A%0ASyntax%3A%0A%0A%20%20%20%20The%20transform%20takes%20a%20single%20mandatory%20parameter%2C%20a%20%3Cds%3ACanonicalizationMethod%3E%20element%2C%20which%20is%20used%20to%20serialize%20the%20output%20node%20set.%20Note%2C%20however%2C%20that%20the%20output%20may%20not%20be%20strictly%20in%20canonical%20form%2C%20per%20the%20canonicalization%20algorithm%3B%20however%2C%20the%20output%20is%20canonical%2C%20in%20the%20sense%20that%20it%20is%20unambiguous.%20%20However%2C%20because%20of%20syntax%20requirements%20in%20the%20XML%20Signature%20definition%2C%20this%20parameter%20MUST%20be%20wrapped%20in%20a%20%3Cwsse%3ATransformationParameters%3E%20element.%0A%20%20%20%20%20%0A%0AProcessing%20Rules%3A%0A%0A%20%20%20%20Let%20N%20be%20the%20input%20node%20set.%0A%20%20%20%20Let%20R%20be%20the%20set%20of%20all%20%3Cwsse%3ASecurityTokenReference%3E%20elements%20in%20N.%0A%20%20%20%20For%20each%20Ri%20in%20R%2C%20let%20Di%20be%20the%20result%20of%20dereferencing%20Ri.%0A%20%20%20%20If%20Di%20cannot%20be%20determined%2C%20then%20the%20transform%20MUST%20signal%20a%20failure.%0A%0A%20%20%20%20If%20Di%20is%20an%20XML%20security%20token%20(e.g.%2C%20a%20SAML%20assertion%20or%20a%20%3Cwsse%3ABinarySecurityToken%3E%20element)%2C%20then%20let%20Ri%27%20be%20Di.Otherwise%2C%20Di%20is%20a%20raw%20binary%20security%20token%3B%20i.e.%2C%20an%20octet%20stream.%20In%20this%20case%2C%20let%20Ri%27%20be%20a%20node%20set%20consisting%20of%20a%20%3Cwsse%3ABinarySecurityToken%3E%20element%2C%20utilizing%20the%20same%20namespace%20prefix%20as%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element%20Ri%2C%20with%20no%20EncodingType%20attribute%2C%20a%20ValueType%20attribute%20identifying%20the%20content%20of%20the%20security%20token%2C%20and%20text%20content%20consisting%20of%20the%20binary-encoded%20security%20token%2C%20with%20no%20white%20space.%0A%0A%20%20%20%20Finally%2C%20employ%20the%20canonicalization%20method%20specified%20as%20a%20parameter%20to%20the%20transform%20to%20serialize%20N%20to%20produce%20the%20octet%20stream%20output%20of%20this%20transform%3B%20but%2C%20in%20place%20of%20any%20dereferenced%20%3Cwsse%3ASecurityTokenReference%3E%20element%20Ri%20and%20its%20descendants%2C%20process%20the%20dereferenced%20node%20set%20Ri%27%20instead.%20During%20this%20step%2C%20canonicalization%20of%20the%20replacement%20node%20set%20MUST%20be%20augmented%20as%20follows%3A%0A%0A%20%20%20%20%20%20%20%20Note%3A%20A%20namespace%20declaration%20xmlns%3D%22%22%20MUST%20be%20emitted%20with%20every%20apex%20element%20that%20has%20no%20namespace%20node%20declaring%20a%20value%20for%20the%20default%20namespace%3B%20cf.%20XML%20Decryption%20Transform.%0A%0ANote%3A%20Per%20the%20processing%20rules%20above%2C%20any%20%3Cwsse%3ASecurityTokenReference%3E%20element%20is%20effectively%20replaced%20by%20the%20referenced%20%3Cwsse%3ABinarySecurityToken%3E%20element%20and%20then%20the%20%3Cwsse%3ABinarySecurityToken%3E%20is%20canonicalized%20in%20that%20context.%20Each%20%3Cwsse%3ABinarySecurityToken%3E%20needs%20to%20be%20complete%20in%20a%20given%20context%2C%20so%20any%20necessary%20namespace%20declarations%20that%20are%20not%20present%20on%20an%20ancestor%20element%20will%20need%20to%20be%20added%20to%20the%20%3Cwsse%3ABinarySecurityToken%3E%20element%20prior%20to%20canonicalization.%0A%0A%20%0A%0ASigning%20a%20%3Cwsse%3ASecurityTokenReference%3E%20(STR)%20element%20provides%20authentication%20and%20integrity%20protection%20of%20only%20the%20STR%20and%20not%20the%20referenced%20security%20token%20(ST).%20If%20signing%20the%20ST%20is%20the%20intended%20behavior%2C%20the%20STR%20Dereference%20Transform%20(STRDT)%20may%20be%20used%20which%20replaces%20the%20STR%20with%20the%20ST%20for%20digest%20computation%2C%20effectively%20protecting%20the%20ST%20and%20not%20the%20STR.%20If%20protecting%20both%20the%20ST%20and%20the%20STR%20is%20desired%2C%20you%20may%20sign%20the%20STR%20twice%2C%20once%20using%20the%20STRDT%20and%20once%20not%20using%20the%20STRDT.%0A%0A%20%0A%0AThe%20following%20table%20lists%20the%20full%20URI%20for%20each%20URI%20fragment%20referred%20to%20in%20the%20specification.%0A%0A%20%0A%0AURI%20Fragment%0A%09%0A%0AFull%20URI%0A%0A%23Base64Binary%0A%09%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-soap-message-security-1.0%23Base64Binary%0A%0A%23STR-Transform%0A%09%0A%0Ahttp%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-soap-message-security-1.0%23STRTransform%0A8.4%20Signature%20Validation%0A%0AThe%20validation%20of%20a%20%3Cds%3ASignature%3E%20element%20inside%20an%20%3Cwsse%3ASecurity%3E%20header%20block%20MUST%20fail%20if%3A%0A%0A%20%20%20%20the%20syntax%20of%20the%20content%20of%20the%20element%20does%20not%20conform%20to%20this%20specification%2C%20or%0A%20%20%20%20the%20validation%20of%20the%20signature%20contained%20in%20the%20element%20fails%20according%20to%20the%20core%20validation%20of%20the%20XML%20Signature%20specification%20%5BXMLSIG%5D%2C%20or%0A%20%20%20%20the%20application%20applying%20its%20own%20validation%20policy%20rejects%20the%20message%20for%20some%20reason%20(e.g.%2C%20the%20signature%20is%20created%20by%20an%20untrusted%20key%20%E2%80%93%20verifying%20the%20previous%20two%20steps%20only%20performs%20cryptographic%20validation%20of%20the%20signature).%20%0A%0A%20%0A%0AIf%20the%20validation%20of%20the%20signature%20element%20fails%2C%20applications%20MAY%20report%20the%20failure%20to%20the%20producer%20using%20the%20fault%20codes%20defined%20in%20Section%2012%20Error%20Handling.%0A%0A%20%0A%0AThe%20signature%20validation%20shall%20additionally%20adhere%20to%20the%20rules%20defines%20in%20signature%20confirmation%20section%20below%2C%20if%20the%20initiator%20desires%20signature%20confirmation%3A%0A8.5%20Signature%20Confirmation%0A%0AIn%20the%20general%20model%2C%20the%20initiator%20uses%20XML%20Signature%20constructs%20to%20represent%20message%20parts%20of%20the%20request%20that%20were%20signed.%20The%20manifest%20of%20signed%20SOAP%20elements%20is%20contained%20in%20the%20%3Cds%3ASignature%3E%20element%20which%20in%20turn%20is%20placed%20inside%20the%20%3Cwsse%3ASecurity%3E%20header.%20The%20%3Cds%3ASignature%3E%20element%20of%20the%20request%20contains%20a%20%3Cds%3ASignatureValue%3E.%20This%20element%20contains%20a%20base64%20encoded%20value%20representing%20the%20actual%20digital%20signature.%20In%20certain%20situations%20it%20is%20desirable%20that%20initiator%20confirms%20that%20the%20message%20received%20was%20generated%20in%20response%20to%20a%20message%20it%20initiated%20in%20its%20unaltered%20form.%20This%20helps%20prevent%20certain%20forms%20of%20attack.%20This%20specification%20introduces%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20to%20address%20this%20necessity.%0A%0A%20%0A%0ACompliant%20responder%20implementations%20that%20support%20signature%20confirmation%2C%20MUST%20include%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20inside%20the%20%3Cwsse%3ASecurity%3E%20header%20of%20the%20associated%20response%20message%20for%20every%20%3Cds%3ASignature%3E%20element%20that%20is%20a%20direct%20child%20of%20the%20%3Cwsse%3ASecurity%3E%20header%20block%20in%20the%20originating%20message.%20The%20responder%20MUST%20include%20the%20contents%20of%20the%20%3Cds%3ASignatureValue%3E%20element%20of%20the%20request%20signature%20as%20the%20value%20of%20the%20%40Value%20attribute%20of%20the%20%3Cwsse11%3ASignatureConfirmation%3E%20element.%20The%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20MUST%20be%20included%20in%20the%20message%20signature%20of%20the%20associated%20response%20message.%0A%0A%20%0A%0AIf%20the%20associated%20originating%20signature%20is%20received%20in%20encrypted%20form%20then%20the%20corresponding%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20SHOULD%20be%20encrypted%20to%20protect%20the%20original%20signature%20and%20keys.%0A%0A%20%0A%0AThe%20schema%20outline%20for%20this%20element%20is%20as%20follows%3A%0A%0A%20%0A%0A%3Cwsse11%3ASignatureConfirmation%20wsu%3AId%3D%22...%22%20Value%3D%22...%22%20%2F%3E%0A%0A%20%0A%0A%2Fwsse11%3ASignatureConfirmation%0A%0AThis%20element%20indicates%20that%20the%20responder%20has%20processed%20the%20signature%20in%20the%20request.%20When%20this%20element%20is%20not%20present%20in%20a%20response%20the%20initiator%20SHOULD%20interpret%20that%20the%20responder%20is%20not%20compliant%20with%20this%20functionality.%0A%0A%20%0A%0A%2Fwsse11%3ASignatureConfirmation%2F%40wsu%3AId%0A%0AIdentifier%20to%20be%20used%20when%20referencing%20this%20element%20in%20the%20%3Cds%3ASignedInfo%3E%20reference%20list%20of%20the%20signature%20of%20the%20associated%20response%20message.%20This%20attribute%20MUST%20be%20present%20so%20that%20un-ambiguous%20references%20can%20be%20made%20to%20this%20%3Cwsse11%3ASignatureConfirmation%3E%20element.%0A%0A%20%0A%0A%2Fwsse11%3ASignatureConfirmation%2F%40Value%0A%0AThis%20optional%20attribute%20contains%20the%20contents%20of%20a%20%3Cds%3ASignatureValue%3E%20copied%20from%20the%20associated%20request.%20If%20the%20request%20was%20not%20signed%2C%20then%20this%20attribute%20MUST%20NOT%20be%20present.%20If%20this%20attribute%20is%20specified%20with%20an%20empty%20value%2C%20the%20initiator%20SHOULD%20interpret%20this%20as%20incorrect%20behavior%20and%20process%20accordingly.%20When%20this%20attribute%20is%20not%20present%2C%20the%20initiator%20SHOULD%20interpret%20this%20to%20mean%20that%20the%20response%20is%20based%20on%20a%20request%20that%20was%20not%20signed.%0A8.5.1%20Response%20Generation%20Rules%0A%0AConformant%20responders%20MUST%20include%20at%20least%20one%20%3Cwsse11%3ASignatureConfirmation%3E.%20element%20in%20the%20%3Cwsse%3ASecurity%3E%20header%20in%20any%20response(s)%20associated%20with%20requests.%20That%20is%2C%20the%20normal%20messaging%20patterns%20are%20not%20altered.%0A%0AFor%20every%20response%20message%20generated%2C%20the%20responder%20MUST%20include%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20for%20every%20%3Cds%3ASignature%3E%20element%20it%20processed%20from%20the%20original%20request%20message.%20The%20Value%20attribute%20MUST%20be%20set%20to%20the%20exact%20value%20of%20the%20%3Cds%3ASignatureValue%3E%20element%20of%20the%20corresponding%20%3Cds%3ASignature%3E%20element.%20If%20no%20%3Cds%3ASignature%3E%20elements%20are%20present%20in%20the%20original%20request%20message%2C%20the%20responder%20MUST%20include%20exactly%20one%20%3Cwsse11%3ASignatureConfirmation%3E%20element.%20The%20Value%20attribute%20of%20the%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20MUST%20NOT%20be%20present.%20The%20responder%20MUST%20include%20all%20%3Cwsse11%3ASignatureConfirmation%3E%20elements%20in%20the%20message%20signature%20of%20the%20response%20message(s).%20If%20the%20%3Cds%3ASignature%3E%20element%20corresponding%20to%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20was%20encrypted%20in%20the%20original%20request%20message%2C%20the%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20SHOULD%20be%20encrypted%20for%20the%20recipient%20of%20the%20response%20message(s).%0A8.5.2%20Response%20Processing%20Rules%0A%0AThe%20signature%20validation%20shall%20additionally%20adhere%20to%20the%20following%20processing%20guidelines%2C%20if%20the%20initiator%20desires%20signature%20confirmation%3A%0A%0A%20%20%20%20If%20a%20response%20message%20does%20not%20contain%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20inside%20the%20%3Cwsse%3ASecurity%3E%20header%2C%20the%20initiator%20SHOULD%20reject%20the%20response%20message.%0A%20%20%20%20If%20a%20response%20message%20does%20contain%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20inside%20the%20%3Cwsse%3ASecurity%3E%20header%20but%20%40Value%20attribute%20is%20not%20present%20on%20%3Cwsse11%3ASignatureConfirmation%3E%20element%2C%20and%20the%20associated%20request%20message%20did%20include%20a%20%3Cds%3ASignature%3E%20element%2C%20the%20initiator%20SHOULD%20reject%20the%20response%20message.%0A%20%20%20%20If%20a%20response%20message%20does%20contain%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20inside%20the%20%3Cwsse%3ASecurity%3E%20header%20and%20the%20%40Value%20attribute%20is%20present%20on%20the%20%3Cwsse11%3ASignatureConfirmation%3E%20element%2C%20but%20the%20associated%20request%20did%20not%20include%20a%20%3Cds%3ASignature%3E%20element%2C%20the%20initiator%20SHOULD%20reject%20the%20response%20message.%0A%20%20%20%20If%20a%20response%20message%20does%20contain%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20inside%20the%20%3Cwsse%3ASecurity%3E%20header%2C%20and%20the%20associated%20request%20message%20did%20include%20a%20%3Cds%3ASignature%3E%20element%20and%20the%20%40Value%20attribute%20is%20present%20but%20does%20not%20match%20the%20stored%20signature%20value%20of%20the%20associated%20request%20message%2C%20the%20initiator%20SHOULD%20reject%20the%20response%20message.%0A%20%20%20%20If%20a%20response%20message%20does%20not%20contain%20a%20%3Cwsse11%3ASignatureConfirmation%3E%20element%20inside%20the%20%3Cwsse%3ASecurity%3E%20header%20corresponding%20to%20each%20%3Cds%3ASignature%3E%20element%20or%20%20if%20the%20%40Value%20attribute%20present%20does%20not%20match%20the%20stored%20signature%20values%20of%20the%20associated%20request%20message%2C%20the%20initiator%20SHOULD%20reject%20the%20response%20message.%0A%0A8.6%20Example%0A%0AThe%20following%20sample%20message%20illustrates%20the%20use%20of%20integrity%20and%20security%20tokens.%20%20For%20this%20example%2C%20only%20the%20message%20body%20is%20signed.%0A%0A%20%0A%0A%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0A%0A%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%20xmlns%3Awsu%3D%22...%22%20xmlns%3Ads%3D%22...%22%3E%0A%0A%20%20%20%3CS11%3AHeader%3E%0A%0A%20%20%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%20%20%20%3Cwsse%3ABinarySecurityToken%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ValueType%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-x509-token-profile-1.0%23X509v3%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20EncodingType%3D%22...%23Base64Binary%22%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wsu%3AId%3D%22X509Token%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20MIIEZzCCA9CgAwIBAgIQEmtJZc0rqrKh5i...%0A%0A%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ABinarySecurityToken%3E%0A%0A%20%20%20%20%20%20%20%20%20%3Cds%3ASignature%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignedInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ACanonicalizationMethod%20Algorithm%3D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2001%2F10%2Fxml-exc-c14n%23%22%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignatureMethod%20Algorithm%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23rsa-sha1%22%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AReference%20URI%3D%22%23myBody%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ATransforms%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ATransform%20Algorithm%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2001%2F10%2Fxml-exc-c14n%23%22%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ATransforms%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestMethod%20Algorithm%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23sha1%22%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestValue%3EEULddytSo1...%3C%2Fds%3ADigestValue%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AReference%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignedInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignatureValue%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20BL8jdfToEb1l%2FvXcMZNNjPOV...%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignatureValue%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AKeyInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3AReference%20URI%3D%22%23X509Token%22%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AKeyInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignature%3E%0A%0A%20%20%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A%20%20%20%3C%2FS11%3AHeader%3E%0A%0A%20%20%20%3CS11%3ABody%20wsu%3AId%3D%22myBody%22%3E%0A%0A%20%20%20%20%20%20%3Ctru%3AStockSymbol%20xmlns%3Atru%3D%22http%3A%2F%2Fwww.fabrikam123.com%2Fpayloads%22%3E%0A%20%20%20%20%20%20%20%20QQQ%0A%0A%20%20%20%20%20%20%3C%2Ftru%3AStockSymbol%3E%0A%0A%20%20%20%3C%2FS11%3ABody%3E%0A%0A%3C%2FS11%3AEnvelope%3E%0A9%20%20%20%20%20%20Encryption%0A%0AThis%20specification%20allows%20encryption%20of%20any%20combination%20of%20body%20blocks%2C%20header%20blocks%2C%20and%20any%20of%20these%20sub-structures%20by%20either%20a%20common%20symmetric%20key%20shared%20by%20the%20producer%20and%20the%20recipient%20or%20a%20symmetric%20key%20carried%20in%20the%20message%20in%20an%20encrypted%20form.%20%0A%0A%20%0A%0AIn%20order%20to%20allow%20this%20flexibility%2C%20this%20specification%20leverages%20the%20XML%20Encryption%20standard.%20%20This%20specification%20describes%20how%20the%20two%20elements%20%3Cxenc%3AReferenceList%3E%20and%20%3Cxenc%3AEncryptedKey%3E%20listed%20below%20and%20defined%20in%20XML%20Encryption%20can%20be%20used%20within%20the%20%3Cwsse%3ASecurity%3E%20header%20block.%20When%20a%20producer%20or%20an%20active%20intermediary%20encrypts%20portion(s)%20of%20a%20SOAP%20message%20using%20XML%20Encryption%20it%20MUST%20prepend%20a%20sub-element%20to%20the%20%3Cwsse%3ASecurity%3E%20header%20block.%20%20Furthermore%2C%20the%20encrypting%20party%20MUST%20either%20prepend%20the%20sub-element%20to%20an%20existing%20%3Cwsse%3ASecurity%3E%20header%20block%20for%20the%20intended%20recipients%20or%20create%20a%20new%20%3Cwsse%3ASecurity%3E%20header%20block%20and%20insert%20the%20sub-element.%20%20The%20combined%20process%20of%20encrypting%20portion(s)%20of%20a%20message%20and%20adding%20one%20of%20these%20sub-elements%20is%20called%20an%20encryption%20step%20hereafter.%20The%20sub-element%20MUST%20contain%20the%20information%20necessary%20for%20the%20recipient%20to%20identify%20the%20portions%20of%20the%20message%20that%20it%20is%20able%20to%20decrypt.%0A%0A%20%0A%0AThis%20specification%20additionally%20defines%20an%20element%20%3Cwsse11%3AEncryptedHeader%3E%20for%20containing%20encrypted%20SOAP%20header%20blocks.%20This%20specification%20RECOMMENDS%20an%20additional%20mechanism%20that%20uses%20this%20element%20for%20encrypting%20SOAP%20header%20blocks%20that%20complies%20with%20SOAP%20processing%20guidelines%20while%20preserving%20the%20confidentiality%20of%20attributes%20on%20the%20SOAP%20header%20blocks.%0A%0AAll%20compliant%20implementations%20MUST%20be%20able%20to%20support%20the%20XML%20Encryption%20standard%20%5BXMLENC%5D.%0A9.1%20xenc%3AReferenceList%0A%0AThe%20%3Cxenc%3AReferenceList%3E%20element%20from%20XML%20Encryption%20%5BXMLENC%5D%20MAY%20be%20used%20to%20create%20a%20manifest%20of%20encrypted%20portion(s)%2C%20which%20are%20expressed%20as%20%3Cxenc%3AEncryptedData%3E%20elements%20within%20the%20envelope.%20%20An%20element%20or%20element%20content%20to%20be%20encrypted%20by%20this%20encryption%20step%20MUST%20be%20replaced%20by%20a%20corresponding%20%3Cxenc%3AEncryptedData%3E%20according%20to%20XML%20Encryption.%20All%20the%20%3Cxenc%3AEncryptedData%3E%20elements%20created%20by%20this%20encryption%20step%20SHOULD%20be%20listed%20in%20%3Cxenc%3ADataReference%3E%20elements%20inside%20one%20or%20more%20%3Cxenc%3AReferenceList%3E%20element.%20%0A%0A%20%0A%0AAlthough%20in%20XML%20Encryption%20%5BXMLENC%5D%2C%20%3Cxenc%3AReferenceList%3E%20was%20originally%20designed%20to%20be%20used%20within%20an%20%3Cxenc%3AEncryptedKey%3E%20element%20(which%20implies%20that%20all%20the%20referenced%20%3Cxenc%3AEncryptedData%3E%20elements%20are%20encrypted%20by%20the%20same%20key)%2C%20this%20specification%20allows%20that%20%3Cxenc%3AEncryptedData%3E%20elements%20referenced%20by%20the%20same%20%3Cxenc%3AReferenceList%3E%20MAY%20be%20encrypted%20by%20different%20keys.%20%20Each%20encryption%20key%20can%20be%20specified%20in%20%3Cds%3AKeyInfo%3E%20within%20individual%20%3Cxenc%3AEncryptedData%3E.%0A%0A%20%0A%0AA%20typical%20situation%20where%20the%20%3Cxenc%3AReferenceList%3E%20sub-element%20is%20useful%20is%20that%20the%20producer%20and%20the%20recipient%20use%20a%20shared%20secret%20key.%20%20The%20following%20illustrates%20the%20use%20of%20this%20sub-element%3A%0A%0A%20%0A%0A%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%20xmlns%3Awsu%3D%22...%22%20xmlns%3Ads%3D%22...%22%20xmlns%3Axenc%3D%22...%22%3E%0A%0A%20%20%20%20%3CS11%3AHeader%3E%0A%0A%20%20%20%20%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3AReferenceList%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ADataReference%20URI%3D%22%23bodyID%22%2F%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3AReferenceList%3E%0A%0A%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A%20%20%20%20%3C%2FS11%3AHeader%3E%0A%0A%20%20%20%20%3CS11%3ABody%3E%0A%0A%20%20%20%20%20%20%20%20%3Cxenc%3AEncryptedData%20Id%3D%22bodyID%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%3Cds%3AKeyInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AKeyName%3ECN%3DHiroshi%20Maruyama%2C%20C%3DJP%3C%2Fds%3AKeyName%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AKeyInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherData%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherValue%3E...%3C%2Fxenc%3ACipherValue%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3ACipherData%3E%0A%0A%20%20%20%20%20%20%20%20%3C%2Fxenc%3AEncryptedData%3E%0A%0A%20%20%20%20%3C%2FS11%3ABody%3E%0A%0A%3C%2FS11%3AEnvelope%3E%0A9.2%20xenc%3AEncryptedKey%0A%0AWhen%20the%20encryption%20step%20involves%20encrypting%20elements%20or%20element%20contents%20within%20a%20SOAP%20envelope%20with%20a%20symmetric%20key%2C%20which%20is%20in%20turn%20to%20be%20encrypted%20by%20the%20recipient%E2%80%99s%20key%20and%20embedded%20in%20the%20message%2C%20%3Cxenc%3AEncryptedKey%3E%20MAY%20be%20used%20for%20carrying%20such%20an%20encrypted%20key.%20%20This%20sub-element%20MAY%20contain%20a%20manifest%2C%20that%20is%2C%20an%20%3Cxenc%3AReferenceList%3E%20element%2C%20that%20lists%20the%20portions%20to%20be%20decrypted%20with%20this%20key.%20The%20manifest%20MAY%20appear%20outside%20the%20%3Cxenc%3AEncryptedKey%3E%20provided%20that%20the%20corresponding%20xenc%3AEncryptedData%0A%0Aelements%20contain%20%3Cxenc%3AKeyInfo%3E%20elements%20that%20reference%20the%20%3Cxenc%3AEncryptedKey%3E%20element..%20An%20element%20or%20element%20content%20to%20be%20encrypted%20by%20this%20encryption%20step%20MUST%20be%20replaced%20by%20a%20corresponding%20%3Cxenc%3AEncryptedData%3E%20according%20to%20XML%20Encryption.%20All%20the%20%3Cxenc%3AEncryptedData%3E%20elements%20created%20by%20this%20encryption%20step%20SHOULD%20be%20listed%20in%20the%20%3Cxenc%3AReferenceList%3E%20element%20inside%20this%20sub-element.%20%0A%0A%20%0A%0AThis%20construct%20is%20useful%20when%20encryption%20is%20done%20by%20a%20randomly%20generated%20symmetric%20key%20that%20is%20in%20turn%20encrypted%20by%20the%20recipient%E2%80%99s%20public%20key.%20The%20following%20illustrates%20the%20use%20of%20this%20element%3A%0A%0A%20%0A%0A%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%20xmlns%3Awsu%3D%22...%22%20xmlns%3Ads%3D%22...%22%20xmlns%3Axenc%3D%22...%22%3E%0A%0A%20%20%20%20%3CS11%3AHeader%3E%0A%0A%20%20%20%20%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3AEncryptedKey%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AKeyInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AX509IssuerSerial%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AX509IssuerName%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20DC%3DACMECorp%2C%20DC%3Dcom%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AX509IssuerName%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AX509SerialNumber%3E12345678%3C%2Fds%3AX509SerialNumber%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AX509IssuerSerial%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AKeyInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20...%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3AEncryptedKey%3E%0A%0A%20%20...%0A%0A%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A%20%20%20%20%3C%2FS11%3AHeader%3E%0A%0A%20%20%20%20%3CS11%3ABody%3E%0A%0A%20%20%20%20%20%20%20%20%3Cxenc%3AEncryptedData%20Id%3D%22bodyID%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherData%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherValue%3E...%3C%2Fxenc%3ACipherValue%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3ACipherData%3E%0A%0A%20%20%20%20%20%20%20%20%3C%2Fxenc%3AEncryptedData%3E%0A%0A%20%20%20%20%3C%2FS11%3ABody%3E%0A%0A%3C%2FS11%3AEnvelope%3E%0A%0A%20%0A%0AWhile%20XML%20Encryption%20specifies%20that%20%3Cxenc%3AEncryptedKey%3E%20elements%20MAY%20be%20specified%20in%20%3Cxenc%3AEncryptedData%3E%20elements%2C%20this%20specification%20strongly%20RECOMMENDS%20that%20%3Cxenc%3AEncryptedKey%3E%20elements%20be%20placed%20in%20the%20%3Cwsse%3ASecurity%3E%20header.%0A9.3%20Encrypted%20Header%0A%0AIn%20order%20to%20be%20compliant%20with%20SOAP%20mustUnderstand%20processing%20guidelines%20and%20to%20prevent%20disclosure%20of%20information%20contained%20in%20attributes%20on%20a%20SOAP%20header%20block%2C%20this%20specification%20introduces%20an%20%3Cwsse11%3AEncryptedHeader%3E%20element.%20This%20element%20contains%20exactly%20one%20%3Cxenc%3AEncryptedData%3E%20element.%20This%20specification%20RECOMMENDS%20the%20use%20of%20%3Cwsse11%3AEncryptedHeader%3E%20element%20for%20encrypting%20SOAP%20header%20blocks.%0A9.4%20Processing%20Rules%0A%0AEncrypted%20parts%20or%20using%20one%20of%20the%20sub-elements%20defined%20above%20MUST%20be%20in%20compliance%20with%20the%20XML%20Encryption%20specification.%20An%20encrypted%20SOAP%20envelope%20MUST%20still%20be%20a%20valid%20SOAP%20envelope.%20The%20message%20creator%20MUST%20NOT%20encrypt%20the%20%3CS11%3AHeader%3E%2C%20%3CS12%3AHeader%3E%2C%20%3CS11%3AEnvelope%3E%2C%20%3CS12%3AEnvelope%3E%2Cor%20%3CS11%3ABody%3E%2C%20%3CS12%3ABody%3E%20elements%20but%20MAY%20encrypt%20child%20elements%20of%20either%20the%20%3CS11%3AHeader%3E%2C%20%3CS12%3AHeader%3E%20and%20%3CS11%3ABody%3E%20or%20%3CS12%3ABody%3E%20elements.%20Multiple%20steps%20of%20encryption%20MAY%20be%20added%20into%20a%20single%20%3Cwsse%3ASecurity%3E%20header%20block%20if%20they%20are%20targeted%20for%20the%20same%20recipient.%0A%0A%20%0A%0AWhen%20an%20element%20or%20element%20content%20inside%20a%20SOAP%20envelope%20(e.g.%20the%20contents%20of%20the%20%3CS11%3ABody%3E%20or%20%3CS12%3ABody%3E%20elements)%20are%20to%20be%20encrypted%2C%20it%20MUST%20be%20replaced%20by%20an%20%3Cxenc%3AEncryptedData%3E%2C%20according%20to%20XML%20Encryption%20and%20it%20SHOULD%20be%20referenced%20from%20the%20%3Cxenc%3AReferenceList%3E%20element%20created%20by%20this%20encryption%20step.%20If%20the%20target%20of%20reference%20is%20an%20EncryptedHeader%20as%20defined%20in%20section%209.3%20above%2C%20see%20processing%20rules%20defined%20in%20section%209.5.3%20Encryption%20using%20EncryptedHeader%20and%20section%209.5.4%20Decryption%20of%20EncryptedHeader%20below.%0A9.4.1%20Encryption%0A%0AThe%20general%20steps%20(non-normative)%20for%20creating%20an%20encrypted%20SOAP%20message%20in%20compliance%20with%20this%20specification%20are%20listed%20below%20(note%20that%20use%20of%20%3Cxenc%3AReferenceList%3E%20is%20RECOMMENDED.%20Additionally%2C%20if%20the%20target%20of%20encryption%20is%20a%20SOAP%20header%2C%20processing%20rules%20defined%20in%20section%209.5.3%20SHOULD%20be%20used).%0A%0A%20%20%20%20Create%20a%20new%20SOAP%20envelope.%0A%20%20%20%20Create%20a%20%3Cwsse%3ASecurity%3E%20header%0A%20%20%20%20When%20an%20%3Cxenc%3AEncryptedKey%3E%20is%20used%2C%20create%20a%20%3Cxenc%3AEncryptedKey%3E%20sub-element%20of%20the%20%3Cwsse%3ASecurity%3E%20element.%20This%20%3Cxenc%3AEncryptedKey%3E%20sub-element%20SHOULD%20contain%20an%20%3Cxenc%3AReferenceList%3E%20sub-element%2C%20containing%20a%20%3Cxenc%3ADataReference%3E%20to%20each%20%3Cxenc%3AEncryptedData%3E%20element%20that%20was%20encrypted%20using%20that%20key.%0A%20%20%20%20Locate%20data%20items%20to%20be%20encrypted%2C%20i.e.%2C%20XML%20elements%2C%20element%20contents%20within%20the%20target%20SOAP%20envelope.%0A%20%20%20%20Encrypt%20the%20data%20items%20as%20follows%3A%20For%20each%20XML%20element%20or%20element%20content%20within%20the%20target%20SOAP%20envelope%2C%20encrypt%20it%20according%20to%20the%20processing%20rules%20of%20the%20XML%20Encryption%20specification%20%5BXMLENC%5D.%20Each%20selected%20original%20element%20or%20element%20content%20MUST%20be%20removed%20and%20replaced%20by%20the%20resulting%20%3Cxenc%3AEncryptedData%3E%20element.%0A%20%20%20%20The%20optional%20%3Cds%3AKeyInfo%3E%20element%20in%20the%20%3Cxenc%3AEncryptedData%3E%20element%20MAY%20reference%20another%20%3Cds%3AKeyInfo%3E%20element.%20Note%20that%20if%20the%20encryption%20is%20based%20on%20an%20attached%20security%20token%2C%20then%20a%20%3Cwsse%3ASecurityTokenReference%3E%20element%20SHOULD%20be%20added%20to%20the%20%3Cds%3AKeyInfo%3E%20element%20to%20facilitate%20locating%20it.%0A%20%20%20%20Create%20an%20%3Cxenc%3ADataReference%3E%20element%20referencing%20the%20generated%20%3Cxenc%3AEncryptedData%3E%20elements.%20%20Add%20the%20created%20%3Cxenc%3ADataReference%3E%20element%20to%20the%20%3Cxenc%3AReferenceList%3E.%0A%20%20%20%20Copy%20all%20non-encrypted%20data.%0A%0A9.4.2%20Decryption%0A%0AOn%20receiving%20a%20SOAP%20envelope%20containing%20encryption%20header%20elements%2C%20for%20each%20encryption%20header%20element%20the%20following%20general%20steps%20should%20be%20processed%20(this%20section%20is%20non-normative.%20Additionally%2C%20if%20the%20target%20of%20reference%20is%20an%20EncryptedHeader%2C%20processing%20rules%20as%20defined%20in%20section%209.5.4%20below%20SHOULD%20be%20used)%3A%0A%0A%20%0A%0A%20%20%20%20Identify%20any%20decryption%20keys%20that%20are%20in%20the%20recipient%E2%80%99s%20possession%2C%20then%20identifying%20any%20message%20elements%20that%20it%20is%20able%20to%20decrypt.%0A%20%20%20%20Locate%20the%20%3Cxenc%3AEncryptedData%3E%20items%20to%20be%20decrypted%20(possibly%20using%20the%20%3Cxenc%3AReferenceList%3E).%20%0A%20%20%20%20Decrypt%20them%20as%20follows%3A%0A%20%20%20%20%20%20%20%20For%20each%20element%20in%20the%20target%20SOAP%20envelope%2C%20decrypt%20it%20according%20to%20the%20processing%20rules%20of%20the%20XML%20Encryption%20specification%20and%20the%20processing%20rules%20listed%20above.%0A%20%20%20%20%20%20%20%20If%20the%20decryption%20fails%20for%20some%20reason%2C%20applications%20MAY%20report%20the%20failure%20to%20the%20producer%20using%20the%20fault%20code%20defined%20in%20Section%2012%20Error%20Handling%20of%20this%20specification.%0A%20%20%20%20%20%20%20%20It%20is%20possible%20for%20overlapping%20portions%20of%20the%20SOAP%20message%20to%20be%20encrypted%20in%20such%20a%20way%20that%20they%20are%20intended%20to%20be%20decrypted%20by%20SOAP%20nodes%20acting%20in%20different%20Roles.%20In%20this%20case%2C%20the%20%3Cxenc%3AReferenceList%3E%20or%20%3Cxenc%3AEncryptedKey%3E%20elements%20identifying%20these%20encryption%20operations%20will%20necessarily%20appear%20in%20different%20%3Cwsse%3ASecurity%3E%20headers.%20Since%20SOAP%20does%20not%20provide%20any%20means%20of%20specifying%20the%20order%20in%20which%20different%20Roles%20will%20process%20their%20respective%20headers%2C%20this%20order%20is%20not%20specified%20by%20this%20specification%20and%20can%20only%20be%20determined%20by%20a%20prior%20agreement.%0A%0A9.4.3%20Encryption%20with%20EncryptedHeader%0A%0AWhen%20it%20is%20required%20that%20an%20entire%20SOAP%20header%20block%20including%20the%20top-level%20element%20and%20its%20attributes%20be%20encrypted%2C%20the%20original%20header%20block%20SHOULD%20be%20replaced%20with%20a%20%3Cwsse11%3AEncryptedHeader%3E%20element.%20The%20%3Cwsse11%3AEncryptedHeader%3E%20element%20MUST%20contain%20the%20%3Cxenc%3AEncryptedData%3E%20produced%20by%20encrypting%20the%20header%20block.%20A%20wsu%3AId%20attribute%20MAY%20be%20added%20to%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element%20for%20referencing.%20If%20the%20referencing%20%3Cwsse%3ASecurity%3E%20header%20block%20defines%20a%20value%20for%20the%20%3CS12%3AmustUnderstand%3E%20or%20%3CS11%3AmustUnderstand%3E%20attribute%2C%20that%20attribute%20and%20associated%20value%20MUST%20be%20copied%20to%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element.%20If%20the%20referencing%20%3Cwsse%3ASecurity%3E%20header%20block%20defines%20a%20value%20for%20the%20S12%3Arole%20or%20S11%3Aactor%20attribute%2C%20that%20attribute%20and%20associated%20value%20MUST%20be%20copied%20to%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element.%20If%20the%20referencing%20%3Cwsse%3ASecurity%3E%20header%20block%20defines%20a%20value%20for%20the%20S12%3Arelay%20attribute%2C%20that%20attribute%20and%20associated%20value%20MUST%20be%20copied%20%20to%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element.%0A%0A%20%0A%0AAny%20header%20block%20can%20be%20replaced%20with%20a%20corresponding%20%3Cwsse11%3AEncryptedHeader%3E%20header%20block.%20This%20includes%20%3Cwsse%3ASecurity%3E%20header%20blocks.%20(In%20this%20case%2C%20obviously%20if%20the%20encryption%20operation%20is%20specified%20in%20the%20same%20security%20header%20or%20in%20a%20security%20header%20targeted%20at%20a%20node%20which%20is%20reached%20after%20the%20node%20targeted%20by%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element%2C%20the%20decryption%20will%20not%20occur.)%0A%0A%20%0A%0AIn%20addition%2C%20%3Cwsse11%3AEncryptedHeader%3E%20header%20blocks%20can%20be%20super-encrypted%20and%20replaced%20by%20other%20%3Cwsse11%3AEncryptedHeader%3E%20header%20blocks%20(for%20wrapping%2Ftunneling%20scenarios).%20Any%20%3Cwsse%3ASecurity%3E%20header%20that%20encrypts%20a%20header%20block%20targeted%20to%20a%20particular%20actor%20SHOULD%20be%20targeted%20to%20that%20same%20actor%2C%20unless%20it%20is%20a%20security%20header.%0A9.4.4%20Processing%20an%20EncryptedHeader%0A%0AThe%20processing%20model%20for%20%3Cwsse11%3AEncryptedHeader%3E%20header%20blocks%20is%20as%20follows%3A%0A%0A1.%20%20%20%20%20Resolve%20references%20to%20encrypted%20data%20specified%20in%20the%20%3Cwsse%3ASecurity%3E%20header%20block%20targeted%20at%20this%20node.%20For%20each%20reference%2C%20perform%20the%20following%20steps.%0A%0A2.%20%20%20%20%20If%20the%20referenced%20element%20does%20not%20have%20a%20qualified%20name%20of%20%3Cwsse11%3AEncryptedHeader%3E%20then%20process%20as%20per%20section%209.4.2%20Decryption%20and%20stop%20the%20processing%20steps%20here.%0A%0A3.%20%20%20%20%20Otherwise%2C%20extract%20the%20%3Cxenc%3AEncryptedData%3E%20element%20from%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element.%0A%0A4.%20%20%20%20%20Decrypt%20the%20contents%20of%20the%20%3Cxenc%3AEncryptedData%3E%20element%20as%20per%20section%209.4.2%20Decryption%20and%20replace%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element%20with%20the%20decrypted%20contents.%0A%0A5.%20%20%20%20%20Process%20the%20decrypted%20header%20block%20as%20per%20SOAP%20processing%20guidelines.%0A%0A%20%0A%0AAlternatively%2C%20a%20processor%20may%20perform%20a%20pre-pass%20over%20the%20encryption%20references%20in%20the%20%3Cwsse%3ASecurity%3E%20header%3A%0A%0A1.%20%20%20%20%20Resolve%20references%20to%20encrypted%20data%20specified%20in%20the%20%3Cwsse%3ASecurity%3E%20header%20block%20targeted%20at%20this%20node.%20For%20each%20reference%2C%20perform%20the%20following%20steps.%0A%0A2.%20%20%20%20%20If%20a%20referenced%20element%20has%20a%20qualified%20name%20of%20%3Cwsse11%3AEncryptedHeader%3E%20then%20replace%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element%20with%20the%20contained%20%3Cxenc%3AEncryptedData%3E%20element%20and%20if%20present%20copy%20the%20value%20of%20the%20wsu%3AId%20attribute%20from%20the%20%3Cwsse11%3AEncryptedHeader%3E%20element%20to%20the%20%3Cxenc%3AEncryptedData%3E%20element.%0A%0A3.%20%20%20%20%20Process%20the%20%3Cwsse%3ASecurity%3E%20header%20block%20as%20normal.%0A%0A%20%0A%0AIt%20should%20be%20noted%20that%20the%20results%20of%20decrypting%20a%20%3Cwsse11%3AEncryptedHeader%3E%20header%20block%20could%20be%20another%20%3Cwsse11%3AEncryptedHeader%3E%20header%20block.%20%20In%20addition%2C%20the%20result%20MAY%20be%20targeted%20at%20a%20different%20role%20than%20the%20role%20processing%20the%20%3Cwsse11%3AEncryptedHeader%3E%20header%20block.%0A9.4.5%20Processing%20the%20mustUnderstand%20attribute%20on%20EncryptedHeader%0A%0AIf%20the%20S11%3AmustUnderstand%20or%20S12%3AmustUnderstand%20attribute%20is%20specified%20on%20the%20%3Cwsse11%3AEncryptedHeader%3E%20header%20block%2C%20and%20is%20true%2C%20then%20the%20following%20steps%20define%20what%20it%20means%20to%20%22understand%22%20the%20%3Cwsse11%3AEncryptedHeader%3E%20header%20block%3A%0A%0A1.%20%20%20%20%20The%20processor%20MUST%20be%20aware%20of%20this%20element%20and%20know%20how%20to%20decrypt%20and%20convert%20into%20the%20original%20header%20block.%20%20This%20DOES%20NOT%20REQUIRE%20that%20the%20process%20know%20that%20it%20has%20the%20correct%20keys%20or%20support%20the%20indicated%20algorithms.%0A%0A2.%20%20The%20processor%20MUST%2C%20after%20decrypting%20the%20encrypted%20header%20block%2C%20process%20the%20decrypted%20header%20block%20according%20to%20the%20SOAP%20processing%20guidelines.%20The%20receiver%20MUST%20raise%20a%20fault%20if%20any%20content%20required%20to%20adequately%20process%20the%20header%20block%20remains%20encrypted%20or%20if%20the%20decrypted%20SOAP%20header%20is%20not%20understood%20and%20the%20value%20of%20the%20S12%3AmustUnderstand%20or%20S11%3AmustUnderstand%20attribute%20on%20the%20decrypted%20header%20block%20is%20true.%20Note%20that%20in%20order%20to%20comply%20with%20SOAP%20processing%20rules%20in%20this%20case%2C%20the%20processor%20must%20roll%20back%20any%20persistent%20effects%20of%20processing%20the%20security%20header%2C%20such%20as%20storing%20a%20received%20token.%0A10%20Security%20Timestamps%0A%0AIt%20is%20often%20important%20for%20the%20recipient%20to%20be%20able%20to%20determine%20the%20freshness%20of%20security%20semantics.%20%20In%20some%20cases%2C%20security%20semantics%20may%20be%20so%20stale%20that%20the%20recipient%20may%20decide%20to%20ignore%20it.%20%0A%0AThis%20specification%20does%20not%20provide%20a%20mechanism%20for%20synchronizing%20time.%20%20The%20assumption%20is%20that%20time%20is%20trusted%20or%20additional%20mechanisms%2C%20not%20described%20here%2C%20are%20employed%20to%20prevent%20replay.%0A%0AThis%20specification%20defines%20and%20illustrates%20time%20references%20in%20terms%20of%20the%20xsd%3AdateTime%20type%20defined%20in%20XML%20Schema.%20%20It%20is%20RECOMMENDED%20that%20all%20time%20references%20use%20this%20type.%20%20All%20references%20MUST%20be%20in%20UTC%20time.%20Implementations%20MUST%20NOT%20generate%20time%20instants%20that%20specify%20leap%20seconds.%20If%2C%20however%2C%20other%20time%20types%20are%20used%2C%20then%20the%20ValueType%20attribute%20(described%20below)%20MUST%20be%20specified%20to%20indicate%20the%20data%20type%20of%20the%20time%20format.%20Requestors%20and%20receivers%20SHOULD%20NOT%20rely%20on%20other%20applications%20supporting%20time%20resolution%20finer%20than%20milliseconds.%0A%0A%20%0A%0AThe%20%3Cwsu%3ATimestamp%3E%20element%20provides%20a%20mechanism%20for%20expressing%20the%20creation%20and%20expiration%20times%20of%20the%20security%20semantics%20in%20a%20message.%20%0A%0A%20%0A%0AAll%20times%20MUST%20be%20in%20UTC%20format%20as%20specified%20by%20the%20XML%20Schema%20type%20(dateTime).%20%20It%20should%20be%20noted%20that%20times%20support%20time%20precision%20as%20defined%20in%20the%20XML%20Schema%20specification.%0A%0AThe%20%3Cwsu%3ATimestamp%3E%20element%20is%20specified%20as%20a%20child%20of%20the%20%3Cwsse%3ASecurity%3E%20header%20and%20may%20only%20be%20present%20at%20most%20once%20per%20header%20(that%20is%2C%20per%20SOAP%20actor%2Frole).%20%0A%0A%20%0A%0AThe%20ordering%20within%20the%20element%20is%20as%20illustrated%20below.%20%20The%20ordering%20of%20elements%20in%20the%20%3Cwsu%3ATimestamp%3E%20element%20is%20fixed%20and%20MUST%20be%20preserved%20by%20intermediaries.%20%0A%0AThe%20schema%20outline%20for%20the%20%3Cwsu%3ATimestamp%3E%20element%20is%20as%20follows%3A%0A%0A%20%0A%0A%3Cwsu%3ATimestamp%20wsu%3AId%3D%22...%22%3E%0A%0A%20%20%20%20%3Cwsu%3ACreated%20ValueType%3D%22...%22%3E...%3C%2Fwsu%3ACreated%3E%0A%0A%20%20%20%20%3Cwsu%3AExpires%20%20ValueType%3D%22...%22%3E...%3C%2Fwsu%3AExpires%3E%0A%0A%20%20%20%20...%0A%0A%3C%2Fwsu%3ATimestamp%3E%0A%0A%20%0A%0AThe%20following%20describes%20the%20attributes%20and%20elements%20listed%20in%20the%20schema%20above%3A%0A%0A%20%0A%0A%2Fwsu%3ATimestamp%0A%0AThis%20is%20the%20element%20for%20indicating%20security%20semantics%20%20timestamps.%20%0A%0A%20%0A%0A%2Fwsu%3ATimestamp%2Fwsu%3ACreated%0A%0AThis%20represents%20the%20creation%20time%20of%20the%20security%20semantics.%20%20This%20element%20is%20optional%2C%20but%20can%20only%20be%20specified%20once%20in%20a%20%3Cwsu%3ATimestamp%3E%20element.%20%20Within%20the%20SOAP%20processing%20model%2C%20creation%20is%20the%20instant%20that%20the%20infoset%20is%20serialized%20for%20transmission.%20%20The%20creation%20time%20of%20the%20message%20SHOULD%20NOT%20differ%20substantially%20from%20its%20transmission%20time.%20The%20difference%20in%20time%20should%20be%20minimized.%0A%0A%20%0A%0A%2Fwsu%3ATimestamp%2Fwsu%3AExpires%0A%0AThis%20element%20represents%20the%20expiration%20of%20the%20security%20semantics.%20%20This%20is%20optional%2C%20but%20can%20appear%20at%20most%20once%20in%20a%20%3Cwsu%3ATimestamp%3E%20element.%20%20Upon%20expiration%2C%20the%20requestor%20asserts%20that%20its%20security%20semantics%20are%20no%20longer%20valid.%20%20It%20is%20strongly%20RECOMMENDED%20that%20recipients%20(anyone%20who%20processes%20this%20message)%20discard%20(ignore)%20any%20message%20whose%20security%20semantics%20have%20passed%20their%20expiration.%20%20A%20Fault%20code%20(wsu%3AMessageExpired)%20is%20provided%20if%20the%20recipient%20wants%20to%20inform%20the%20requestor%20that%20its%20security%20semantics%20were%20expired.%20A%20service%20MAY%20issue%20a%20Fault%20indicating%20the%20security%20semantics%20have%20expired.%0A%0A%20%0A%0A%2Fwsu%3ATimestamp%2F%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20elements%20to%20be%20added%20to%20the%20element.%20Unrecognized%20elements%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0A%2Fwsu%3ATimestamp%2F%40wsu%3AId%0A%0AThis%20optional%20attribute%20specifies%20an%20XML%20Schema%20ID%20that%20can%20be%20used%20to%20reference%20this%20element%20(the%20timestamp).%20%20This%20is%20used%2C%20for%20example%2C%20to%20reference%20the%20timestamp%20in%20a%20XML%20Signature.%0A%0A%20%0A%0A%2Fwsu%3ATimestamp%2F%40%7Bany%7D%0A%0AThis%20is%20an%20extensibility%20mechanism%20to%20allow%20additional%20attributes%20to%20be%20added%20to%20the%20element.%20Unrecognized%20attributes%20SHOULD%20cause%20a%20fault.%0A%0A%20%0A%0AThe%20expiration%20is%20relative%20to%20the%20requestor%27s%20clock.%20%20In%20order%20to%20evaluate%20the%20expiration%20time%2C%20recipients%20need%20to%20recognize%20that%20the%20requestor%27s%20clock%20may%20not%20be%20synchronized%20to%20the%20recipient%E2%80%99s%20clock.%20%20The%20recipient%2C%20therefore%2C%20MUST%20make%20an%20assessment%20of%20the%20level%20of%20trust%20to%20be%20placed%20in%20the%20requestor%27s%20clock%2C%20since%20the%20recipient%20is%20called%20upon%20to%20evaluate%20whether%20the%20expiration%20time%20is%20in%20the%20past%20relative%20to%20the%20requestor%27s%2C%20not%20the%20recipient%E2%80%99s%2C%20clock.%20%20The%20recipient%20may%20make%20a%20judgment%20of%20the%20requestor%E2%80%99s%20likely%20current%20clock%20time%20by%20means%20not%20described%20in%20this%20specification%2C%20for%20example%20an%20out-of-band%20clock%20synchronization%20protocol.%20%20The%20recipient%20may%20also%20use%20the%20creation%20time%20and%20the%20delays%20introduced%20by%20intermediate%20SOAP%20roles%20to%20estimate%20the%20degree%20of%20clock%20skew.%20%0A%0A%20%0A%0AThe%20following%20example%20illustrates%20the%20use%20of%20the%20%3Cwsu%3ATimestamp%3E%20element%20and%20its%20content.%0A%0A%20%0A%0A%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%20xmlns%3Awsu%3D%22...%22%3E%0A%0A%20%20%3CS11%3AHeader%3E%0A%0A%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A%20%20%20%20%20%20%3Cwsu%3ATimestamp%20wsu%3AId%3D%22timestamp%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%3Cwsu%3ACreated%3E2001-09-13T08%3A42%3A00Z%3C%2Fwsu%3ACreated%3E%0A%0A%20%20%20%20%20%20%20%20%20%3Cwsu%3AExpires%3E2001-10-13T09%3A00%3A00Z%3C%2Fwsu%3AExpires%3E%0A%0A%20%20%20%20%20%20%3C%2Fwsu%3ATimestamp%3E%0A%0A%20%20%20%20%20%20...%0A%0A%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A%20%20%20%20...%0A%0A%20%20%3C%2FS11%3AHeader%3E%0A%0A%20%20%3CS11%3ABody%3E%0A%0A%20%20%20%20...%0A%0A%20%20%3C%2FS11%3ABody%3E%0A%0A%3C%2FS11%3AEnvelope%3E%20%20%0A11%20Extended%20Example%0A%0AThe%20following%20sample%20message%20illustrates%20the%20use%20of%20security%20tokens%2C%20signatures%2C%20and%20encryption.%20%20For%20this%20example%2C%20the%20timestamp%20and%20the%20message%20body%20are%20signed%20prior%20to%20encryption.%20%20The%20decryption%20transformation%20is%20not%20needed%20as%20the%20signing%2Fencryption%20order%20is%20specified%20within%20the%20%3Cwsse%3ASecurity%3E%20header.%0A%0A%20%0A%0A(001)%20%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%0A%0A(002)%20%3CS11%3AEnvelope%20xmlns%3AS11%3D%22...%22%20xmlns%3Awsse%3D%22...%22%20xmlns%3Awsu%3D%22...%22%20xmlns%3Axenc%3D%22...%22%20xmlns%3Ads%3D%22...%22%3E%0A%0A(003)%20%20%20%3CS11%3AHeader%3E%0A%0A(004)%20%20%20%20%20%20%3Cwsse%3ASecurity%3E%0A%0A(005)%20%20%20%20%20%20%20%20%20%3Cwsu%3ATimestamp%20wsu%3AId%3D%22T0%22%3E%0A%0A(006)%20%20%20%20%20%20%20%20%20%20%20%3Cwsu%3ACreated%3E%0A(007)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202001-09-13T08%3A42%3A00Z%3C%2Fwsu%3ACreated%3E%0A%0A(008)%20%20%20%20%20%20%20%20%20%3C%2Fwsu%3ATimestamp%3E%0A%0A(009)%0A%0A(010)%20%20%20%20%20%20%20%20%20%3Cwsse%3ABinarySecurityToken%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ValueType%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-x509-token-profile-1.0%23X509v3%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wsu%3AId%3D%22X509Token%22%20%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20EncodingType%3D%22...%23Base64Binary%22%3E%0A%0A(011)%20%20%20%20%20%20%20%20%20MIIEZzCCA9CgAwIBAgIQEmtJZc0rqrKh5i...%0A%0A(012)%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ABinarySecurityToken%3E%0A%0A(013)%20%20%20%20%20%20%20%20%20%3Cxenc%3AEncryptedKey%3E%0A%0A(014)%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3AEncryptionMethod%20Algorithm%3D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22http%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmlenc%23rsa-1_5%22%2F%3E%0A%0A(015)%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AKeyInfo%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3ASecurityTokenReference%3E%0A%0A(016)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3AKeyIdentifier%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20EncodingType%3D%22...%23Base64Binary%22%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20ValueType%3D%22http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-x509-token-profile-1.0%23X509v3%22%3EMIGfMa0GCSq...%0A%0A(017)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3AKeyIdentifier%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A(018)%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AKeyInfo%3E%0A%0A(019)%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherData%3E%0A%0A(020)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherValue%3Ed2FpbmdvbGRfE0lm4byV0...%0A%0A(021)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3ACipherValue%3E%0A%0A(022)%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3ACipherData%3E%0A%0A(023)%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3AReferenceList%3E%0A%0A(024)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ADataReference%20URI%3D%22%23enc1%22%2F%3E%0A%0A(025)%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3AReferenceList%3E%0A%0A(026)%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3AEncryptedKey%3E%0A%0A(027)%20%20%20%20%20%20%20%20%20%3Cds%3ASignature%3E%0A%0A(028)%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignedInfo%3E%0A%0A(029)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ACanonicalizationMethod%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2F10%2Fxml-exc-c14n%23%22%2F%3E%0A%0A(030)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignatureMethod%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23rsa-sha1%22%2F%3E%0A%0A(031)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AReference%20URI%3D%22%23T0%22%3E%0A%0A(032)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ATransforms%3E%0A%0A(033)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ATransform%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2F10%2Fxml-exc-c14n%23%22%2F%3E%0A%0A(034)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ATransforms%3E%0A%0A(035)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestMethod%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23sha1%22%2F%3E%0A%0A(036)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestValue%3ELyLsF094hPi4wPU...%0A%0A(037)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ADigestValue%3E%0A%0A(038)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AReference%3E%0A%0A(039)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AReference%20URI%3D%22%23body%22%3E%0A%0A(040)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ATransforms%3E%0A%0A(041)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ATransform%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2F10%2Fxml-exc-c14n%23%22%2F%3E%0A%0A(042)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ATransforms%3E%0A%0A(043)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestMethod%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2F09%2Fxmldsig%23sha1%22%2F%3E%0A%0A(044)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ADigestValue%3ELyLsF094hPi4wPU...%0A%0A(045)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ADigestValue%3E%0A%0A(046)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AReference%3E%0A%0A(047)%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignedInfo%3E%0A%0A(048)%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3ASignatureValue%3E%0A%0A(049)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Hp1ZkmFZ%2F2kQLXDJbchm5gK...%0A%0A(050)%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignatureValue%3E%0A%0A(051)%20%20%20%20%20%20%20%20%20%20%20%20%3Cds%3AKeyInfo%3E%0A%0A(052)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3ASecurityTokenReference%3E%0A%0A(053)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cwsse%3AReference%20URI%3D%22%23X509Token%22%2F%3E%0A%0A(054)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fwsse%3ASecurityTokenReference%3E%0A%0A(055)%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fds%3AKeyInfo%3E%0A%0A(056)%20%20%20%20%20%20%20%20%20%3C%2Fds%3ASignature%3E%0A%0A(057)%20%20%20%20%20%20%3C%2Fwsse%3ASecurity%3E%0A%0A(058)%20%20%20%3C%2FS11%3AHeader%3E%0A%0A(059)%20%20%20%3CS11%3ABody%20wsu%3AId%3D%22body%22%3E%0A%0A(060)%20%20%20%20%20%20%3Cxenc%3AEncryptedData%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Type%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmlenc%23Element%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20wsu%3AId%3D%22enc1%22%3E%0A%0A(061)%20%20%20%20%20%20%20%20%20%3Cxenc%3AEncryptionMethod%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20Algorithm%3D%22http%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmlenc%23tripledes-cbc%22%2F%3E%0A%0A(062)%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherData%3E%0A%0A(063)%20%20%20%20%20%20%20%20%20%20%20%20%3Cxenc%3ACipherValue%3Ed2FpbmdvbGRfE0lm4byV0...%0A%0A(064)%20%20%20%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3ACipherValue%3E%0A%0A(065)%20%20%20%20%20%20%20%20%20%3C%2Fxenc%3ACipherData%3E%0A%0A(066)%20%20%20%20%20%20%3C%2Fxenc%3AEncryptedData%3E%0A%0A(067)%20%20%20%3C%2FS11%3ABody%3E%0A%0A(068)%20%3C%2FS11%3AEnvelope%3E%0A%0A%20%0A%0ALet%27s%20review%20some%20of%20the%20key%20sections%20of%20this%20example%3A%0A%0ALines%20(003)-(058)%20contain%20the%20SOAP%20message%20headers.%20%0A%0A%20%0A%0ALines%20(004)-(057)%20represent%20the%20%3Cwsse%3ASecurity%3E%20header%20block.%20%20This%20contains%20the%20security-related%20information%20for%20the%20message.%0A%0A%20%0A%0ALines%20(005)-(008)%20specify%20the%20timestamp%20information.%20%20In%20this%20case%20it%20indicates%20the%20creation%20time%20of%20the%20security%20semantics.%0A%0A%20%0A%0ALines%20(010)-(012)%20specify%20a%20security%20token%20that%20is%20associated%20with%20the%20message.%20%20In%20this%20case%2C%20it%20specifies%20an%20X.509%20certificate%20that%20is%20encoded%20as%20Base64.%20%20Line%20(011)%20specifies%20the%20actual%20Base64%20encoding%20of%20the%20certificate.%0A%0A%20%0A%0ALines%20(013)-(026)%20specify%20the%20key%20that%20is%20used%20to%20encrypt%20the%20body%20of%20the%20message.%20%20Since%20this%20is%20a%20symmetric%20key%2C%20it%20is%20passed%20in%20an%20encrypted%20form.%20%20Line%20(014)%20defines%20the%20algorithm%20used%20to%20encrypt%20the%20key.%20%20Lines%20(015)-(018)%20specify%20the%20identifier%20of%20the%20key%20that%20was%20used%20to%20encrypt%20the%20symmetric%20key.%20%20Lines%20(019)-(022)%20specify%20the%20actual%20encrypted%20form%20of%20the%20symmetric%20key.%20%20Lines%20(023)-(025)%20identify%20the%20encryption%20block%20in%20the%20message%20that%20uses%20this%20symmetric%20key.%20%20In%20this%20case%20it%20is%20only%20used%20to%20encrypt%20the%20body%20(Id%3D%22enc1%22).%0A%0A%20%0A%0ALines%20(027)-(056)%20specify%20the%20digital%20signature.%20%20In%20this%20example%2C%20the%20signature%20is%20based%20on%20the%20X.509%20certificate.%20%20Lines%20(028)-(047)%20indicate%20what%20is%20being%20signed.%20%20Specifically%2C%20line%20(039)%20references%20the%20message%20body.%0A%0A%20%0A%0ALines%20(048)-(050)%20indicate%20the%20actual%20signature%20value%20%E2%80%93%20specified%20in%20Line%20(043).%0A%0A%20%0A%0ALines%20(052)-(054)%20indicate%20the%20key%20that%20was%20used%20for%20the%20signature.%20%20In%20this%20case%2C%20it%20is%20the%20X.509%20certificate%20included%20in%20the%20message.%20%20Line%20(053)%20provides%20a%20URI%20link%20to%20the%20Lines%20(010)-(012).%0A%0AThe%20body%20of%20the%20message%20is%20represented%20by%20Lines%20(059)-(067).%20%0A%0A%20%0A%0ALines%20(060)-(066)%20represent%20the%20encrypted%20metadata%20and%20form%20of%20the%20body%20using%20XML%20Encryption.%20%20Line%20(060)%20indicates%20that%20the%20%22element%20value%22%20is%20being%20replaced%20and%20identifies%20this%20encryption.%20%20Line%20(061)%20specifies%20the%20encryption%20algorithm%20%E2%80%93%20Triple-DES%20in%20this%20case.%20%20Lines%20(063)-(064)%20contain%20the%20actual%20cipher%20text%20(i.e.%2C%20the%20result%20of%20the%20encryption).%20%20Note%20that%20we%20don%27t%20include%20a%20reference%20to%20the%20key%20as%20the%20key%20references%20this%20encryption%20%E2%80%93%20Line%20(024).%0A12%20Error%20Handling%0A%0AThere%20are%20many%20circumstances%20where%20an%20error%20can%20occur%20while%20processing%20security%20information.%20%20For%20example%3A%20%0A%0A%20%20%20%20Invalid%20or%20unsupported%20type%20of%20security%20token%2C%20signing%2C%20or%20encryption%0A%20%20%20%20Invalid%20or%20unauthenticated%20or%20unauthenticatable%20security%20token%0A%20%20%20%20Invalid%20signature%0A%20%20%20%20Decryption%20failure%0A%20%20%20%20Referenced%20security%20token%20is%20unavailable%0A%20%20%20%20Unsupported%20namespace%0A%0A%20%0A%0AIf%20a%20service%20does%20not%20perform%20its%20normal%20operation%20because%20of%20the%20contents%20of%20the%20Security%20header%2C%20then%20that%20MAY%20be%20reported%20using%20SOAP%27s%20Fault%20Mechanism.%20This%20specification%20does%20not%20mandate%20that%20faults%20be%20returned%20as%20this%20could%20be%20used%20as%20part%20of%20a%20denial%20of%20service%20or%20cryptographic%20attack.%20We%20combine%20signature%20and%20encryption%20failures%20to%20mitigate%20certain%20types%20of%20attacks.%0A%0A%20%0A%0AIf%20a%20failure%20is%20returned%20to%20a%20producer%20then%20the%20failure%20MUST%20be%20reported%20using%20the%20SOAP%20Fault%20mechanism.%20%20The%20following%20tables%20outline%20the%20predefined%20security%20fault%20codes.%20%20The%20%22unsupported%22%20classes%20of%20errors%20are%20as%20follows.%20%20Note%20that%20the%20reason%20text%20provided%20below%20is%20RECOMMENDED%2C%20but%20alternative%20text%20MAY%20be%20provided%20if%20more%20descriptive%20or%20preferred%20by%20the%20implementation.%20%20The%20tables%20below%20are%20defined%20in%20terms%20of%20SOAP%201.1.%20%20For%20SOAP%201.2%2C%20the%20Fault%2FCode%2FValue%20is%20env%3ASender%20(as%20defined%20in%20SOAP%201.2)%20and%20the%20Fault%2FCode%2FSubcode%2FValue%20is%20the%20faultcode%20below%20and%20the%20Fault%2FReason%2FText%20is%20the%20faultstring%20below.%0A%0A%20%0A%0AError%20that%20occurred%20(faultstring)%0A%09%0A%0Afaultcode%0A%0AAn%20unsupported%20token%20was%20provided%0A%09%0A%0Awsse%3AUnsupportedSecurityToken%0A%0AAn%20unsupported%20signature%20or%20encryption%20algorithm%20was%20used%0A%09%0A%0Awsse%3AUnsupportedAlgorithm%0A%0A%20%0A%0AThe%20%22failure%22%20class%20of%20errors%20are%3A%0A%0A%20%0A%0AError%20that%20occurred%20(faultstring)%0A%09%0A%0Afaultcode%0A%0AAn%20error%20was%20discovered%20processing%20the%20%3Cwsse%3ASecurity%3E%20header.%0A%09%0A%0Awsse%3AInvalidSecurity%0A%0AAn%20invalid%20security%20token%20was%20provided%0A%09%0A%0Awsse%3AInvalidSecurityToken%0A%0AThe%20security%20token%20could%20not%20be%20authenticated%20or%20authorized%0A%09%0A%0Awsse%3AFailedAuthentication%0A%0AThe%20signature%20or%20decryption%20was%20invalid%0A%09%0A%0Awsse%3AFailedCheck%0A%0AReferenced%20security%20token%20could%20not%20be%20retrieved%0A%09%0A%0Awsse%3ASecurityTokenUnavailable%0A%0AThe%20message%20has%20expired%0A%09%0A%0Awsse%3AMessageExpired%0A%0A%20%0A13%20Security%20Considerations%0A%0AAs%20stated%20in%20the%20Goals%20and%20Requirements%20section%20of%20this%20document%2C%20this%20specification%20is%20meant%20to%20provide%20extensible%20framework%20and%20flexible%20syntax%2C%20with%20which%20one%20could%20implement%20various%20security%20mechanisms.%20This%20framework%20and%20syntax%20by%20itself%20does%20not%20provide%20any%20guarantee%20of%20security.%20When%20implementing%20and%20using%20this%20framework%20and%20syntax%2C%20one%20must%20make%20every%20effort%20to%20ensure%20that%20the%20result%20is%20not%20vulnerable%20to%20any%20one%20of%20a%20wide%20range%20of%20attacks.%0A13.1%20General%20Considerations%0A%0AIt%20is%20not%20feasible%20to%20provide%20a%20comprehensive%20list%20of%20security%20considerations%20for%20such%20an%20extensible%20set%20of%20mechanisms.%20A%20complete%20security%20analysis%20MUST%20be%20conducted%20on%20specific%20solutions%20based%20on%20this%20specification.%20Below%20we%20illustrate%20some%20of%20the%20security%20concerns%20that%20often%20come%20up%20with%20protocols%20of%20this%20type%2C%20but%20we%20stress%20that%20this%20is%20not%20an%20exhaustive%20list%20of%20concerns.%0A%0A%20%20%20%20freshness%20guarantee%20(e.g.%2C%20the%20danger%20of%20replay%2C%20delayed%20messages%20and%20the%20danger%20of%20relying%20on%20timestamps%20assuming%20secure%20clock%20synchronization)%0A%20%20%20%20proper%20use%20of%20digital%20signature%20and%20encryption%20(signing%2Fencrypting%20critical%20parts%20of%20the%20message%2C%20interactions%20between%20signatures%20and%20encryption)%2C%20i.e.%2C%20signatures%20on%20(content%20of)%20encrypted%20messages%20leak%20information%20when%20in%20plain-text)%0A%20%20%20%20protection%20of%20security%20tokens%20(integrity)%0A%20%20%20%20certificate%20verification%20(including%20revocation%20issues)%0A%20%20%20%20the%20danger%20of%20using%20passwords%20without%20outmost%20protection%20(i.e.%20dictionary%20attacks%20against%20passwords%2C%20%20replay%2C%20insecurity%20of%20password%20derived%20keys%2C%20...)%0A%20%20%20%20the%20use%20of%20randomness%20(or%20strong%20pseudo-randomness)%0A%20%20%20%20interaction%20between%20the%20security%20mechanisms%20implementing%20this%20standard%20and%20other%20system%20component%0A%20%20%20%20man-in-the-middle%20attacks%0A%20%20%20%20PKI%20attacks%20(i.e.%20identity%20mix-ups)%0A%0A%20%0A%0AThere%20are%20other%20security%20concerns%20that%20one%20may%20need%20to%20consider%20in%20security%20protocols.%20The%20list%20above%20should%20not%20be%20used%20as%20a%20%22check%20list%22%20instead%20of%20a%20comprehensive%20security%20analysis.%20The%20next%20section%20will%20give%20a%20few%20details%20on%20some%20of%20the%20considerations%20in%20this%20list.%0A13.2%20Additional%20Considerations%0A13.2.1%20Replay%0A%0ADigital%20signatures%20alone%20do%20not%20provide%20message%20authentication.%20One%20can%20record%20a%20signed%20message%20and%20resend%20it%20(a%20replay%20attack).It%20is%20strongly%20RECOMMENDED%20that%20messages%20include%20digitally%20signed%20elements%20to%20allow%20message%20recipients%20to%20detect%20replays%20of%20the%20message%20when%20the%20messages%20are%20exchanged%20via%20an%20open%20network.%20%20These%20can%20be%20part%20of%20the%20message%20or%20of%20the%20headers%20defined%20from%20other%20SOAP%20extensions.%20%20Four%20typical%20approaches%20are%3A%20Timestamp%2C%20Sequence%20Number%2C%20Expirations%20and%20Message%20Correlation.%20Signed%20timestamps%20MAY%20be%20used%20to%20keep%20track%20of%20messages%20(possibly%20by%20caching%20the%20most%20recent%20timestamp%20from%20a%20specific%20service)%20and%20detect%20replays%20of%20previous%20messages.%20%20It%20is%20RECOMMENDED%20that%20timestamps%20be%20cached%20for%20a%20given%20period%20of%20time%2C%20as%20a%20guideline%2C%20a%20value%20of%20five%20minutes%20can%20be%20used%20as%20a%20minimum%20to%20detect%20replays%2C%20and%20that%20timestamps%20older%20than%20that%20given%20period%20of%20time%20set%20be%20rejected%20in%20interactive%20scenarios.%0A13.2.2%20Combining%20Security%20Mechanisms%0A%0AThis%20specification%20defines%20the%20use%20of%20XML%20Signature%20and%20XML%20Encryption%20in%20SOAP%20headers.%20As%20one%20of%20the%20building%20blocks%20for%20securing%20SOAP%20messages%2C%20it%20is%20intended%20to%20be%20used%20in%20conjunction%20with%20other%20security%20techniques.%20Digital%20signatures%20need%20to%20be%20understood%20in%20the%20context%20of%20other%20security%20mechanisms%20and%20possible%20threats%20to%20an%20entity.%0A%0A%20%0A%0AImplementers%20should%20also%20be%20aware%20of%20all%20the%20security%20implications%20resulting%20from%20the%20use%20of%20digital%20signatures%20in%20general%20and%20XML%20Signature%20in%20particular.%20%20When%20building%20trust%20into%20an%20application%20based%20on%20a%20digital%20signature%20there%20are%20other%20technologies%2C%20such%20as%20certificate%20evaluation%2C%20that%20must%20be%20incorporated%2C%20but%20these%20are%20outside%20the%20scope%20of%20this%20document.%0A%0A%20%0A%0AAs%20described%20in%20XML%20Encryption%2C%20the%20combination%20of%20signing%20and%20encryption%20over%20a%20common%20data%20item%20may%20introduce%20some%20cryptographic%20vulnerability.%20For%20example%2C%20encrypting%20digitally%20signed%20data%2C%20while%20leaving%20the%20digital%20signature%20in%20the%20clear%2C%20may%20allow%20plain%20text%20guessing%20attacks.%0A13.2.3%20Challenges%0A%0AWhen%20digital%20signatures%20are%20used%20for%20verifying%20the%20claims%20pertaining%20to%20the%20sending%20entity%2C%20the%20producer%20must%20demonstrate%20knowledge%20of%20the%20confirmation%20key.%20%20One%20way%20to%20achieve%20this%20is%20to%20use%20a%20challenge-response%20type%20of%20protocol.%20%20Such%20a%20protocol%20is%20outside%20the%20scope%20of%20this%20document.%0A%0ATo%20this%20end%2C%20the%20developers%20can%20attach%20timestamps%2C%20expirations%2C%20and%20sequences%20to%20messages.%0A13.2.4%20Protecting%20Security%20Tokens%20and%20Keys%0A%0AImplementers%20should%20be%20aware%20of%20the%20possibility%20of%20a%20token%20substitution%20attack.%20In%20any%20situation%20where%20a%20digital%20signature%20is%20verified%20by%20reference%20to%20a%20token%20provided%20in%20the%20message%2C%20which%20specifies%20the%20key%2C%20it%20may%20be%20possible%20for%20an%20unscrupulous%20producer%20to%20later%20claim%20that%20a%20different%20token%2C%20containing%20the%20same%20key%2C%20but%20different%20information%20was%20intended.%0A%0AAn%20example%20of%20this%20would%20be%20a%20user%20who%20had%20multiple%20X.509%20certificates%20issued%20relating%20to%20the%20same%20key%20pair%20but%20with%20different%20attributes%2C%20constraints%20or%20reliance%20limits.%20Note%20that%20the%20signature%20of%20the%20token%20by%20its%20issuing%20authority%20does%20not%20prevent%20this%20attack.%20Nor%20can%20an%20authority%20effectively%20prevent%20a%20different%20authority%20from%20issuing%20a%20token%20over%20the%20same%20key%20if%20the%20user%20can%20prove%20possession%20of%20the%20secret.%0A%0A%20%0A%0AThe%20most%20straightforward%20counter%20to%20this%20attack%20is%20to%20insist%20that%20the%20token%20(or%20its%20unique%20identifying%20data)%20be%20included%20under%20the%20signature%20of%20the%20producer.%20If%20the%20nature%20of%20the%20application%20is%20such%20that%20the%20contents%20of%20the%20token%20are%20irrelevant%2C%20assuming%20it%20has%20been%20issued%20by%20a%20trusted%20authority%2C%20this%20attack%20may%20be%20ignored.%20However%20because%20application%20semantics%20may%20change%20over%20time%2C%20best%20practice%20is%20to%20prevent%20this%20attack.%0A%0A%20%0A%0ARequestors%20should%20use%20digital%20signatures%20to%20sign%20security%20tokens%20that%20do%20not%20include%20signatures%20(or%20other%20protection%20mechanisms)%20to%20ensure%20that%20they%20have%20not%20been%20altered%20in%20transit.%20It%20is%20strongly%20RECOMMENDED%20that%20all%20relevant%20and%20immutable%20message%20content%20be%20signed%20by%20the%20producer.%20Receivers%20SHOULD%20only%20consider%20those%20portions%20of%20the%20document%20that%20are%20covered%20by%20the%20producer%E2%80%99s%20signature%20as%20being%20subject%20to%20the%20security%20tokens%20in%20the%20message.%20Security%20tokens%20appearing%20in%20%3Cwsse%3ASecurity%3E%20header%20elements%20SHOULD%20be%20signed%20by%20their%20issuing%20authority%20so%20that%20message%20receivers%20can%20have%20confidence%20that%20the%20security%20tokens%20have%20not%20been%20forged%20or%20altered%20since%20their%20issuance.%20It%20is%20strongly%20RECOMMENDED%20that%20a%20message%20producer%20sign%20any%20%3Cwsse%3ASecurityToken%3E%20elements%20that%20it%20is%20confirming%20and%20that%20are%20not%20signed%20by%20their%20issuing%20authority.%0A%0AWhen%20a%20requester%20provides%2C%20within%20the%20request%2C%20a%20Public%20Key%20to%20be%20used%20to%20encrypt%20the%20response%2C%20it%20is%20possible%20that%20an%20attacker%20in%20the%20middle%20may%20substitute%20a%20different%20Public%20Key%2C%20thus%20allowing%20the%20attacker%20to%20read%20the%20response.%20The%20best%20way%20to%20prevent%20this%20attack%20is%20to%20bind%20the%20encryption%20key%20in%20some%20way%20to%20the%20request.%20One%20simple%20way%20of%20doing%20this%20is%20to%20use%20the%20same%20key%20pair%20to%20sign%20the%20request%20as%20to%20encrypt%20the%20response.%20However%2C%20if%20policy%20requires%20the%20use%20of%20distinct%20key%20pairs%20for%20signing%20and%20encryption%2C%20then%20the%20Public%20Key%20provided%20in%20the%20request%20should%20be%20included%20under%20the%20signature%20of%20the%20request.%0A13.2.5%20Protecting%20Timestamps%20and%20Ids%0A%0AIn%20order%20to%20trust%20wsu%3AId%20attributes%20and%20%3Cwsu%3ATimestamp%3E%20elements%2C%20they%20SHOULD%20be%20signed%20using%20the%20mechanisms%20outlined%20in%20this%20specification.%20%20This%20allows%20readers%20of%20the%20IDs%20and%20timestamps%20information%20to%20be%20certain%20that%20the%20IDs%20and%20timestamps%20haven%E2%80%99t%20been%20forged%20or%20altered%20in%20any%20way.%20%20It%20is%20strongly%20RECOMMENDED%20that%20IDs%20and%20timestamp%20elements%20be%20signed.%0A13.2.6%20Protecting%20against%20removal%20and%20modification%20of%20XML%20Elements%0A%0AXML%20Signatures%20using%20Shorthand%20XPointer%20References%20(AKA%20IDREF)%20protect%20against%20the%20removal%20and%20modification%20of%20XML%20elements%3B%20but%20do%20not%20protect%20the%20location%20of%20the%20element%20within%20the%20XML%20Document.%0A%0A%20%0A%0AWhether%20or%20not%20this%20is%20a%20security%20vulnerability%20depends%20on%20whether%20the%20location%20of%20the%20signed%20data%20within%20its%20surrounding%20context%20has%20any%20semantic%20import.%20This%20consideration%20applies%20to%20data%20carried%20in%20the%20SOAP%20Body%20or%20the%20Header.%0A%0A%20%0A%0AOf%20particular%20concern%20is%20the%20ability%20to%20relocate%20signed%20data%20into%20a%20SOAP%20Header%20block%20which%20is%20unknown%20to%20the%20receiver%20and%20marked%20mustUnderstand%3D%22false%22.%20This%20could%20have%20the%20effect%20of%20causing%20the%20receiver%20to%20ignore%20signed%20data%20which%20the%20sender%20expected%20would%20either%20be%20processed%20or%20result%20in%20the%20generation%20of%20a%20MustUnderstand%20fault.%0A%0A%20%0A%0AA%20similar%20exploit%20would%20involve%20relocating%20signed%20data%20into%20a%20SOAP%20Header%20block%20targeted%20to%20a%20S11%3Aactor%20or%20S12%3Arole%20other%20than%20that%20which%20the%20sender%20intended%2C%20and%20which%20the%20receiver%20will%20not%20process.%0A%0A%20%0A%0AWhile%20these%20attacks%20could%20apply%20to%20any%20portion%20of%20the%20message%2C%20their%20effects%20are%20most%20pernicious%20with%20SOAP%20header%20elements%20which%20may%20not%20always%20be%20present%2C%20but%20must%20be%20processed%20whenever%20they%20appear.%0A%0A%20%0A%0AIn%20the%20general%20case%20of%20XML%20Documents%20and%20Signatures%2C%20this%20issue%20may%20be%20resolved%20by%20signing%20the%20entire%20XML%20Document%20and%2For%20strict%20XML%20Schema%20specification%20and%20enforcement.%20However%2C%20because%20elements%20of%20the%20SOAP%20message%2C%20particularly%20header%20elements%2C%20may%20be%20legitimately%20modified%20by%20SOAP%20intermediaries%2C%20this%20approach%20is%20usually%20not%20appropriate.%20It%20is%20RECOMMENDED%20that%20applications%20signing%20any%20part%20of%20the%20SOAP%20body%20sign%20the%20entire%20body.%0A%0A%20%0A%0AAlternatives%20countermeasures%20include%20(but%20are%20not%20limited%20to)%3A%0A%0A%20%20%20%20References%20using%20XPath%20transforms%20with%20Absolute%20Path%20expressions%20with%20checks%20performed%20by%20the%20receiver%20that%20the%20URI%20and%20Absolute%20Path%20XPath%20expression%20evaluate%20to%20the%20digested%20nodeset.%0A%20%20%20%20A%20Reference%20using%20an%20XPath%20transform%20to%20include%20any%20significant%20location-dependent%20elements%20and%20exclude%20any%20elements%20that%20might%20legitimately%20be%20removed%2C%20added%2C%20or%20altered%20by%20intermediaries%2C%0A%20%20%20%20Using%20only%20References%20to%20elements%20with%20location-independent%20semantics%2C%0A%20%20%20%20Strict%20policy%20specification%20and%20enforcement%20regarding%20which%20message%20parts%20are%20to%20be%20signed.%20For%20example%3A%0A%20%20%20%20%20%20%20%20Requiring%20that%20the%20entire%20SOAP%20Body%20and%20all%20children%20of%20SOAP%20Header%20be%20signed%2C%0A%20%20%20%20%20%20%20%20Requiring%20that%20SOAP%20header%20elements%20which%20are%20marked%20MustUnderstand%3D%22false%22%20and%20have%20signed%20descendants%20MUST%20include%20the%20MustUnderstand%20attribute%20under%20the%20signature.%0A%0A%20%0A13.2.7%20Detecting%20Duplicate%20Identifiers%0A%0AThe%20%3Cwsse%3ASecurity%3E%20processing%20SHOULD%20check%20for%20duplicate%20values%20from%20among%20the%20set%20of%20ID%20attributes%20that%20it%20is%20aware%20of.%20%20The%20wsse%3ASecurity%20processing%20MUST%20generate%20a%20fault%20if%20a%20duplicate%20ID%20value%20is%20detected.%0A%0A%20%0A%0AThis%20section%20is%20non-normative.%0A14%20Interoperability%20Notes%0A%0ABased%20on%20interoperability%20experiences%20with%20this%20and%20similar%20specifications%2C%20the%20following%20list%20highlights%20several%20common%20areas%20where%20interoperability%20issues%20have%20been%20discovered.%20%20Care%20should%20be%20taken%20when%20implementing%20to%20avoid%20these%20issues.%20%20It%20should%20be%20noted%20that%20some%20of%20these%20may%20seem%20%22obvious%22%2C%20but%20have%20been%20problematic%20during%20testing.%0A%0A%20%0A%0A%20%20%20%20Key%20Identifiers%3A%20Make%20sure%20you%20understand%20the%20algorithm%20and%20how%20it%20is%20applied%20to%20security%20tokens.%0A%20%20%20%20EncryptedKey%3A%20The%20%3Cxenc%3AEncryptedKey%3E%20element%20from%20XML%20Encryption%20requires%20a%20Type%20attribute%20whose%20value%20is%20one%20of%20a%20pre-defined%20list%20of%20values.%20Ensure%20that%20a%20correct%20value%20is%20used.%0A%20%20%20%20Encryption%20Padding%3A%20The%20XML%20Encryption%20random%20block%20cipher%20padding%20has%20caused%20issues%20with%20certain%20decryption%20implementations%3B%20be%20careful%20to%20follow%20the%20specifications%20exactly.%0A%20%20%20%20IDs%3A%20The%20specification%20recognizes%20three%20specific%20ID%20elements%3A%20the%20global%20wsu%3AId%20attribute%20and%20the%20local%20ID%20attributes%20on%20XML%20Signature%20and%20XML%20Encryption%20elements%20(because%20the%20latter%20two%20do%20not%20allow%20global%20attributes).%20%20If%20any%20other%20element%20does%20not%20allow%20global%20attributes%2C%20it%20cannot%20be%20directly%20signed%20using%20an%20ID%20reference.%20%20Note%20that%20the%20global%20attribute%20wsu%3AId%20MUST%20carry%20the%20namespace%20specification.%0A%20%20%20%20Time%20Formats%3A%20This%20specification%20uses%20a%20restricted%20version%20of%20the%20XML%20Schema%20xsd%3AdateTime%20element.%20%20Take%20care%20to%20ensure%20compliance%20with%20the%20specified%20restrictions.%0A%20%20%20%20Byte%20Order%20Marker%20(BOM)%3A%20Some%20implementations%20have%20problems%20processing%20the%20BOM%20marker.%20%20It%20is%20suggested%20that%20usage%20of%20this%20be%20optional.%0A%20%20%20%20SOAP%2C%20WSDL%2C%20HTTP%3A%20Various%20interoperability%20issues%20have%20been%20seen%20with%20incorrect%20SOAP%2C%20WSDL%2C%20and%20HTTP%20semantics%20being%20applied.%20%20Care%20should%20be%20taken%20to%20carefully%20adhere%20to%20these%20specifications%20and%20any%20interoperability%20guidelines%20that%20are%20available.%0A%0A%20%0A%0AThis%20section%20is%20non-normative.%0A15%20Privacy%20Considerations%0A%0AIn%20the%20context%20of%20this%20specification%2C%20we%20are%20only%20concerned%20with%20potential%20privacy%20violation%20by%20the%20security%20elements%20defined%20here.%20Privacy%20of%20the%20content%20of%20the%20payload%20message%20is%20out%20of%20scope.%0A%0AProducers%20or%20sending%20applications%20should%20be%20aware%20that%20claims%2C%20as%20collected%20in%20security%20tokens%2C%20are%20typically%20personal%20information%2C%20and%20should%20thus%20only%20be%20sent%20according%20to%20the%20producer%27s%20privacy%20policies.%20Future%20standards%20may%20allow%20privacy%20obligations%20or%20restrictions%20to%20be%20added%20to%20this%20data.%20Unless%20such%20standards%20are%20used%2C%20the%20producer%20must%20ensure%20by%20out-of-band%20means%20that%20the%20recipient%20is%20bound%20to%20adhering%20to%20all%20restrictions%20associated%20with%20the%20data%2C%20and%20the%20recipient%20must%20similarly%20ensure%20by%20out-of-band%20means%20that%20it%20has%20the%20necessary%20consent%20for%20its%20intended%20processing%20of%20the%20data.%0A%0A%20%0A%0AIf%20claim%20data%20are%20visible%20to%20intermediaries%2C%20then%20the%20policies%20must%20also%20allow%20the%20release%20to%20these%20intermediaries.%20As%20most%20personal%20information%20cannot%20be%20released%20to%20arbitrary%20parties%2C%20this%20will%20typically%20require%20that%20the%20actors%20are%20referenced%20in%20an%20identifiable%20way%3B%20such%20identifiable%20references%20are%20also%20typically%20needed%20to%20obtain%20appropriate%20encryption%20keys%20for%20the%20intermediaries.%20%0A%0AIf%20intermediaries%20add%20claims%2C%20they%20should%20be%20guided%20by%20their%20privacy%20policies%20just%20like%20the%20original%20producers.%0A%0A%20%0A%0AIntermediaries%20may%20also%20gain%20traffic%20information%20from%20a%20SOAP%20message%20exchange%2C%20e.g.%2C%20who%20communicates%20with%20whom%20at%20what%20time.%20Producers%20that%20use%20intermediaries%20should%20verify%20that%20releasing%20this%20traffic%20information%20to%20the%20chosen%20intermediaries%20conforms%20to%20their%20privacy%20policies.%0A%0A%20%0A%0AThis%20section%20is%20non-normative.%0A16%20References%0A%0A%5BGLOSS%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Informational%20RFC%202828%2C%20%22Internet%20Security%20Glossary%2C%22%20May%202000.%0A%0A%5BKERBEROS%5D%20%20%20%20%20%20%20%20%20%20J.%20Kohl%20and%20C.%20Neuman%2C%20%22The%20Kerberos%20Network%20Authentication%20Service%20(V5)%2C%22%20RFC%201510%2C%20September%201993%2C%20http%3A%2F%2Fwww.ietf.org%2Frfc%2Frfc1510.txt%20.%0A%0A%5BKEYWORDS%5D%20%20%20%20%20%20%20%20%20S.%20Bradner%2C%20%22Key%20words%20for%20use%20in%20RFCs%20to%20Indicate%20Requirement%20Levels%2C%22%20RFC%202119%2C%20Harvard%20University%2C%20March%201997.%0A%0A%5BSHA-1%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20FIPS%20PUB%20180-1.%20%20Secure%20Hash%20Standard.%20U.S.%20Department%20of%20Commerce%20%2F%20National%20Institute%20of%20Standards%20and%20Technology.%20%20http%3A%2F%2Fwww.itl.nist.gov%2Ffipspubs%2Ffip180-1.htm%0A%0A%5BSOAP11%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Note%2C%20%22SOAP%3A%20Simple%20Object%20Access%20Protocol%201.1%2C%22%2008%20May%202000.%0A%0A%5BSOAP12%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Recommendation%2C%20%22SOAP%20Version%201.2%20Part%201%3A%20Messaging%20Framework%22%2C%2023%20June%202003.%0A%0A%5BSOAPSEC%5D%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Note%2C%20%22SOAP%20Security%20Extensions%3A%20Digital%20Signature%2C%22%2006%20February%202001.%0A%0A%5BURI%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20T.%20Berners-Lee%2C%20R.%20Fielding%2C%20L.%20Masinter%2C%20%22Uniform%20Resource%20Identifiers%20(URI)%3A%20Generic%20Syntax%2C%22%20RFC%203986%2C%20MIT%2FLCS%2C%20Day%20Software%2C%20Adobe%20Systems%2C%20January%202005.%0A%0A%5BXPATH%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Recommendation%2C%20%22XML%20Path%20Language%22%2C%2016%20November%201999%0A%0A%20%0A%0AThe%20following%20are%20non-normative%20references%20included%20for%20background%20and%20related%20material%3A%0A%0A%5BWS-SECURITY%5D%20%20%20%20%20%22Web%20Services%20Security%20Language%22%2C%20IBM%2C%20Microsoft%2C%20VeriSign%2C%20April%202002.%0A%22WS-Security%20Addendum%22%2C%20IBM%2C%20Microsoft%2C%20VeriSign%2C%20August%202002.%0A%22WS-Security%20XML%20Tokens%22%2C%20IBM%2C%20Microsoft%2C%20VeriSign%2C%20August%202002.%0A%0A%5BXMLC14N%5D%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Recommendation%2C%20%22Canonical%20XML%20Version%201.0%2C%22%2015%20March%202001.%0A%0A%5BEXCC14N%5D%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Recommendation%2C%20%22Exclusive%20XML%20Canonicalization%20Version%201.0%2C%22%208%20July%202002.%0A%0A%5BXMLENC%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Working%20Draft%2C%20%22XML%20Encryption%20Syntax%20and%20Processing%2C%22%2004%20March%202002.%0A%0AW3C%20Recommendation%2C%20%E2%80%9CDecryption%20Transform%20for%20XML%20Signature%E2%80%9D%2C%2010%20December%202002.%0A%0A%5BXML-ns%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Recommendation%2C%20%22Namespaces%20in%20XML%2C%22%2014%20January%201999.%0A%0A%5BXMLSCHEMA%5D%20%20%20%20%20%20%20W3C%20Recommendation%2C%20%22XML%20Schema%20Part%201%3A%20Structures%2C%222%20May%202001.%0AW3C%20Recommendation%2C%20%22XML%20Schema%20Part%202%3A%20Datatypes%2C%22%202%20May%202001.%0A%0A%5BXMLSIG%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20D.%20Eastlake%2C%20J.%20R.%2C%20D.%20Solo%2C%20M.%20Bartel%2C%20J.%20Boyer%20%2C%20B.%20Fox%20%2C%20E.%20Simon.%20XML-Signature%20Syntax%20and%20Processing%2C%20W3C%20Recommendation%2C%2012%20February%202002.%0A%0A%5BX509%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20S.%20Santesson%2C%20et%20al%2C%22Internet%20X.509%20Public%20Key%20Infrastructure%20Qualified%20Certificates%20Profile%2C%22%20http%3A%2F%2Fwww.itu.int%2Frec%2Frecommendation.asp%3Ftype%3Ditems%26lang%3De%26parent%3DT-REC-X.509-200003-I%0A%0A%5BWSS-SAML%5D%20%20%20%20%20%20%20%20%20%20OASIS%20Working%20Draft%2006%2C%20%22Web%20Services%20Security%20SAML%20Token%20Profile%22%2C%2021%20February%202003%0A%0A%5BWSS-XrML%5D%20%20%20%20%20%20%20%20%20%20%20OASIS%20Working%20Draft%2003%2C%20%22Web%20Services%20Security%20XrML%20Token%20Profile%22%2C%2030%20January%202003%0A%0A%5BWSS-X509%5D%20%20%20%20%20%20%20%20%20%20%20%20OASIS%2C%20%E2%80%9CWeb%20Services%20Security%20X.509%20Certificate%20Token%20Profile%E2%80%9D%2C%2019%20January%202004%2C%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-x509-token-profile-1.0.pdf%0A%0A%5BWSSKERBEROS%5D%20%20OASIS%20Working%20Draft%2003%2C%20%22Web%20Services%20Security%20Kerberos%20Profile%22%2C%2030%20January%202003%0A%0A%5BWSSUSERNAME%5D%20%20OASIS%2C%E2%80%9DWeb%20Services%20Security%20UsernameToken%20Profile%E2%80%9D%2019%20January%202004%2C%20http%3A%2F%2Fdocs.oasis-open.org%2Fwss%2F2004%2F01%2Foasis-200401-wss-username-token-profile-1.0.pdf%0A%0A%5BWSS-XCBF%5D%20%20%20%20%20%20%20%20%20%20%20OASIS%20Working%20Draft%201.1%2C%20%22Web%20Services%20Security%20XCBF%20Token%20Profile%22%2C%2030%20March%202003%0A%0A%5BXMLID%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20W3C%20Recommmendation%2C%20%E2%80%9Cxml%3Aid%20Version%201.0%E2%80%9D%2C%209%20September%202005.%0A%0A%5BXPOINTER%5D%20%20%20%20%20%20%20%20%20%20%20%22XML%20Pointer%20Language%20(XPointer)%20Version%201.0%2C%20Candidate%20Recommendation%22%2C%20DeRose%2C%20Maler%2C%20Daniel%2C%2011%20September%202001.%0A17%20Conformance%0A%0AAn%20implementation%20conforms%20to%20this%20specification%20if%20it%20meets%20the%20requirements%20in%20Sections%202%2C%204%2C%20and%205%20including%20conformance%20to%20the%20enabled%20capabilities%20in%20the%20two%20core%20schemas%20(secext%20and%20utility).%0A%0AA.%20%20Acknowledgements%0A%0AThe%20following%20individuals%20have%20participated%20in%20the%20creation%20of%20this%20specification%20and%20are%20gratefully%20acknowledged%3A%0A%0AParticipants%3A%0A%0ACurrent%20Contributors%3A%0A%0ATom%0A%09%0A%0ARutt%0A%09%0A%0AFujitsu%20Limited%0A%0AJacques%0A%09%0A%0ADurand%0A%09%0A%0AFujitsu%20Limited%0A%0ACalvin%0A%09%0A%0APowers%0A%09%0A%0AIBM%0A%0AKelvin%0A%09%0A%0ALawrence%0A%09%0A%0AIBM%0A%0AMichael%0A%09%0A%0AMcIntosh%0A%09%0A%0AIndividual%0A%0AThomas%0A%09%0A%0AHardjono%0A%09%0A%0AM.I.T.%0A%0ADavid%0A%09%0A%0ATurner%0A%09%0A%0AMicrosoft%20Corporation%0A%0AAnthony%0A%09%0A%0ANadalin%0A%09%0A%0AMicrosoft%20Corporation%0A%0AMonica%0A%09%0A%0AMartin%0A%09%0A%0AMicrosoft%20Corporation%0A%0AMarc%0A%09%0A%0AGoodner%0A%09%0A%0AMicrosoft%20Corporation%0A%0APeter%0A%09%0A%0ADavis%0A%09%0A%0ANeustar%0A%0AHal%0A%09%0A%0ALockhart%0A%09%0A%0AOracle%20Corporation%0A%0ARich%0A%09%0A%0ALevinson%0A%09%0A%0AOracle%20Corporation%0A%0AAnil%0A%09%0A%0ASaldhana%0A%09%0A%0ARed%20Hat%0A%0AMartin%0A%09%0A%0ARaepple%0A%09%0A%0ASAP%20AG%0A%0AFederico%0A%09%0A%0ARossini%0A%09%0A%0ATelecom%20Italia%20S.p.a.%0A%0ACarlo%0A%09%0A%0AMilono%0A%09%0A%0ATIBCO%20Software%20Inc.%0A%0ADon%0A%09%0A%0AAdams%0A%09%0A%0ATIBCO%20Software%20Inc.%0A%0AJerry%0A%09%0A%0ASmith%0A%09%0A%0AUS%20Department%20of%20Defense%20(DoD)%0A%0APrevious%20Contributors%3A%0A%0AMichael%0A%09%0A%0AHu%0A%09%0A%0AActional%0A%0AManeesh%0A%09%0A%0ASahu%0A%09%0A%0AActional%0A%0ADuane%0A%09%0A%0ANickull%0A%09%0A%0AAdobe%20Systems%0A%0AGene%0A%09%0A%0AThurston%0A%09%0A%0AAmberPoint%0A%0AFrank%0A%09%0A%0ASiebenlist%0A%09%0A%0AArgonne%20National%20Laboratory%0A%0APete%0A%09%0A%0ADapkus%0A%09%0A%0ABEA%0A%0AHal%0A%09%0A%0ALockhart%0A%09%0A%0ABEA%20Systems%0A%0ADenis%0A%09%0A%0APilipchuk%0A%09%0A%0ABEA%20Systems%0A%0ACorinna%0A%09%0A%0AWitt%0A%09%0A%0ABEA%20Systems%0A%0ASteve%0A%09%0A%0AAnderson%0A%09%0A%0ABMC%20Software%0A%0ARich%0A%09%0A%0ALevinson%0A%09%0A%0AComputer%20Associates%0A%0AThomas%0A%09%0A%0ADeMartini%0A%09%0A%0AContentGuard%0A%0AGuillermo%0A%09%0A%0ALao%0A%09%0A%0AContentGuard%0A%0ATJ%0A%09%0A%0APannu%0A%09%0A%0AContentGuard%0A%0AXin%0A%09%0A%0AWang%0A%09%0A%0AContentGuard%0A%0AMerlin%0A%09%0A%0AHughes%0A%09%0A%0ACybertrust%0A%0ADale%0A%09%0A%0AMoberg%0A%09%0A%0ACyclone%20Commerce%0A%0AShawn%0A%09%0A%0ASharp%0A%09%0A%0ACyclone%20Commerce%0A%0ARich%0A%09%0A%0ASalz%0A%09%0A%0ADatapower%0A%0AGanesh%0A%09%0A%0AVaideeswaran%0A%09%0A%0ADocumentum%0A%0ASam%0A%09%0A%0AWei%0A%09%0A%0AEMC%0A%0ATim%0A%09%0A%0AMoses%0A%09%0A%0AEntrust%0A%0ACarolina%0A%09%0A%0ACanales-Valenzuela%0A%09%0A%0AEricsson%0A%0ADana%20S.%0A%09%0A%0AKaufman%0A%09%0A%0AForum%20Systems%0A%0AToshihiro%0A%09%0A%0ANishimura%0A%09%0A%0AFujitsu%0A%0ATom%0A%09%0A%0ARutt%0A%09%0A%0AFujitsu%0A%0AKefeng%0A%09%0A%0AChen%0A%09%0A%0AGeoTrust%0A%0AIrving%0A%09%0A%0AReid%0A%09%0A%0AHewlett-Packard%0A%0AKojiro%0A%09%0A%0ANakayama%0A%09%0A%0AHitachi%0A%0AYutaka%0A%09%0A%0AKudo%0A%09%0A%0AHitachi%0A%0AJason%0A%09%0A%0ARouault%0A%09%0A%0AHP%0A%0APaula%0A%09%0A%0AAustel%0A%09%0A%0AIBM%0A%0ADerek%0A%09%0A%0AFu%0A%09%0A%0AIBM%0A%0AMaryann%0A%09%0A%0AHondo%0A%09%0A%0AIBM%0A%0AKelvin%0A%09%0A%0ALawrence%0A%09%0A%0AIBM%0A%0AMichael%0A%09%0A%0AMcIntosh%0A%09%0A%0AIBM%0A%0AAnthony%0A%09%0A%0ANadalin%0A%09%0A%0AIBM%0A%0ANataraj%0A%09%0A%0ANagaratnam%0A%09%0A%0AIBM%0A%0ABruce%0A%09%0A%0ARich%0A%09%0A%0AIBM%0A%0ARon%0A%09%0A%0AWilliams%0A%09%0A%0AIBM%0A%0ABob%0A%09%0A%0ABlakley%0A%09%0A%0AIBM%0A%0AJoel%0A%09%0A%0AFarrell%0A%09%0A%0AIBM%0A%0ASatoshi%0A%09%0A%0AHada%0A%09%0A%0AIBM%0A%0AHiroshi%0A%09%0A%0AMaruyama%0A%09%0A%0AIBM%0A%0ADavid%0A%09%0A%0AMelgar%0A%09%0A%0AIBM%0A%0AKent%0A%09%0A%0ATamura%0A%09%0A%0AIBM%0A%0AWayne%0A%09%0A%0AVicknair%0A%09%0A%0AIBM%0A%0ADon%0A%09%0A%0AFlinn%0A%09%0A%0AIndividual%0A%0APhil%0A%09%0A%0AGriffin%0A%09%0A%0AIndividual%0A%0AMark%0A%09%0A%0AHayes%0A%09%0A%0AIndividual%0A%0AJohn%0A%09%0A%0AHughes%0A%09%0A%0AIndividual%0A%0APeter%0A%09%0A%0ARostin%0A%09%0A%0AIndividual%0A%0ADavanum%0A%09%0A%0ASrinivas%0A%09%0A%0AIndividual%0A%0ABob%0A%09%0A%0AMorgan%0A%09%0A%0AIndividual%2FInternet%0A%0AKate%0A%09%0A%0ACherry%0A%09%0A%0ALockheed%20Martin%0A%0ABob%0A%09%0A%0AAtkinson%0A%09%0A%0AMicrosof%0A%0APaul%0A%09%0A%0ACotton%0A%09%0A%0AMicrosoft%0A%0AVijay%0A%09%0A%0AGajjala%0A%09%0A%0AMicrosoft%0A%0AMartin%0A%09%0A%0AGudgin%0A%09%0A%0AMicrosoft%0A%0AChris%0A%09%0A%0AKaler%0A%09%0A%0AMicrosoft%0A%0AKeith%0A%09%0A%0ABallinger%0A%09%0A%0AMicrosoft%0A%0AAllen%0A%09%0A%0ABrown%0A%09%0A%0AMicrosoft%0A%0AGiovanni%0A%09%0A%0ADella-Libera%0A%09%0A%0AMicrosoft%0A%0AAlan%0A%09%0A%0AGeller%0A%09%0A%0AMicrosoft%0A%0AJohannes%0A%09%0A%0AKlein%0A%09%0A%0AMicrosoft%0A%0AScott%0A%09%0A%0AKonersmann%0A%09%0A%0AMicrosoft%0A%0AChris%0A%09%0A%0AKurt%0A%09%0A%0AMicrosoft%0A%0ABrian%0A%09%0A%0ALaMacchia%0A%09%0A%0AMicrosoft%0A%0APaul%0A%09%0A%0ALeach%0A%09%0A%0AMicrosoft%0A%0AJohn%0A%09%0A%0AManferdelli%0A%09%0A%0AMicrosoft%0A%0AJohn%0A%09%0A%0AShewchuk%0A%09%0A%0AMicrosoft%0A%0ADan%0A%09%0A%0ASimon%0A%09%0A%0AMicrosoft%0A%0AHervey%0A%09%0A%0AWilson%0A%09%0A%0AMicrosoft%0A%0AJeff%0A%09%0A%0AHodges%0A%09%0A%0ANeustar%0A%0AFrederick%0A%09%0A%0AHirsch%0A%09%0A%0ANokia%0A%0ASenthil%0A%09%0A%0ASengodan%0A%09%0A%0ANokia%0A%0AAbbie%0A%09%0A%0ABarbir%0A%09%0A%0ANortel%0A%0ALloyd%0A%09%0A%0ABurch%0A%09%0A%0ANovell%0A%0AEd%0A%09%0A%0AReed%0A%09%0A%0ANovell%0A%0ACharles%0A%09%0A%0AKnouse%0A%09%0A%0AOblix%0A%0APrateek%0A%09%0A%0AMishra%0A%09%0A%0AOracle%0A%0AVamsi%0A%09%0A%0AMotukuru%0A%09%0A%0AOracle%0A%0ARamana%0A%09%0A%0ATurlapi%0A%09%0A%0AOracle%0A%0AVipin%0A%09%0A%0ASamar%0A%09%0A%0AOracle%0A%0AJerry%0A%09%0A%0ASchwarz%0A%09%0A%0AOracle%0A%0AEric%0A%09%0A%0AGravengaard%0A%09%0A%0AReactivity%0A%0AAndrew%0A%09%0A%0ANash%0A%09%0A%0AReactivity%0A%0AStuart%0A%09%0A%0AKing%0A%09%0A%0AReed%20Elsevier%0A%0ABen%0A%09%0A%0AHammond%0A%09%0A%0ARSA%20Security%0A%0ARob%0A%09%0A%0APhilpott%0A%09%0A%0ARSA%20Security%0A%0AMartijn%0A%09%0A%0Ade%20Boer%0A%09%0A%0ASAP%0A%0ABlake%0A%09%0A%0ADournaee%0A%09%0A%0ASarvega%0A%0ASundeep%0A%09%0A%0APeechu%0A%09%0A%0ASarvega%0A%0ACoumara%0A%09%0A%0ARadja%0A%09%0A%0ASarvega%0A%0APete%0A%09%0A%0AWenzel%0A%09%0A%0ASeeBeyond%0A%0AJonathan%0A%09%0A%0ATourzan%0A%09%0A%0ASony%0A%0AYassir%0A%09%0A%0AElley%0A%09%0A%0ASun%0A%0AManveen%0A%09%0A%0AKaur%0A%09%0A%0ASun%20Microsystems%0A%0ARonald%0A%09%0A%0AMonzillo%0A%09%0A%0ASun%20Microsystems%0A%0AJan%0A%09%0A%0AAlexander%0A%09%0A%0ASystinet%0A%0AMichael%0A%09%0A%0ANguyen%0A%09%0A%0AThe%20IDA%20of%20Singapore%0A%0ADon%0A%09%0A%0AAdams%0A%09%0A%0ATIBCO%20Software%20Inc.%0A%0ASymon%0A%09%0A%0AChang%0A%09%0A%0ATIBCO%20Software%20Inc.%0A%0AJohn%0A%09%0A%0AWeiland%0A%09%0A%0AUS%20Navy%0A%0AHans%0A%09%0A%0AGranqvist%0A%09%0A%0AVeriSign%0A%0APhillip%0A%09%0A%0AHallam-Baker%0A%09%0A%0AVeriSign%0A%0AHemma%0A%09%0A%0APrafullchandra%0A%09%0A%0AVeriSign%0A%0AMorten%0A%09%0A%0AJorgensen%0A%09%0A%0AVordel%0A%0AB.%20%20Revision%20History%0A%0A%20%0A%0ARevision%0A%09%0A%0ADate%0A%09%0A%0AEditor%0A%09%0A%0AChanges%20Made%0A%0AWD01%0A%09%0A%0A17-January-2011%0A%09%0A%0ACarlo%20Milono%0A%09%0A%0ACorrected%2Fadded%20hyperlinks%20where%20missing%3B%20added%20Status%20section%0A%0AWD02%0A%09%0A%0A8-February-2011%0A%09%0A%0ACarlo%20Milono%0A%09%0A%0AAdded%20Related%20Work%20to%20reflect%20v1.1.1%20of%20the%20specs%3B%20changed%20References%20for%20SOAP%20Message%20Security%20to%20reflect%20v1.1.1%3B%20Changed%20WD%23%20to%202%3B%20Added%20Date%3B%20Moved%20Current%20Members%20to%20Previous%20and%20added%20new%20Current%20Members%3B%20saved%20document%20under%20wd02%3B%20entered%20the%20Revision%20History%0A%0AMerged%20Old%20Current%20Contributors%20with%20Old%20Previous%2C%20created%20a%20New%20Current%20Contributors.%0A%0AWD03%0A%09%0A%0A16-March-2011%0A%09%0A%0ADavid%20Turner%0A%09%0A%0ACorrected%20and%20updated%20links.%0A%0ACSD01%0A%09%0A%0A2-May-2011%0A%09%0A%0ATC%20Admin%0A%09%0A%0AGenerated%20from%20WD03%0A%0ACSD02-draft%0A%09%0A%0A16-May-11%0A%09%0A%0ADavid%20Turner%0A%09%0A%0AAdded%20conformance%20statement%20and%20corrected%20a%20few%20formatting%20issues.%0A%0A%20%0A%0AC.%20%20Utility%20Elements%20and%20Attributes%0A%0AThese%20specifications%20define%20several%20elements%2C%20attributes%2C%20and%20attribute%20groups%20which%20can%20be%20re-used%20by%20other%20specifications.%20%20This%20appendix%20provides%20an%20overview%20of%20these%20utility%20components.%20%20It%20should%20be%20noted%20that%20the%20detailed%20descriptions%20are%20provided%20in%20the%20specification%20and%20this%20appendix%20will%20reference%20these%20sections%20as%20well%20as%20calling%20out%20other%20aspects%20not%20documented%20in%20the%20specification.%0A%0AC.1%20Identification%20Attribute%0A%0AThere%20are%20many%20situations%20where%20elements%20within%20SOAP%20messages%20need%20to%20be%20referenced.%20%20For%20example%2C%20when%20signing%20a%20SOAP%20message%2C%20selected%20elements%20are%20included%20in%20the%20signature.%20%20XML%20Schema%20Part%202%20provides%20several%20built-in%20data%20types%20that%20may%20be%20used%20for%20identifying%20and%20referencing%20elements%2C%20but%20their%20use%20requires%20that%20consumers%20of%20the%20SOAP%20message%20either%20have%20or%20are%20able%20to%20obtain%20the%20schemas%20where%20the%20identity%20or%20reference%20mechanisms%20are%20defined.%20%20In%20some%20circumstances%2C%20for%20example%2C%20intermediaries%2C%20this%20can%20be%20problematic%20and%20not%20desirable.%0A%0A%20%0A%0AConsequently%20a%20mechanism%20is%20required%20for%20identifying%20and%20referencing%20elements%2C%20based%20on%20the%20SOAP%20foundation%2C%20which%20does%20not%20rely%20upon%20complete%20schema%20knowledge%20of%20the%20context%20in%20which%20an%20element%20is%20used.%20This%20functionality%20can%20be%20integrated%20into%20SOAP%20processors%20so%20that%20elements%20can%20be%20identified%20and%20referred%20to%20without%20dynamic%20schema%20discovery%20and%20processing.%0A%0A%20%0A%0AThis%20specification%20specifies%20a%20namespace-qualified%20global%20attribute%20for%20identifying%20an%20element%20which%20can%20be%20applied%20to%20any%20element%20that%20either%20allows%20arbitrary%20attributes%20or%20specifically%20allows%20this%20attribute.%20%20This%20is%20a%20general%20purpose%20mechanism%20which%20can%20be%20re-used%20as%20needed.%0A%0AA%20detailed%20description%20can%20be%20found%20in%20Section%204.0%20ID%20References.%0A%0A%20%0A%0AThis%20section%20is%20non-normative.%0A%0AC.2%20Timestamp%20Elements%0A%0AThe%20specification%20defines%20XML%20elements%20which%20may%20be%20used%20to%20express%20timestamp%20information%20such%20as%20creation%20and%20expiration.%20%20While%20defined%20in%20the%20context%20of%20message%20security%2C%20these%20elements%20can%20be%20re-used%20wherever%20these%20sorts%20of%20time%20statements%20need%20to%20be%20made.%0A%0A%20%0A%0AThe%20elements%20in%20this%20specification%20are%20defined%20and%20illustrated%20using%20time%20references%20in%20terms%20of%20the%20dateTime%20type%20defined%20in%20XML%20Schema.%20%20It%20is%20RECOMMENDED%20that%20all%20time%20references%20use%20this%20type%20for%20interoperability.%20%20It%20is%20further%20RECOMMENDED%20that%20all%20references%20be%20in%20UTC%20time%20for%20increased%20interoperability.%20%20If%2C%20however%2C%20other%20time%20types%20are%20used%2C%20then%20the%20ValueType%20attribute%20MUST%20be%20specified%20to%20indicate%20the%20data%20type%20of%20the%20time%20format.%0A%0AThe%20following%20table%20provides%20an%20overview%20of%20these%20elements%3A%0A%0A%20%0A%0AElement%0A%09%0A%0ADescription%0A%0A%3Cwsu%3ACreated%3E%0A%09%0A%0AThis%20element%20is%20used%20to%20indicate%20the%20creation%20time%20associated%20with%20the%20enclosing%20context.%0A%0A%3Cwsu%3AExpires%3E%0A%09%0A%0AThis%20element%20is%20used%20to%20indicate%20the%20expiration%20time%20associated%20with%20the%20enclosing%20context.%0A%0A%20%0A%0AA%20detailed%20description%20can%20be%20found%20in%20Section%2010.%0A%0A%20%0A%0AThis%20section%20is%20non-normative.%0A%0AC.3%20General%20Schema%20Types%0A%0AThe%20schema%20for%20the%20utility%20aspects%20of%20this%20specification%20also%20defines%20some%20general%20purpose%20schema%20elements.%20%20While%20these%20elements%20are%20defined%20in%20this%20schema%20for%20use%20with%20this%20specification%2C%20they%20are%20general%20purpose%20definitions%20that%20may%20be%20used%20by%20other%20specifications%20as%20well.%0A%0A%20%0A%0ASpecifically%2C%20the%20following%20schema%20elements%20are%20defined%20and%20can%20be%20re-used%3A%0A%0A%20%0A%0ASchema%20Element%0A%09%0A%0ADescription%0A%0Awsu%3AcommonAtts%20attribute%20group%0A%09%0A%0AThis%20attribute%20group%20defines%20the%20common%20attributes%20recommended%20for%20elements.%20%20This%20includes%20the%20wsu%3AId%20attribute%20as%20well%20as%20extensibility%20for%20other%20namespace%20qualified%20attributes.%0A%0Awsu%3AAttributedDateTime%20type%0A%09%0A%0AThis%20type%20extends%20the%20XML%20Schema%20dateTime%20type%20to%20include%20the%20common%20attributes.%0A%0Awsu%3AAttributedURI%20type%0A%09%0A%0AThis%20type%20extends%20the%20XML%20Schema%20anyURI%20type%20to%20include%20the%20common%20attributes.%0A%0A%20%0A%0AThis%20section%20is%20non-normative.%0A%0AD.%20%20SecurityTokenReference%20Model%0A%0AThis%20appendix%20provides%20a%20non-normative%20overview%20of%20the%20usage%20and%20processing%20models%20for%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element.%0A%0A%20%0A%0AThere%20are%20several%20motivations%20for%20introducing%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element%3A%0A%0A%20%20%20%20The%20XML%20Signature%20reference%20mechanisms%20are%20focused%20on%20%22key%22%20references%20rather%20than%20general%20token%20references.%0A%20%20%20%20The%20XML%20Signature%20reference%20mechanisms%20utilize%20a%20fairly%20closed%20schema%20which%20limits%20the%20extensibility%20that%20can%20be%20applied.%0A%20%20%20%20There%20are%20additional%20types%20of%20general%20reference%20mechanisms%20that%20are%20needed%2C%20but%20are%20not%20covered%20by%20XML%20Signature.%0A%20%20%20%20There%20are%20scenarios%20where%20a%20reference%20may%20occur%20outside%20of%20an%20XML%20Signature%20and%20the%20XML%20Signature%20schema%20is%20not%20appropriate%20or%20desired.%0A%20%20%20%20The%20XML%20Signature%20references%20may%20include%20aspects%20(e.g.%20transforms)%20that%20may%20not%20apply%20to%20all%20references.%0A%0AThe%20following%20use%20cases%20drive%20the%20above%20motivations%3A%0A%0ALocal%20Reference%20%E2%80%93%20A%20security%20token%2C%20that%20is%20included%20in%20the%20message%20in%20the%20%3Cwsse%3ASecurity%3E%20header%2C%20is%20associated%20with%20an%20XML%20Signature.%20%20The%20figure%20below%20illustrates%20this%3A%0A%0A%09%0A%0A%20%0A%0ARemote%20Reference%20%E2%80%93%20A%20security%20token%2C%20that%20is%20not%20included%20in%20the%20message%20but%20may%20be%20available%20at%20a%20specific%20URI%2C%20is%20associated%20with%20an%20XML%20Signature.%20%20The%20figure%20below%20illustrates%20this%3A%0A%0A%09%0A%0A%20%0A%0AKey%20Identifier%20%E2%80%93%20A%20security%20token%2C%20which%20is%20associated%20with%20an%20XML%20Signature%20and%20identified%20using%20a%20known%20value%20that%20is%20the%20result%20of%20a%20well-known%20function%20of%20the%20security%20token%20(defined%20by%20the%20token%20format%20or%20profile).%20%20The%20figure%20below%20illustrates%20this%20where%20the%20token%20is%20located%20externally%3A%0A%0A%09%0A%0A%20%0A%0AKey%20Name%20%E2%80%93%20A%20security%20token%20is%20associated%20with%20an%20XML%20Signature%20and%20identified%20using%20a%20known%20value%20that%20represents%20a%20%22name%22%20assertion%20within%20the%20security%20token%20(defined%20by%20the%20token%20format%20or%20profile).%20%20The%20figure%20below%20illustrates%20this%20where%20the%20token%20is%20located%20externally%3A%0A%0A%09%0A%0A%20%0A%0AFormat-Specific%20References%20%E2%80%93%20A%20security%20token%20is%20associated%20with%20an%20XML%20Signature%20and%20identified%20using%20a%20mechanism%20specific%20to%20the%20token%20(rather%20than%20the%20general%20mechanisms%20described%20above).%20%20The%20figure%20below%20illustrates%20this%3A%0A%0A%09%0A%0A%20%0A%0ANon-Signature%20References%20%E2%80%93%20A%20message%20may%20contain%20XML%20that%20does%20not%20represent%20an%20XML%20signature%2C%20but%20may%20reference%20a%20security%20token%20(which%20may%20or%20may%20not%20be%20included%20in%20the%20message).%20%20The%20figure%20below%20illustrates%20this%3A%0A%0A%09%0A%0A%20%0A%0AAll%20conformant%20implementations%20must%20be%20able%20to%20process%20the%20%3Cwsse%3ASecurityTokenReference%3E%20element.%20%20However%2C%20they%20are%20not%20required%20to%20support%20all%20of%20the%20different%20types%20of%20references.%0A%0A%20%0A%0AThe%20reference%20may%20include%20a%20wsse11%3ATokenType%20attribute%20which%20provides%20a%20%22hint%22%20for%20the%20type%20of%20desired%20token.%20%0A%0A%20%0A%0AIf%20multiple%20sub-elements%20are%20specified%2C%20together%20they%20describe%20the%20reference%20for%20the%20token.%0A%0AThere%20are%20several%20challenges%20that%20implementations%20face%20when%20trying%20to%20interoperate%3A%0A%0AID%20References%20%E2%80%93%20The%20underlying%20XML%20referencing%20mechanism%20using%20the%20XML%20base%20type%20of%20ID%20provides%20a%20simple%20straightforward%20XML%20element%20reference.%20%20However%2C%20because%20this%20is%20an%20XML%20type%2C%20it%20can%20be%20bound%20to%20any%20attribute.%20%20Consequently%20in%20order%20to%20process%20the%20IDs%20and%20references%20requires%20the%20recipient%20to%20understand%20the%20schema.%20%20This%20may%20be%20an%20expensive%20task%20and%20in%20the%20general%20case%20impossible%20as%20there%20is%20no%20way%20to%20know%20the%20%22schema%20location%22%20for%20a%20specific%20namespace%20URI.%0A%0A%20%0A%0AAmbiguity%20%E2%80%93%20The%20primary%20goal%20of%20a%20reference%20is%20to%20uniquely%20identify%20the%20desired%20token.%20%20ID%20references%20are%2C%20by%20definition%2C%20unique%20by%20XML.%20%20However%2C%20other%20mechanisms%20such%20as%20%22principal%20name%22%20are%20not%20required%20to%20be%20unique%20and%20therefore%20such%20references%20may%20be%20unique.%0A%0AThe%20XML%20Signature%20specification%20defines%20a%20%3Cds%3AKeyInfo%3E%20element%20which%20is%20used%20to%20provide%20information%20about%20the%20%22key%22%20used%20in%20the%20signature.%20%20For%20token%20references%20within%20signatures%2C%20it%20is%20recommended%20that%20the%20%3Cwsse%3ASecurityTokenReference%3E%20be%20placed%20within%20the%20%3Cds%3AKeyInfo%3E.%20%20The%20XML%20Signature%20specification%20also%20defines%20mechanisms%20for%20referencing%20keys%20by%20identifier%20or%20passing%20specific%20keys.%20%20As%20a%20rule%2C%20the%20specific%20mechanisms%20defined%20in%20WSS%3A%20SOAP%20Message%20Security%20or%20its%20profiles%20are%20preferred%20over%20the%20mechanisms%20in%20XML%20Signature.%0A%0AThe%20following%20provides%20additional%20details%20on%20the%20specific%20reference%20mechanisms%20defined%20in%20WSS%3A%20SOAP%20Message%20Security%3A%0A%0A%20%0A%0ADirect%20References%20%E2%80%93%20The%20%3Cwsse%3AReference%3E%20element%20is%20used%20to%20provide%20a%20URI%20reference%20to%20the%20security%20token.%20%20If%20only%20the%20fragment%20is%20specified%2C%20then%20it%20references%20the%20security%20token%20within%20the%20document%20whose%20wsu%3AId%20matches%20the%20fragment.%20%20For%20non-fragment%20URIs%2C%20the%20reference%20is%20to%20a%20%5Bpotentially%20external%5D%20security%20token%20identified%20using%20a%20URI.%20%20There%20are%20no%20implied%20semantics%20around%20the%20processing%20of%20the%20URI.%0A%0A%20%0A%0AKey%20Identifiers%20%E2%80%93%20The%20%3Cwsse%3AKeyIdentifier%3E%20element%20is%20used%20to%20reference%20a%20security%20token%20by%20specifying%20a%20known%20value%20(identifier)%20for%20the%20token%2C%20which%20is%20determined%20by%20applying%20a%20special%20function%20to%20the%20security%20token%20(e.g.%20a%20hash%20of%20key%20fields).%20%20This%20approach%20is%20typically%20unique%20for%20the%20specific%20security%20token%20but%20requires%20a%20profile%20or%20token-specific%20function%20to%20be%20specified.%20%20The%20ValueType%20attribute%20defines%20the%20type%20of%20key%20identifier%20and%2C%20consequently%2C%20identifies%20the%20type%20of%20token%20referenced.%20%20The%20EncodingType%20attribute%20specifies%20how%20the%20unique%20value%20(identifier)%20is%20encoded.%20%20For%20example%2C%20a%20hash%20value%20may%20be%20encoded%20using%20base%2064%20encoding.%0A%0A%20%0A%0AKey%20Names%20%E2%80%93%20The%20%3Cds%3AKeyName%3E%20element%20is%20used%20to%20reference%20a%20security%20token%20by%20specifying%20a%20specific%20value%20that%20is%20used%20to%20match%20an%20identity%20assertion%20within%20the%20security%20token.%20%20This%20is%20a%20subset%20match%20and%20may%20result%20in%20multiple%20security%20tokens%20that%20match%20the%20specified%20name.%20%20While%20XML%20Signature%20doesn%27t%20imply%20formatting%20semantics%2C%20WSS%3A%20SOAP%20Message%20Security%20recommends%20that%20X.509%20names%20be%20specified.%0A%0A%20%0A%0AIt%20is%20expected%20that%2C%20where%20appropriate%2C%20profiles%20define%20if%20and%20how%20the%20reference%20mechanisms%20map%20to%20the%20specific%20token%20profile.%20%20Specifically%2C%20the%20profile%20should%20answer%20the%20following%20questions%3A%0A%0A%20%20%20%20What%20types%20of%20references%20can%20be%20used%3F%0A%20%20%20%20How%20%22Key%20Name%22%20references%20map%20(if%20at%20all)%3F%0A%20%20%20%20How%20%22Key%20Identifier%22%20references%20map%20(if%20at%20all)%3F%0A%20%20%20%20Are%20there%20any%20additional%20profile%20or%20format-specific%20references%3F%0A%0A%20%0A%0AThis%20section%20is%20non-normative.%0A&#xd;
&lt;/description&gt;&lt;/ns2:DoubleIt&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.domain">localhost</stringProp>
          <stringProp name="HTTPSampler.port">8080</stringProp>
          <stringProp name="HTTPSampler.protocol">http</stringProp>
          <stringProp name="HTTPSampler.contentEncoding"></stringProp>
          <stringProp name="HTTPSampler.path">doubleit/services/doubleit</stringProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <boolProp name="HTTPSampler.auto_redirects">false</boolProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.DO_MULTIPART_POST">false</boolProp>
          <stringProp name="HTTPSampler.embedded_url_re"></stringProp>
          <stringProp name="HTTPSampler.connect_timeout"></stringProp>
          <stringProp name="HTTPSampler.response_timeout"></stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">text/xml; charset=utf-8</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">SOAPAction</stringProp>
                <stringProp name="Header.value">&quot;&quot;</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
          <ResponseAssertion guiclass="AssertionGui" testclass="ResponseAssertion" testname="Response Assertion" enabled="true">
            <collectionProp name="Asserion.test_strings">
              <stringProp name="773387613">DoubleItResponse</stringProp>
            </collectionProp>
            <stringProp name="TestPlan.comments">Verify content in response</stringProp>
            <stringProp name="Assertion.test_field">Assertion.response_data</stringProp>
            <boolProp name="Assertion.assume_success">false</boolProp>
            <intProp name="Assertion.test_type">16</intProp>
            <stringProp name="Assertion.custom_message"></stringProp>
          </ResponseAssertion>
          <hashTree/>
        </hashTree>
      </hashTree>
      <ThreadGroup guiclass="ThreadGroupGui" testclass="ThreadGroup" testname="AsymmetricBinding" enabled="false">
        <stringProp name="ThreadGroup.on_sample_error">continue</stringProp>
        <elementProp name="ThreadGroup.main_controller" elementType="LoopController" guiclass="LoopControlPanel" testclass="LoopController" testname="Loop Controller" enabled="true">
          <boolProp name="LoopController.continue_forever">false</boolProp>
          <stringProp name="LoopController.loops">20000</stringProp>
        </elementProp>
        <stringProp name="ThreadGroup.num_threads">10</stringProp>
        <stringProp name="ThreadGroup.ramp_time">0</stringProp>
        <longProp name="ThreadGroup.start_time">1375525852000</longProp>
        <longProp name="ThreadGroup.end_time">1375525852000</longProp>
        <boolProp name="ThreadGroup.scheduler">false</boolProp>
        <stringProp name="ThreadGroup.duration"></stringProp>
        <stringProp name="ThreadGroup.delay"></stringProp>
      </ThreadGroup>
      <hashTree>
        <HTTPSamplerProxy guiclass="HttpTestSampleGui" testclass="HTTPSamplerProxy" testname="Soap Request Asymmetric" enabled="true">
          <boolProp name="HTTPSampler.postBodyRaw">true</boolProp>
          <elementProp name="HTTPsampler.Arguments" elementType="Arguments">
            <collectionProp name="Arguments.arguments">
              <elementProp name="" elementType="HTTPArgument">
                <boolProp name="HTTPArgument.always_encode">false</boolProp>
                <stringProp name="Argument.value">&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;soap:Header&gt;&lt;wsse:Security xmlns:wsse=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot; xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; soap:mustUnderstand=&quot;1&quot;&gt;&lt;xenc:EncryptedKey xmlns:xenc=&quot;http://www.w3.org/2001/04/xmlenc#&quot; Id=&quot;EK-34abd726-6b97-49b7-9abb-2aaeaa1f2355&quot;&gt;&lt;xenc:EncryptionMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot;/&gt;&lt;ds:KeyInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;&lt;wsse:SecurityTokenReference&gt;&lt;ds:X509Data&gt;&lt;ds:X509IssuerSerial&gt;&lt;ds:X509IssuerName&gt;CN=Werner,OU=Apache WSS4J,O=Home,L=Munich,ST=Bayern,C=DE&lt;/ds:X509IssuerName&gt;&lt;ds:X509SerialNumber&gt;32&lt;/ds:X509SerialNumber&gt;&lt;/ds:X509IssuerSerial&gt;&lt;/ds:X509Data&gt;&lt;/wsse:SecurityTokenReference&gt;&lt;/ds:KeyInfo&gt;&lt;xenc:CipherData&gt;&lt;xenc:CipherValue&gt;ZxaWC9pQUyedv0F20PCp4XC3tmcg27CiCnfmfWZFj390mlbtJEeoqLoZNb7CgSWYCjW6EOeOkey/lZ2dMrgG4+hnP28VoWOryffFqs60/lo8YjCCcSK4ELp/7nU5Sedms5Hwd17SOC2pnWxSq0mrl6J9NNufnYrMNLNe2sQC/ocot8nhoKGxm9KlTQ88HGRVsKLa4hl6lvuyim/fOiA522rM3erv5WNbfsXVZIYMwN6xOCrmhQw7j5dpY5rwj7R6bzHAze6VP7ljVgzG28OmjMZYOJd2GZ76irfxAAMegWtWEWX7gV+T+RHB7kAu4bS3yMS/m49viXmbfYaiciHjqA==&lt;/xenc:CipherValue&gt;&lt;/xenc:CipherData&gt;&lt;xenc:ReferenceList&gt;&lt;xenc:DataReference URI=&quot;#ED-3077c90c-dd3a-4c28-891d-7604f1e31ff2&quot;/&gt;&lt;/xenc:ReferenceList&gt;&lt;/xenc:EncryptedKey&gt;&lt;wsse:BinarySecurityToken EncodingType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot; ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot; wsu:Id=&quot;X509-9cfa521d-faa4-4803-a8b1-68bffa0bfeda&quot;&gt;MIIDqjCCAxOgAwIBAgIBHzANBgkqhkiG9w0BAQsFADBmMQswCQYDVQQGEwJERTEPMA0GA1UECBMGQmF5ZXJuMQ8wDQYDVQQHEwZNdW5pY2gxDTALBgNVBAoTBEhvbWUxFTATBgNVBAsTDEFwYWNoZSBXU1M0SjEPMA0GA1UEAxMGV2VybmVyMB4XDTE1MDkxMDEzMjEyMloXDTI1MDkwNzEzMjEyMlowUzELMAkGA1UEBhMCSUUxETAPBgNVBAgTCExlaW5zdGVyMQ8wDQYDVQQHEwZEdWJsaW4xDzANBgNVBAoTBkFwYWNoZTEPMA0GA1UEAxMGQ2xpZW50MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAjeP2hF/KOv8Pw/++n9bAa0DxKFzyLvlcAciBgv1E01cCyUwn5X0v8nT9gIdjXBi6Y6PvSCs2GqcAzo82yzIjlcDmocXt/2vBkezwh6Ow2xoXItzXD+I6KlhpH8gl4xXd35N0z+88m4SEclncm//l3sQHP6CMG9O4H91A+0DXzTkQHzs2PEg13ONMOVbg5P85ceZ+VTBjd3BkqC0mZDB6Ovo6Xt06tVS/S4rFR0L9mtyxZ+v/Psd8TYAIk3wlz1e1wm+dobp1YkOPgvv08r8ROVnWC0pRZquCPQUou6r50LseRZWEo9MGN8kt4sYcLCaJbF3fsTvKYi6InWyczv2JSQIDAQABo4H2MIHzMAkGA1UdEwQCMAAwLAYJYIZIAYb4QgENBB8WHU9wZW5TU0wgR2VuZXJhdGVkIENlcnRpZmljYXRlMB0GA1UdDgQWBBQsRXQjSEq1PetSTIekkXnMBtntGTCBmAYDVR0jBIGQMIGNgBRWF+/2a4tZ/iMZaN54wOFNZ33QZqFqpGgwZjELMAkGA1UEBhMCREUxDzANBgNVBAgTBkJheWVybjEPMA0GA1UEBxMGTXVuaWNoMQ0wCwYDVQQKEwRIb21lMRUwEwYDVQQLEwxBcGFjaGUgV1NTNEoxDzANBgNVBAMTBldlcm5lcoIJAI3hLAppEXfSMA0GCSqGSIb3DQEBCwUAA4GBAKZXwqAplMzutyC8jIUzFN/DfQOAuZ8ExLBIUxW51KSzxxL+kfydq4HFotRC7PZ3bYEkXYN7deUYoq6yFO0AAWvagBbxdzRYDPRCwpKe+4jn8VLGtjkEyLSsMiiaNiOuMx8qWxvV1sA9KioHvZDFVP+0QqSc1ZytEPOKasdViUU9&lt;/wsse:BinarySecurityToken&gt;&lt;ds:Signature xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot; Id=&quot;SIG-68074ec0-c24c-43c5-94af-7525d0b45f9a&quot;&gt;&lt;ds:SignedInfo&gt;&lt;ds:CanonicalizationMethod Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;&gt;&lt;ec:InclusiveNamespaces xmlns:ec=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot; PrefixList=&quot;soap&quot;/&gt;&lt;/ds:CanonicalizationMethod&gt;&lt;ds:SignatureMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;/&gt;&lt;ds:Reference URI=&quot;#_fd51d3c3-d3a7-45be-a4e5-148c3ec0ee00&quot;&gt;&lt;ds:Transforms&gt;&lt;ds:Transform Algorithm=&quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;/&gt;&lt;/ds:Transforms&gt;&lt;ds:DigestMethod Algorithm=&quot;http://www.w3.org/2000/09/xmldsig#sha1&quot;/&gt;&lt;ds:DigestValue&gt;HyGdEm0F5MEG/bx6Np8ELGD7c1A=&lt;/ds:DigestValue&gt;&lt;/ds:Reference&gt;&lt;/ds:SignedInfo&gt;&lt;ds:SignatureValue&gt;A8ntIc+z185+laA7HJRHfODoCFrHM4k0Cj+yb1eUlwbP0YuUvEzssM8xAVzv/qiI8eXO8KJpajQAThGkPSYlt2uWIu6Vf5XBlL7gGpAdGcVPtjChqGO24g64q+Ee1qKbdU3IntHq62gqnoIxWIIZ50aaTqqieGmU/zqy7UKcDakCS+k3689+8zOb2Cf2/1xHN3c0GhgwIHVo51KyPjZdZJKyIn8sZ5UPNibbIqTpr8SYE7wMnsE8Mzufk0RMLNVIDwdoz7UINbOqYCZSMKS+DgGltIHoSsg/pHvgkcgtmfo3pZQW+1vtO54iVLGePEvzr8GXeE9YX4mJ2Tgf4Z/nhw==&lt;/ds:SignatureValue&gt;&lt;ds:KeyInfo Id=&quot;KI-7929bf1e-fe96-4c16-9a27-9eed770ed622&quot;&gt;&lt;wsse:SecurityTokenReference xmlns:wsse=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot; xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; wsu:Id=&quot;STR-7dcd8208-22dc-419b-9f21-d0102d616bf9&quot;&gt;&lt;wsse:Reference URI=&quot;#X509-9cfa521d-faa4-4803-a8b1-68bffa0bfeda&quot; ValueType=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;/&gt;&lt;/wsse:SecurityTokenReference&gt;&lt;/ds:KeyInfo&gt;&lt;/ds:Signature&gt;&lt;/wsse:Security&gt;&lt;/soap:Header&gt;&lt;soap:Body xmlns:wsu=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot; wsu:Id=&quot;_fd51d3c3-d3a7-45be-a4e5-148c3ec0ee00&quot;&gt;&lt;xenc:EncryptedData xmlns:xenc=&quot;http://www.w3.org/2001/04/xmlenc#&quot; Id=&quot;ED-3077c90c-dd3a-4c28-891d-7604f1e31ff2&quot; Type=&quot;http://www.w3.org/2001/04/xmlenc#Content&quot;&gt;&lt;xenc:EncryptionMethod Algorithm=&quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot;/&gt;&lt;ds:KeyInfo xmlns:ds=&quot;http://www.w3.org/2000/09/xmldsig#&quot;&gt;&lt;wsse:SecurityTokenReference xmlns:wsse=&quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd&quot; xmlns:wsse11=&quot;http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd&quot; wsse11:TokenType=&quot;http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey&quot;&gt;&lt;wsse:Reference URI=&quot;#EK-34abd726-6b97-49b7-9abb-2aaeaa1f2355&quot;/&gt;&lt;/wsse:SecurityTokenReference&gt;&lt;/ds:KeyInfo&gt;&lt;xenc:CipherData&gt;&lt;xenc:CipherValue&gt;VjBLq8RJ6T2Tv5iaBaq4S54/6dO2A+PjEaAuec9b1HGRbl1SW7FnEewulVy0quJWmBteJsWI98AlxJexj4A7oXpH70xzc5XSwJjhZtzfNycyc/Y9uj/PlCWJP6suaCT5taRUULeh+vpythu8oMzIzws5TU/u1f1I+ds3aPx5DrrOFmpHf8joeSapneVTt0RyRo5CuDywRjfAKnwwO7NBevwJglcJmsGCm6I3hT4IDa0=&lt;/xenc:CipherValue&gt;&lt;/xenc:CipherData&gt;&lt;/xenc:EncryptedData&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</stringProp>
                <stringProp name="Argument.metadata">=</stringProp>
              </elementProp>
            </collectionProp>
          </elementProp>
          <stringProp name="HTTPSampler.domain">localhost</stringProp>
          <stringProp name="HTTPSampler.port">8080</stringProp>
          <stringProp name="HTTPSampler.protocol">http</stringProp>
          <stringProp name="HTTPSampler.contentEncoding"></stringProp>
          <stringProp name="HTTPSampler.path">doubleit/services/doubleit</stringProp>
          <stringProp name="HTTPSampler.method">POST</stringProp>
          <boolProp name="HTTPSampler.follow_redirects">true</boolProp>
          <boolProp name="HTTPSampler.auto_redirects">false</boolProp>
          <boolProp name="HTTPSampler.use_keepalive">true</boolProp>
          <boolProp name="HTTPSampler.DO_MULTIPART_POST">false</boolProp>
          <stringProp name="HTTPSampler.embedded_url_re"></stringProp>
          <stringProp name="HTTPSampler.connect_timeout"></stringProp>
          <stringProp name="HTTPSampler.response_timeout"></stringProp>
        </HTTPSamplerProxy>
        <hashTree>
          <HeaderManager guiclass="HeaderPanel" testclass="HeaderManager" testname="HTTP Header Manager" enabled="true">
            <collectionProp name="HeaderManager.headers">
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">Content-Type</stringProp>
                <stringProp name="Header.value">text/xml; charset=utf-8</stringProp>
              </elementProp>
              <elementProp name="" elementType="Header">
                <stringProp name="Header.name">SOAPAction</stringProp>
                <stringProp name="Header.value">&quot;&quot;</stringProp>
              </elementProp>
            </collectionProp>
          </HeaderManager>
          <hashTree/>
        </hashTree>
      </hashTree>
      <ResultCollector guiclass="SummaryReport" testclass="ResultCollector" testname="Summary Report" enabled="true">
        <boolProp name="ResultCollector.error_logging">false</boolProp>
        <objProp>
          <name>saveConfig</name>
          <value class="SampleSaveConfiguration">
            <time>true</time>
            <latency>true</latency>
            <timestamp>true</timestamp>
            <success>true</success>
            <label>true</label>
            <code>true</code>
            <message>true</message>
            <threadName>true</threadName>
            <dataType>true</dataType>
            <encoding>false</encoding>
            <assertions>true</assertions>
            <subresults>true</subresults>
            <responseData>false</responseData>
            <samplerData>false</samplerData>
            <xml>false</xml>
            <fieldNames>false</fieldNames>
            <responseHeaders>false</responseHeaders>
            <requestHeaders>false</requestHeaders>
            <responseDataOnError>false</responseDataOnError>
            <saveAssertionResultsFailureMessage>false</saveAssertionResultsFailureMessage>
            <assertionsResultsToSave>0</assertionsResultsToSave>
            <bytes>true</bytes>
            <threadCounts>true</threadCounts>
          </value>
        </objProp>
        <stringProp name="filename"></stringProp>
      </ResultCollector>
      <hashTree/>
    </hashTree>
  </hashTree>
</jmeterTestPlan>
